import{getActiveTransaction}from"@sentry/core";import{logger}from"@sentry/utils";import{WINDOW}from"./types.js";function registerBackgroundTabDetection(){WINDOW&&WINDOW.document?WINDOW.document.addEventListener("visibilitychange",(()=>{const activeTransaction=getActiveTransaction();if(WINDOW.document.hidden&&activeTransaction){const statusType="cancelled";("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&logger.log(`[Tracing] Transaction: ${statusType} -> since tab moved to the background, op: ${activeTransaction.op}`),activeTransaction.status||activeTransaction.setStatus(statusType),activeTransaction.setTag("visibilitychange","document.hidden"),activeTransaction.finish()}})):("undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__)&&logger.warn("[Tracing] Could not set up background tab detection due to lack of global document")}export{registerBackgroundTabDetection};