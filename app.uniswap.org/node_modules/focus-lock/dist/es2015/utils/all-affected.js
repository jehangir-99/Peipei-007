import{FOCUS_DISABLED,FOCUS_GROUP}from"../constants";import{asArray,toArray}from"./array";var filterNested=function(nodes){for(var contained=new Set,l=nodes.length,i=0;i<l;i+=1)for(var j=i+1;j<l;j+=1){var position=nodes[i].compareDocumentPosition(nodes[j]);(position&Node.DOCUMENT_POSITION_CONTAINED_BY)>0&&contained.add(j),(position&Node.DOCUMENT_POSITION_CONTAINS)>0&&contained.add(i)}return nodes.filter((function(_,index){return!contained.has(index)}))},getTopParent=function(node){return node.parentNode?getTopParent(node.parentNode):node};export var getAllAffectedNodes=function(node){return asArray(node).filter(Boolean).reduce((function(acc,currentNode){var group=currentNode.getAttribute(FOCUS_GROUP);return acc.push.apply(acc,group?filterNested(toArray(getTopParent(currentNode).querySelectorAll("[".concat(FOCUS_GROUP,'="').concat(group,'"]:not([').concat(FOCUS_DISABLED,'="disabled"])')))):[currentNode]),acc}),[])};