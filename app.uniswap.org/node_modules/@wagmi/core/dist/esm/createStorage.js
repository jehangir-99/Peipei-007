import{}from"./createConfig.js";import{}from"./types/utils.js";import{deserialize as deserialize_}from"./utils/deserialize.js";import{serialize as serialize_}from"./utils/serialize.js";export function createStorage(parameters){const{deserialize:deserialize=deserialize_,key:prefix="wagmi",serialize:serialize=serialize_,storage:storage=noopStorage}=parameters;function unwrap(value){return value instanceof Promise?value.then((x=>x)).catch((()=>null)):value}return{...storage,key:prefix,async getItem(key,defaultValue){const value=storage.getItem(`${prefix}.${key}`),unwrapped=await unwrap(value);return unwrapped?deserialize(unwrapped)??null:defaultValue??null},async setItem(key,value){const storageKey=`${prefix}.${key}`;null===value?await unwrap(storage.removeItem(storageKey)):await unwrap(storage.setItem(storageKey,serialize(value)))},async removeItem(key){await unwrap(storage.removeItem(`${prefix}.${key}`))}}}export const noopStorage={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};