import{reconnect}from"./actions/reconnect.js";export function hydrate(config,parameters){const{initialState:initialState,reconnectOnMount:reconnectOnMount}=parameters;return initialState&&!config._internal.store.persist.hasHydrated()&&config.setState({...initialState,connections:reconnectOnMount?initialState.connections:new Map,status:reconnectOnMount?"reconnecting":"disconnected"}),{async onMount(){if(config._internal.ssr){await config._internal.store.persist.rehydrate();const mipdConnectors=config._internal.mipd?.getProviders().map(config._internal.connectors.providerDetailToConnector).map(config._internal.connectors.setup);config._internal.connectors.setState((connectors=>[...connectors,...mipdConnectors??[]]))}reconnectOnMount?reconnect(config):config.storage&&config.setState((x=>({...x,connections:new Map})))}}}