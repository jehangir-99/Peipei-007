import{V2_FACTORY_ADDRESSES,Percent,CurrencyAmount,sqrt,Token,Price,TradeType,Fraction,computePriceImpact,sortedInsert,validateAndParseAddress}from"@uniswap/sdk-core";import JSBI from"jsbi";import{getCreate2Address}from"@ethersproject/address";import{BigNumber}from"@ethersproject/bignumber";import{keccak256,pack}from"@ethersproject/solidity";import invariant from"tiny-invariant";var FACTORY_ADDRESS="0x5C69bEe701ef814a2B6a3EDD4B1652CB9cc5aA6f",FACTORY_ADDRESS_MAP=V2_FACTORY_ADDRESSES,INIT_CODE_HASH="0x96e8ac4277198ff8b6f785478aa9a39f403cb768dd02cbee326c3e7da348845f",MINIMUM_LIQUIDITY=JSBI.BigInt(1e3),ZERO=JSBI.BigInt(0),ONE=JSBI.BigInt(1),FIVE=JSBI.BigInt(5),_997=JSBI.BigInt(997),_1000=JSBI.BigInt(1e3),BASIS_POINTS=JSBI.BigInt(1e4),ZERO_PERCENT=new Percent(ZERO),ONE_HUNDRED_PERCENT=new Percent(ONE);function _construct(t,e,r){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,e);var p=new(t.bind.apply(t,o));return r&&_setPrototypeOf(p,r.prototype),p}function _isNativeReflectConstruct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(_isNativeReflectConstruct=function(){return!!t})()}function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==typeof i?i:String(i)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,_setPrototypeOf(subClass,superClass)}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _isNativeFunction(fn){try{return-1!==Function.toString.call(fn).indexOf("[native code]")}catch(e){return"function"==typeof fn}}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(Class){if(null===Class||!_isNativeFunction(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)},_wrapNativeSuper(Class)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var CAN_SET_PROTOTYPE="setPrototypeOf"in Object,InsufficientReservesError=function(_Error){function InsufficientReservesError(){var _this;return(_this=_Error.call(this)||this).isInsufficientReservesError=!0,_this.name=_this.constructor.name,CAN_SET_PROTOTYPE&&Object.setPrototypeOf(_assertThisInitialized(_this),(this instanceof InsufficientReservesError?this.constructor:void 0).prototype),_this}return _inheritsLoose(InsufficientReservesError,_Error),InsufficientReservesError}(_wrapNativeSuper(Error)),InsufficientInputAmountError=function(_Error2){function InsufficientInputAmountError(){var _this2;return(_this2=_Error2.call(this)||this).isInsufficientInputAmountError=!0,_this2.name=_this2.constructor.name,CAN_SET_PROTOTYPE&&Object.setPrototypeOf(_assertThisInitialized(_this2),(this instanceof InsufficientInputAmountError?this.constructor:void 0).prototype),_this2}return _inheritsLoose(InsufficientInputAmountError,_Error2),InsufficientInputAmountError}(_wrapNativeSuper(Error)),computePairAddress=function(_ref){var factoryAddress=_ref.factoryAddress,tokenA=_ref.tokenA,tokenB=_ref.tokenB,_ref2=tokenA.sortsBefore(tokenB)?[tokenA,tokenB]:[tokenB,tokenA],token1=_ref2[1];return getCreate2Address(factoryAddress,keccak256(["bytes"],[pack(["address","address"],[_ref2[0].address,token1.address])]),INIT_CODE_HASH)},Pair=function(){function Pair(currencyAmountA,tokenAmountB){var tokenAmounts=currencyAmountA.currency.sortsBefore(tokenAmountB.currency)?[currencyAmountA,tokenAmountB]:[tokenAmountB,currencyAmountA];this.liquidityToken=new Token(tokenAmounts[0].currency.chainId,Pair.getAddress(tokenAmounts[0].currency,tokenAmounts[1].currency),18,"UNI-V2","Uniswap V2"),this.tokenAmounts=tokenAmounts}Pair.getAddress=function(tokenA,tokenB){var _FACTORY_ADDRESS_MAP$,factoryAddress=null!=(_FACTORY_ADDRESS_MAP$=FACTORY_ADDRESS_MAP[tokenA.chainId])?_FACTORY_ADDRESS_MAP$:FACTORY_ADDRESS;return computePairAddress({factoryAddress:factoryAddress,tokenA:tokenA,tokenB:tokenB})};var _proto=Pair.prototype;return _proto.involvesToken=function(token){return token.equals(this.token0)||token.equals(this.token1)},_proto.priceOf=function(token){return this.involvesToken(token)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),token.equals(this.token0)?this.token0Price:this.token1Price},_proto.reserveOf=function(token){return this.involvesToken(token)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),token.equals(this.token0)?this.reserve0:this.reserve1},_proto.getOutputAmount=function(inputAmount,calculateFotFees){if(void 0===calculateFotFees&&(calculateFotFees=!0),this.involvesToken(inputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),JSBI.equal(this.reserve0.quotient,ZERO)||JSBI.equal(this.reserve1.quotient,ZERO))throw new InsufficientReservesError;var inputReserve=this.reserveOf(inputAmount.currency),outputReserve=this.reserveOf(inputAmount.currency.equals(this.token0)?this.token1:this.token0),percentAfterSellFees=calculateFotFees?this.derivePercentAfterSellFees(inputAmount):ZERO_PERCENT,inputAmountAfterTax=percentAfterSellFees.greaterThan(ZERO_PERCENT)?CurrencyAmount.fromRawAmount(inputAmount.currency,percentAfterSellFees.multiply(inputAmount).quotient):inputAmount,inputAmountWithFeeAndAfterTax=JSBI.multiply(inputAmountAfterTax.quotient,_997),numerator=JSBI.multiply(inputAmountWithFeeAndAfterTax,outputReserve.quotient),denominator=JSBI.add(JSBI.multiply(inputReserve.quotient,_1000),inputAmountWithFeeAndAfterTax),outputAmount=CurrencyAmount.fromRawAmount(inputAmount.currency.equals(this.token0)?this.token1:this.token0,JSBI.divide(numerator,denominator));if(JSBI.equal(outputAmount.quotient,ZERO))throw new InsufficientInputAmountError;var percentAfterBuyFees=calculateFotFees?this.derivePercentAfterBuyFees(outputAmount):ZERO_PERCENT,outputAmountAfterTax=percentAfterBuyFees.greaterThan(ZERO_PERCENT)?CurrencyAmount.fromRawAmount(outputAmount.currency,outputAmount.multiply(percentAfterBuyFees).quotient):outputAmount;if(JSBI.equal(outputAmountAfterTax.quotient,ZERO))throw new InsufficientInputAmountError;return[outputAmountAfterTax,new Pair(inputReserve.add(inputAmountAfterTax),outputReserve.subtract(outputAmountAfterTax))]},_proto.getInputAmount=function(outputAmount,calculateFotFees){void 0===calculateFotFees&&(calculateFotFees=!0),this.involvesToken(outputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1));var percentAfterBuyFees=calculateFotFees?this.derivePercentAfterBuyFees(outputAmount):ZERO_PERCENT,outputAmountBeforeTax=percentAfterBuyFees.greaterThan(ZERO_PERCENT)?CurrencyAmount.fromRawAmount(outputAmount.currency,JSBI.add(outputAmount.divide(percentAfterBuyFees).quotient,ONE)):outputAmount;if(JSBI.equal(this.reserve0.quotient,ZERO)||JSBI.equal(this.reserve1.quotient,ZERO)||JSBI.greaterThanOrEqual(outputAmount.quotient,this.reserveOf(outputAmount.currency).quotient)||JSBI.greaterThanOrEqual(outputAmountBeforeTax.quotient,this.reserveOf(outputAmount.currency).quotient))throw new InsufficientReservesError;var outputReserve=this.reserveOf(outputAmount.currency),inputReserve=this.reserveOf(outputAmount.currency.equals(this.token0)?this.token1:this.token0),numerator=JSBI.multiply(JSBI.multiply(inputReserve.quotient,outputAmountBeforeTax.quotient),_1000),denominator=JSBI.multiply(JSBI.subtract(outputReserve.quotient,outputAmountBeforeTax.quotient),_997),inputAmount=CurrencyAmount.fromRawAmount(outputAmount.currency.equals(this.token0)?this.token1:this.token0,JSBI.add(JSBI.divide(numerator,denominator),ONE)),percentAfterSellFees=calculateFotFees?this.derivePercentAfterSellFees(inputAmount):ZERO_PERCENT;return[percentAfterSellFees.greaterThan(ZERO_PERCENT)?CurrencyAmount.fromRawAmount(inputAmount.currency,JSBI.add(inputAmount.divide(percentAfterSellFees).quotient,ONE)):inputAmount,new Pair(inputReserve.add(inputAmount),outputReserve.subtract(outputAmount))]},_proto.getLiquidityMinted=function(totalSupply,tokenAmountA,tokenAmountB){totalSupply.currency.equals(this.liquidityToken)||("production"!==process.env.NODE_ENV?invariant(!1,"LIQUIDITY"):invariant(!1));var liquidity,tokenAmounts=tokenAmountA.currency.sortsBefore(tokenAmountB.currency)?[tokenAmountA,tokenAmountB]:[tokenAmountB,tokenAmountA];if(tokenAmounts[0].currency.equals(this.token0)&&tokenAmounts[1].currency.equals(this.token1)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),JSBI.equal(totalSupply.quotient,ZERO))liquidity=JSBI.subtract(sqrt(JSBI.multiply(tokenAmounts[0].quotient,tokenAmounts[1].quotient)),MINIMUM_LIQUIDITY);else{var amount0=JSBI.divide(JSBI.multiply(tokenAmounts[0].quotient,totalSupply.quotient),this.reserve0.quotient),amount1=JSBI.divide(JSBI.multiply(tokenAmounts[1].quotient,totalSupply.quotient),this.reserve1.quotient);liquidity=JSBI.lessThanOrEqual(amount0,amount1)?amount0:amount1}if(!JSBI.greaterThan(liquidity,ZERO))throw new InsufficientInputAmountError;return CurrencyAmount.fromRawAmount(this.liquidityToken,liquidity)},_proto.getLiquidityValue=function(token,totalSupply,liquidity,feeOn,kLast){var totalSupplyAdjusted;if(void 0===feeOn&&(feeOn=!1),this.involvesToken(token)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),totalSupply.currency.equals(this.liquidityToken)||("production"!==process.env.NODE_ENV?invariant(!1,"TOTAL_SUPPLY"):invariant(!1)),liquidity.currency.equals(this.liquidityToken)||("production"!==process.env.NODE_ENV?invariant(!1,"LIQUIDITY"):invariant(!1)),JSBI.lessThanOrEqual(liquidity.quotient,totalSupply.quotient)||("production"!==process.env.NODE_ENV?invariant(!1,"LIQUIDITY"):invariant(!1)),feeOn){kLast||("production"!==process.env.NODE_ENV?invariant(!1,"K_LAST"):invariant(!1));var kLastParsed=JSBI.BigInt(kLast);if(JSBI.equal(kLastParsed,ZERO))totalSupplyAdjusted=totalSupply;else{var rootK=sqrt(JSBI.multiply(this.reserve0.quotient,this.reserve1.quotient)),rootKLast=sqrt(kLastParsed);if(JSBI.greaterThan(rootK,rootKLast)){var numerator=JSBI.multiply(totalSupply.quotient,JSBI.subtract(rootK,rootKLast)),denominator=JSBI.add(JSBI.multiply(rootK,FIVE),rootKLast),feeLiquidity=JSBI.divide(numerator,denominator);totalSupplyAdjusted=totalSupply.add(CurrencyAmount.fromRawAmount(this.liquidityToken,feeLiquidity))}else totalSupplyAdjusted=totalSupply}}else totalSupplyAdjusted=totalSupply;return CurrencyAmount.fromRawAmount(token,JSBI.divide(JSBI.multiply(liquidity.quotient,this.reserveOf(token).quotient),totalSupplyAdjusted.quotient))},_proto.derivePercentAfterSellFees=function(inputAmount){var sellFeeBips=this.token0.wrapped.equals(inputAmount.wrapped.currency)?this.token0.wrapped.sellFeeBps:this.token1.wrapped.sellFeeBps;return null!=sellFeeBips&&sellFeeBips.gt(BigNumber.from(0))?ONE_HUNDRED_PERCENT.subtract(new Percent(JSBI.BigInt(sellFeeBips)).divide(BASIS_POINTS)):ZERO_PERCENT},_proto.derivePercentAfterBuyFees=function(outputAmount){var buyFeeBps=this.token0.wrapped.equals(outputAmount.wrapped.currency)?this.token0.wrapped.buyFeeBps:this.token1.wrapped.buyFeeBps;return null!=buyFeeBps&&buyFeeBps.gt(BigNumber.from(0))?ONE_HUNDRED_PERCENT.subtract(new Percent(JSBI.BigInt(buyFeeBps)).divide(BASIS_POINTS)):ZERO_PERCENT},_createClass(Pair,[{key:"token0Price",get:function(){var result=this.tokenAmounts[1].divide(this.tokenAmounts[0]);return new Price(this.token0,this.token1,result.denominator,result.numerator)}},{key:"token1Price",get:function(){var result=this.tokenAmounts[0].divide(this.tokenAmounts[1]);return new Price(this.token1,this.token0,result.denominator,result.numerator)}},{key:"chainId",get:function(){return this.token0.chainId}},{key:"token0",get:function(){return this.tokenAmounts[0].currency}},{key:"token1",get:function(){return this.tokenAmounts[1].currency}},{key:"reserve0",get:function(){return this.tokenAmounts[0]}},{key:"reserve1",get:function(){return this.tokenAmounts[1]}}]),Pair}(),Route=function(){function Route(pairs,input,output){this._midPrice=null,pairs.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"PAIRS"):invariant(!1));var chainId=pairs[0].chainId;pairs.every((function(pair){return pair.chainId===chainId}))||("production"!==process.env.NODE_ENV?invariant(!1,"CHAIN_IDS"):invariant(!1));var wrappedInput=input.wrapped;pairs[0].involvesToken(wrappedInput)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT"):invariant(!1)),void 0===output||pairs[pairs.length-1].involvesToken(output.wrapped)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT"):invariant(!1));for(var _step,path=[wrappedInput],_iterator=_createForOfIteratorHelperLoose(pairs.entries());!(_step=_iterator()).done;){var _step$value=_step.value,i=_step$value[0],pair=_step$value[1],currentInput=path[i];currentInput.equals(pair.token0)||currentInput.equals(pair.token1)||("production"!==process.env.NODE_ENV?invariant(!1,"PATH"):invariant(!1));var _output=currentInput.equals(pair.token0)?pair.token1:pair.token0;path.push(_output)}this.pairs=pairs,this.path=path,this.input=input,this.output=output}return _createClass(Route,[{key:"midPrice",get:function(){if(null!==this._midPrice)return this._midPrice;for(var _step2,prices=[],_iterator2=_createForOfIteratorHelperLoose(this.pairs.entries());!(_step2=_iterator2()).done;){var _step2$value=_step2.value,i=_step2$value[0],pair=_step2$value[1];prices.push(this.path[i].equals(pair.token0)?new Price(pair.reserve0.currency,pair.reserve1.currency,pair.reserve0.quotient,pair.reserve1.quotient):new Price(pair.reserve1.currency,pair.reserve0.currency,pair.reserve1.quotient,pair.reserve0.quotient))}var reduced=prices.slice(1).reduce((function(accumulator,currentValue){return accumulator.multiply(currentValue)}),prices[0]);return this._midPrice=new Price(this.input,this.output,reduced.denominator,reduced.numerator)}},{key:"chainId",get:function(){return this.pairs[0].chainId}}]),Route}();function inputOutputComparator(a,b){return a.inputAmount.currency.equals(b.inputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT_CURRENCY"):invariant(!1)),a.outputAmount.currency.equals(b.outputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT_CURRENCY"):invariant(!1)),a.outputAmount.equalTo(b.outputAmount)?a.inputAmount.equalTo(b.inputAmount)?0:a.inputAmount.lessThan(b.inputAmount)?-1:1:a.outputAmount.lessThan(b.outputAmount)?1:-1}function tradeComparator(a,b){var ioComp=inputOutputComparator(a,b);return 0!==ioComp?ioComp:a.priceImpact.lessThan(b.priceImpact)?-1:a.priceImpact.greaterThan(b.priceImpact)?1:a.route.path.length-b.route.path.length}var Trade=function(){function Trade(route,amount,tradeType){this.route=route,this.tradeType=tradeType;var tokenAmounts=new Array(route.path.length);if(tradeType===TradeType.EXACT_INPUT){amount.currency.equals(route.input)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT"):invariant(!1)),tokenAmounts[0]=amount.wrapped;for(var i=0;i<route.path.length-1;i++){var outputAmount=route.pairs[i].getOutputAmount(tokenAmounts[i])[0];tokenAmounts[i+1]=outputAmount}this.inputAmount=CurrencyAmount.fromFractionalAmount(route.input,amount.numerator,amount.denominator),this.outputAmount=CurrencyAmount.fromFractionalAmount(route.output,tokenAmounts[tokenAmounts.length-1].numerator,tokenAmounts[tokenAmounts.length-1].denominator)}else{amount.currency.equals(route.output)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT"):invariant(!1)),tokenAmounts[tokenAmounts.length-1]=amount.wrapped;for(var _i=route.path.length-1;_i>0;_i--){var inputAmount=route.pairs[_i-1].getInputAmount(tokenAmounts[_i])[0];tokenAmounts[_i-1]=inputAmount}this.inputAmount=CurrencyAmount.fromFractionalAmount(route.input,tokenAmounts[0].numerator,tokenAmounts[0].denominator),this.outputAmount=CurrencyAmount.fromFractionalAmount(route.output,amount.numerator,amount.denominator)}this.executionPrice=new Price(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.quotient,this.outputAmount.quotient),this.priceImpact=computePriceImpact(route.midPrice,this.inputAmount,this.outputAmount)}Trade.exactIn=function(route,amountIn){return new Trade(route,amountIn,TradeType.EXACT_INPUT)},Trade.exactOut=function(route,amountOut){return new Trade(route,amountOut,TradeType.EXACT_OUTPUT)};var _proto=Trade.prototype;return _proto.minimumAmountOut=function(slippageTolerance){if(slippageTolerance.lessThan(ZERO)&&("production"!==process.env.NODE_ENV?invariant(!1,"SLIPPAGE_TOLERANCE"):invariant(!1)),this.tradeType===TradeType.EXACT_OUTPUT)return this.outputAmount;var slippageAdjustedAmountOut=new Fraction(ONE).add(slippageTolerance).invert().multiply(this.outputAmount.quotient).quotient;return CurrencyAmount.fromRawAmount(this.outputAmount.currency,slippageAdjustedAmountOut)},_proto.maximumAmountIn=function(slippageTolerance){if(slippageTolerance.lessThan(ZERO)&&("production"!==process.env.NODE_ENV?invariant(!1,"SLIPPAGE_TOLERANCE"):invariant(!1)),this.tradeType===TradeType.EXACT_INPUT)return this.inputAmount;var slippageAdjustedAmountIn=new Fraction(ONE).add(slippageTolerance).multiply(this.inputAmount.quotient).quotient;return CurrencyAmount.fromRawAmount(this.inputAmount.currency,slippageAdjustedAmountIn)},Trade.bestTradeExactIn=function(pairs,currencyAmountIn,currencyOut,_temp,currentPairs,nextAmountIn,bestTrades){var _ref=void 0===_temp?{}:_temp,_ref$maxNumResults=_ref.maxNumResults,maxNumResults=void 0===_ref$maxNumResults?3:_ref$maxNumResults,_ref$maxHops=_ref.maxHops,maxHops=void 0===_ref$maxHops?3:_ref$maxHops;void 0===currentPairs&&(currentPairs=[]),void 0===nextAmountIn&&(nextAmountIn=currencyAmountIn),void 0===bestTrades&&(bestTrades=[]),pairs.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"PAIRS"):invariant(!1)),maxHops>0||("production"!==process.env.NODE_ENV?invariant(!1,"MAX_HOPS"):invariant(!1)),currencyAmountIn===nextAmountIn||currentPairs.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"INVALID_RECURSION"):invariant(!1));for(var amountIn=nextAmountIn.wrapped,tokenOut=currencyOut.wrapped,i=0;i<pairs.length;i++){var pair=pairs[i];if((pair.token0.equals(amountIn.currency)||pair.token1.equals(amountIn.currency))&&(!pair.reserve0.equalTo(ZERO)&&!pair.reserve1.equalTo(ZERO))){var amountOut=void 0;try{amountOut=pair.getOutputAmount(amountIn)[0]}catch(error){if(error.isInsufficientInputAmountError)continue;throw error}if(amountOut.currency.equals(tokenOut))sortedInsert(bestTrades,new Trade(new Route([].concat(currentPairs,[pair]),currencyAmountIn.currency,currencyOut),currencyAmountIn,TradeType.EXACT_INPUT),maxNumResults,tradeComparator);else if(maxHops>1&&pairs.length>1){var pairsExcludingThisPair=pairs.slice(0,i).concat(pairs.slice(i+1,pairs.length));Trade.bestTradeExactIn(pairsExcludingThisPair,currencyAmountIn,currencyOut,{maxNumResults:maxNumResults,maxHops:maxHops-1},[].concat(currentPairs,[pair]),amountOut,bestTrades)}}}return bestTrades},_proto.worstExecutionPrice=function(slippageTolerance){return new Price(this.inputAmount.currency,this.outputAmount.currency,this.maximumAmountIn(slippageTolerance).quotient,this.minimumAmountOut(slippageTolerance).quotient)},Trade.bestTradeExactOut=function(pairs,currencyIn,currencyAmountOut,_temp2,currentPairs,nextAmountOut,bestTrades){var _ref2=void 0===_temp2?{}:_temp2,_ref2$maxNumResults=_ref2.maxNumResults,maxNumResults=void 0===_ref2$maxNumResults?3:_ref2$maxNumResults,_ref2$maxHops=_ref2.maxHops,maxHops=void 0===_ref2$maxHops?3:_ref2$maxHops;void 0===currentPairs&&(currentPairs=[]),void 0===nextAmountOut&&(nextAmountOut=currencyAmountOut),void 0===bestTrades&&(bestTrades=[]),pairs.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"PAIRS"):invariant(!1)),maxHops>0||("production"!==process.env.NODE_ENV?invariant(!1,"MAX_HOPS"):invariant(!1)),currencyAmountOut===nextAmountOut||currentPairs.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"INVALID_RECURSION"):invariant(!1));for(var amountOut=nextAmountOut.wrapped,tokenIn=currencyIn.wrapped,i=0;i<pairs.length;i++){var pair=pairs[i];if((pair.token0.equals(amountOut.currency)||pair.token1.equals(amountOut.currency))&&(!pair.reserve0.equalTo(ZERO)&&!pair.reserve1.equalTo(ZERO))){var amountIn=void 0;try{amountIn=pair.getInputAmount(amountOut)[0]}catch(error){if(error.isInsufficientReservesError)continue;throw error}if(amountIn.currency.equals(tokenIn))sortedInsert(bestTrades,new Trade(new Route([pair].concat(currentPairs),currencyIn,currencyAmountOut.currency),currencyAmountOut,TradeType.EXACT_OUTPUT),maxNumResults,tradeComparator);else if(maxHops>1&&pairs.length>1){var pairsExcludingThisPair=pairs.slice(0,i).concat(pairs.slice(i+1,pairs.length));Trade.bestTradeExactOut(pairsExcludingThisPair,currencyIn,currencyAmountOut,{maxNumResults:maxNumResults,maxHops:maxHops-1},[pair].concat(currentPairs),amountIn,bestTrades)}}}return bestTrades},Trade}();function toHex(currencyAmount){return"0x"+currencyAmount.quotient.toString(16)}var ZERO_HEX="0x0",Router=function(){function Router(){}return Router.swapCallParameters=function(trade,options){var etherIn=trade.inputAmount.currency.isNative,etherOut=trade.outputAmount.currency.isNative;etherIn&&etherOut&&("production"!==process.env.NODE_ENV?invariant(!1,"ETHER_IN_OUT"):invariant(!1)),!("ttl"in options)||options.ttl>0||("production"!==process.env.NODE_ENV?invariant(!1,"TTL"):invariant(!1));var methodName,args,value,to=validateAndParseAddress(options.recipient),amountIn=toHex(trade.maximumAmountIn(options.allowedSlippage)),amountOut=toHex(trade.minimumAmountOut(options.allowedSlippage)),path=trade.route.path.map((function(token){return token.address})),deadline="ttl"in options?"0x"+(Math.floor((new Date).getTime()/1e3)+options.ttl).toString(16):"0x"+options.deadline.toString(16),useFeeOnTransfer=Boolean(options.feeOnTransfer);switch(trade.tradeType){case TradeType.EXACT_INPUT:etherIn?(methodName=useFeeOnTransfer?"swapExactETHForTokensSupportingFeeOnTransferTokens":"swapExactETHForTokens",args=[amountOut,path,to,deadline],value=amountIn):etherOut?(methodName=useFeeOnTransfer?"swapExactTokensForETHSupportingFeeOnTransferTokens":"swapExactTokensForETH",args=[amountIn,amountOut,path,to,deadline],value=ZERO_HEX):(methodName=useFeeOnTransfer?"swapExactTokensForTokensSupportingFeeOnTransferTokens":"swapExactTokensForTokens",args=[amountIn,amountOut,path,to,deadline],value=ZERO_HEX);break;case TradeType.EXACT_OUTPUT:useFeeOnTransfer&&("production"!==process.env.NODE_ENV?invariant(!1,"EXACT_OUT_FOT"):invariant(!1)),etherIn?(methodName="swapETHForExactTokens",args=[amountOut,path,to,deadline],value=amountIn):etherOut?(methodName="swapTokensForExactETH",args=[amountOut,amountIn,path,to,deadline],value=ZERO_HEX):(methodName="swapTokensForExactTokens",args=[amountOut,amountIn,path,to,deadline],value=ZERO_HEX)}return{methodName:methodName,args:args,value:value}},Router}();export{FACTORY_ADDRESS_MAP,INIT_CODE_HASH,InsufficientInputAmountError,InsufficientReservesError,MINIMUM_LIQUIDITY,Pair,Route,Router,Trade,computePairAddress,inputOutputComparator,tradeComparator};