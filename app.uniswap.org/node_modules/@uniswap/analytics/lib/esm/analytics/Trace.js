import{jsx as _jsx}from"react/jsx-runtime";import{createContext,memo,useContext,useEffect,useMemo}from"react";import{sendAnalyticsEvent,analyticsConfig}from".";const DEFAULT_EVENT="Page Viewed";export const TraceContext=createContext({});export function useTrace(trace){const parentTrace=useContext(TraceContext);return useMemo((()=>({...parentTrace,...trace})),[parentTrace,trace])}export const Trace=memo((({shouldLogImpression:shouldLogImpression,name:name,children:children,page:page,section:section,modal:modal,element:element,properties:properties})=>{const parentTrace=useTrace(),combinedProps=useMemo((()=>({...parentTrace,...Object.fromEntries(Object.entries({page:page,section:section,modal:modal,element:element}).filter((([_,v])=>void 0!==v)))})),[element,parentTrace,page,modal,section]);return useEffect((()=>{shouldLogImpression&&sendAnalyticsEvent(name??analyticsConfig?.defaultEventName??"Page Viewed",{...combinedProps,...properties,git_commit_hash:analyticsConfig?.commitHash})}),[shouldLogImpression]),_jsx(TraceContext.Provider,{value:combinedProps,children:children})}));Trace.displayName="Trace";