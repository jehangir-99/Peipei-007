import{ChainId,computeZksyncCreate2Address,MaxUint256,sqrt,Price,CurrencyAmount,Percent,TradeType,Fraction,sortedInsert,validateAndParseAddress}from"@uniswap/sdk-core";import JSBI from"jsbi";import invariant from"tiny-invariant";import{defaultAbiCoder,Interface}from"@ethersproject/abi";import{getCreate2Address}from"@ethersproject/address";import{keccak256,pack}from"@ethersproject/solidity";import IMulticall from"@uniswap/v3-periphery/artifacts/contracts/interfaces/IMulticall.sol/IMulticall.json";import INonfungiblePositionManager from"@uniswap/v3-periphery/artifacts/contracts/NonfungiblePositionManager.sol/NonfungiblePositionManager.json";import ISelfPermit from"@uniswap/v3-periphery/artifacts/contracts/interfaces/ISelfPermit.sol/ISelfPermit.json";import IPeripheryPaymentsWithFee from"@uniswap/v3-periphery/artifacts/contracts/interfaces/IPeripheryPaymentsWithFee.sol/IPeripheryPaymentsWithFee.json";import IQuoter from"@uniswap/v3-periphery/artifacts/contracts/lens/Quoter.sol/Quoter.json";import IQuoterV2 from"@uniswap/swap-router-contracts/artifacts/contracts/lens/QuoterV2.sol/QuoterV2.json";import IUniswapV3Staker from"@uniswap/v3-staker/artifacts/contracts/UniswapV3Staker.sol/UniswapV3Staker.json";import ISwapRouter from"@uniswap/v3-periphery/artifacts/contracts/SwapRouter.sol/SwapRouter.json";function _regeneratorRuntime(){_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function _toPrimitive(t,r){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==typeof i?i:String(i)}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _createForOfIteratorHelperLoose(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(it)return(it=it.call(o)).next.bind(it);if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0;return function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var _TICK_SPACINGS,FeeAmount,FACTORY_ADDRESS="0x1F98431c8aD98523631AE4a59f267346ea31F984",ADDRESS_ZERO="0x0000000000000000000000000000000000000000",POOL_INIT_CODE_HASH="0xe34f199b19b2b4f47f68442619d555527d244f78a3297ea89325f843f87b8b54";function poolInitCodeHash(chainId){return chainId===ChainId.ZKSYNC?"0x010013f177ea1fcbc4520f9a3ca7cd2d1d77959e05aa66484027cb38e712aeed":POOL_INIT_CODE_HASH}!function(FeeAmount){FeeAmount[FeeAmount.LOWEST=100]="LOWEST",FeeAmount[FeeAmount.LOW=500]="LOW",FeeAmount[FeeAmount.MEDIUM=3e3]="MEDIUM",FeeAmount[FeeAmount.HIGH=1e4]="HIGH"}(FeeAmount||(FeeAmount={}));var TICK_SPACINGS=((_TICK_SPACINGS={})[FeeAmount.LOWEST]=1,_TICK_SPACINGS[FeeAmount.LOW]=10,_TICK_SPACINGS[FeeAmount.MEDIUM]=60,_TICK_SPACINGS[FeeAmount.HIGH]=200,_TICK_SPACINGS),NEGATIVE_ONE=JSBI.BigInt(-1),ZERO=JSBI.BigInt(0),ONE=JSBI.BigInt(1),Q96=JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(96)),Q192=JSBI.exponentiate(Q96,JSBI.BigInt(2));function computePoolAddress(_ref){var factoryAddress=_ref.factoryAddress,tokenA=_ref.tokenA,tokenB=_ref.tokenB,fee=_ref.fee,initCodeHashManualOverride=_ref.initCodeHashManualOverride,chainId=_ref.chainId,_ref2=tokenA.sortsBefore(tokenB)?[tokenA,tokenB]:[tokenB,tokenA],token0=_ref2[0],token1=_ref2[1],salt=keccak256(["bytes"],[defaultAbiCoder.encode(["address","address","uint24"],[token0.address,token1.address,fee])]),initCodeHash=null!=initCodeHashManualOverride?initCodeHashManualOverride:poolInitCodeHash(chainId);return chainId===ChainId.ZKSYNC?computeZksyncCreate2Address(factoryAddress,initCodeHash,salt):getCreate2Address(factoryAddress,salt,initCodeHash)}var FullMath=function(){function FullMath(){}return FullMath.mulDivRoundingUp=function(a,b,denominator){var product=JSBI.multiply(a,b),result=JSBI.divide(product,denominator);return JSBI.notEqual(JSBI.remainder(product,denominator),ZERO)&&(result=JSBI.add(result,ONE)),result},FullMath}(),MaxUint160=JSBI.subtract(JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(160)),ONE);function multiplyIn256(x,y){var product=JSBI.multiply(x,y);return JSBI.bitwiseAnd(product,MaxUint256)}function addIn256(x,y){var sum=JSBI.add(x,y);return JSBI.bitwiseAnd(sum,MaxUint256)}var SqrtPriceMath=function(){function SqrtPriceMath(){}return SqrtPriceMath.getAmount0Delta=function(sqrtRatioAX96,sqrtRatioBX96,liquidity,roundUp){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref[0],sqrtRatioBX96=_ref[1]}var numerator1=JSBI.leftShift(liquidity,JSBI.BigInt(96)),numerator2=JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96);return roundUp?FullMath.mulDivRoundingUp(FullMath.mulDivRoundingUp(numerator1,numerator2,sqrtRatioBX96),ONE,sqrtRatioAX96):JSBI.divide(JSBI.divide(JSBI.multiply(numerator1,numerator2),sqrtRatioBX96),sqrtRatioAX96)},SqrtPriceMath.getAmount1Delta=function(sqrtRatioAX96,sqrtRatioBX96,liquidity,roundUp){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref2=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref2[0],sqrtRatioBX96=_ref2[1]}return roundUp?FullMath.mulDivRoundingUp(liquidity,JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96),Q96):JSBI.divide(JSBI.multiply(liquidity,JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96)),Q96)},SqrtPriceMath.getNextSqrtPriceFromInput=function(sqrtPX96,liquidity,amountIn,zeroForOne){return JSBI.greaterThan(sqrtPX96,ZERO)||(process.env.NODE_ENV,invariant(!1)),JSBI.greaterThan(liquidity,ZERO)||(process.env.NODE_ENV,invariant(!1)),zeroForOne?this.getNextSqrtPriceFromAmount0RoundingUp(sqrtPX96,liquidity,amountIn,!0):this.getNextSqrtPriceFromAmount1RoundingDown(sqrtPX96,liquidity,amountIn,!0)},SqrtPriceMath.getNextSqrtPriceFromOutput=function(sqrtPX96,liquidity,amountOut,zeroForOne){return JSBI.greaterThan(sqrtPX96,ZERO)||(process.env.NODE_ENV,invariant(!1)),JSBI.greaterThan(liquidity,ZERO)||(process.env.NODE_ENV,invariant(!1)),zeroForOne?this.getNextSqrtPriceFromAmount1RoundingDown(sqrtPX96,liquidity,amountOut,!1):this.getNextSqrtPriceFromAmount0RoundingUp(sqrtPX96,liquidity,amountOut,!1)},SqrtPriceMath.getNextSqrtPriceFromAmount0RoundingUp=function(sqrtPX96,liquidity,amount,add){if(JSBI.equal(amount,ZERO))return sqrtPX96;var numerator1=JSBI.leftShift(liquidity,JSBI.BigInt(96));if(add){var product=multiplyIn256(amount,sqrtPX96);if(JSBI.equal(JSBI.divide(product,amount),sqrtPX96)){var denominator=addIn256(numerator1,product);if(JSBI.greaterThanOrEqual(denominator,numerator1))return FullMath.mulDivRoundingUp(numerator1,sqrtPX96,denominator)}return FullMath.mulDivRoundingUp(numerator1,ONE,JSBI.add(JSBI.divide(numerator1,sqrtPX96),amount))}var _product=multiplyIn256(amount,sqrtPX96);JSBI.equal(JSBI.divide(_product,amount),sqrtPX96)||(process.env.NODE_ENV,invariant(!1)),JSBI.greaterThan(numerator1,_product)||(process.env.NODE_ENV,invariant(!1));var _denominator=JSBI.subtract(numerator1,_product);return FullMath.mulDivRoundingUp(numerator1,sqrtPX96,_denominator)},SqrtPriceMath.getNextSqrtPriceFromAmount1RoundingDown=function(sqrtPX96,liquidity,amount,add){if(add){var quotient=JSBI.lessThanOrEqual(amount,MaxUint160)?JSBI.divide(JSBI.leftShift(amount,JSBI.BigInt(96)),liquidity):JSBI.divide(JSBI.multiply(amount,Q96),liquidity);return JSBI.add(sqrtPX96,quotient)}var _quotient=FullMath.mulDivRoundingUp(amount,Q96,liquidity);return JSBI.greaterThan(sqrtPX96,_quotient)||(process.env.NODE_ENV,invariant(!1)),JSBI.subtract(sqrtPX96,_quotient)},SqrtPriceMath}(),MAX_FEE=JSBI.exponentiate(JSBI.BigInt(10),JSBI.BigInt(6)),SwapMath=function(){function SwapMath(){}return SwapMath.computeSwapStep=function(sqrtRatioCurrentX96,sqrtRatioTargetX96,liquidity,amountRemaining,feePips){var returnValues={};feePips=JSBI.BigInt(feePips);var zeroForOne=JSBI.greaterThanOrEqual(sqrtRatioCurrentX96,sqrtRatioTargetX96),exactIn=JSBI.greaterThanOrEqual(amountRemaining,ZERO);if(exactIn){var amountRemainingLessFee=JSBI.divide(JSBI.multiply(amountRemaining,JSBI.subtract(MAX_FEE,feePips)),MAX_FEE);returnValues.amountIn=zeroForOne?SqrtPriceMath.getAmount0Delta(sqrtRatioTargetX96,sqrtRatioCurrentX96,liquidity,!0):SqrtPriceMath.getAmount1Delta(sqrtRatioCurrentX96,sqrtRatioTargetX96,liquidity,!0),JSBI.greaterThanOrEqual(amountRemainingLessFee,returnValues.amountIn)?returnValues.sqrtRatioNextX96=sqrtRatioTargetX96:returnValues.sqrtRatioNextX96=SqrtPriceMath.getNextSqrtPriceFromInput(sqrtRatioCurrentX96,liquidity,amountRemainingLessFee,zeroForOne)}else returnValues.amountOut=zeroForOne?SqrtPriceMath.getAmount1Delta(sqrtRatioTargetX96,sqrtRatioCurrentX96,liquidity,!1):SqrtPriceMath.getAmount0Delta(sqrtRatioCurrentX96,sqrtRatioTargetX96,liquidity,!1),JSBI.greaterThanOrEqual(JSBI.multiply(amountRemaining,NEGATIVE_ONE),returnValues.amountOut)?returnValues.sqrtRatioNextX96=sqrtRatioTargetX96:returnValues.sqrtRatioNextX96=SqrtPriceMath.getNextSqrtPriceFromOutput(sqrtRatioCurrentX96,liquidity,JSBI.multiply(amountRemaining,NEGATIVE_ONE),zeroForOne);var max=JSBI.equal(sqrtRatioTargetX96,returnValues.sqrtRatioNextX96);return zeroForOne?(returnValues.amountIn=max&&exactIn?returnValues.amountIn:SqrtPriceMath.getAmount0Delta(returnValues.sqrtRatioNextX96,sqrtRatioCurrentX96,liquidity,!0),returnValues.amountOut=max&&!exactIn?returnValues.amountOut:SqrtPriceMath.getAmount1Delta(returnValues.sqrtRatioNextX96,sqrtRatioCurrentX96,liquidity,!1)):(returnValues.amountIn=max&&exactIn?returnValues.amountIn:SqrtPriceMath.getAmount1Delta(sqrtRatioCurrentX96,returnValues.sqrtRatioNextX96,liquidity,!0),returnValues.amountOut=max&&!exactIn?returnValues.amountOut:SqrtPriceMath.getAmount0Delta(sqrtRatioCurrentX96,returnValues.sqrtRatioNextX96,liquidity,!1)),!exactIn&&JSBI.greaterThan(returnValues.amountOut,JSBI.multiply(amountRemaining,NEGATIVE_ONE))&&(returnValues.amountOut=JSBI.multiply(amountRemaining,NEGATIVE_ONE)),exactIn&&JSBI.notEqual(returnValues.sqrtRatioNextX96,sqrtRatioTargetX96)?returnValues.feeAmount=JSBI.subtract(amountRemaining,returnValues.amountIn):returnValues.feeAmount=FullMath.mulDivRoundingUp(returnValues.amountIn,feePips,JSBI.subtract(MAX_FEE,feePips)),[returnValues.sqrtRatioNextX96,returnValues.amountIn,returnValues.amountOut,returnValues.feeAmount]},SwapMath}(),LiquidityMath=function(){function LiquidityMath(){}return LiquidityMath.addDelta=function(x,y){return JSBI.lessThan(y,ZERO)?JSBI.subtract(x,JSBI.multiply(y,NEGATIVE_ONE)):JSBI.add(x,y)},LiquidityMath}(),TWO=JSBI.BigInt(2),POWERS_OF_2=[128,64,32,16,8,4,2,1].map((function(pow){return[pow,JSBI.exponentiate(TWO,JSBI.BigInt(pow))]}));function mostSignificantBit(x){JSBI.greaterThan(x,ZERO)||("production"!==process.env.NODE_ENV?invariant(!1,"ZERO"):invariant(!1)),JSBI.lessThanOrEqual(x,MaxUint256)||("production"!==process.env.NODE_ENV?invariant(!1,"MAX"):invariant(!1));for(var _step,msb=0,_iterator=_createForOfIteratorHelperLoose(POWERS_OF_2);!(_step=_iterator()).done;){var _step$value=_step.value,power=_step$value[0],min=_step$value[1];JSBI.greaterThanOrEqual(x,min)&&(x=JSBI.signedRightShift(x,JSBI.BigInt(power)),msb+=power)}return msb}function mulShift(val,mulBy){return JSBI.signedRightShift(JSBI.multiply(val,JSBI.BigInt(mulBy)),JSBI.BigInt(128))}var Q32=JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(32)),TickMath=function(){function TickMath(){}return TickMath.getSqrtRatioAtTick=function(tick){tick>=TickMath.MIN_TICK&&tick<=TickMath.MAX_TICK&&Number.isInteger(tick)||("production"!==process.env.NODE_ENV?invariant(!1,"TICK"):invariant(!1));var absTick=tick<0?-1*tick:tick,ratio=0!=(1&absTick)?JSBI.BigInt("0xfffcb933bd6fad37aa2d162d1a594001"):JSBI.BigInt("0x100000000000000000000000000000000");return 0!=(2&absTick)&&(ratio=mulShift(ratio,"0xfff97272373d413259a46990580e213a")),0!=(4&absTick)&&(ratio=mulShift(ratio,"0xfff2e50f5f656932ef12357cf3c7fdcc")),0!=(8&absTick)&&(ratio=mulShift(ratio,"0xffe5caca7e10e4e61c3624eaa0941cd0")),0!=(16&absTick)&&(ratio=mulShift(ratio,"0xffcb9843d60f6159c9db58835c926644")),0!=(32&absTick)&&(ratio=mulShift(ratio,"0xff973b41fa98c081472e6896dfb254c0")),0!=(64&absTick)&&(ratio=mulShift(ratio,"0xff2ea16466c96a3843ec78b326b52861")),0!=(128&absTick)&&(ratio=mulShift(ratio,"0xfe5dee046a99a2a811c461f1969c3053")),0!=(256&absTick)&&(ratio=mulShift(ratio,"0xfcbe86c7900a88aedcffc83b479aa3a4")),0!=(512&absTick)&&(ratio=mulShift(ratio,"0xf987a7253ac413176f2b074cf7815e54")),0!=(1024&absTick)&&(ratio=mulShift(ratio,"0xf3392b0822b70005940c7a398e4b70f3")),0!=(2048&absTick)&&(ratio=mulShift(ratio,"0xe7159475a2c29b7443b29c7fa6e889d9")),0!=(4096&absTick)&&(ratio=mulShift(ratio,"0xd097f3bdfd2022b8845ad8f792aa5825")),0!=(8192&absTick)&&(ratio=mulShift(ratio,"0xa9f746462d870fdf8a65dc1f90e061e5")),0!=(16384&absTick)&&(ratio=mulShift(ratio,"0x70d869a156d2a1b890bb3df62baf32f7")),0!=(32768&absTick)&&(ratio=mulShift(ratio,"0x31be135f97d08fd981231505542fcfa6")),0!=(65536&absTick)&&(ratio=mulShift(ratio,"0x9aa508b5b7a84e1c677de54f3e99bc9")),0!=(131072&absTick)&&(ratio=mulShift(ratio,"0x5d6af8dedb81196699c329225ee604")),0!=(262144&absTick)&&(ratio=mulShift(ratio,"0x2216e584f5fa1ea926041bedfe98")),0!=(524288&absTick)&&(ratio=mulShift(ratio,"0x48a170391f7dc42444e8fa2")),tick>0&&(ratio=JSBI.divide(MaxUint256,ratio)),JSBI.greaterThan(JSBI.remainder(ratio,Q32),ZERO)?JSBI.add(JSBI.divide(ratio,Q32),ONE):JSBI.divide(ratio,Q32)},TickMath.getTickAtSqrtRatio=function(sqrtRatioX96){JSBI.greaterThanOrEqual(sqrtRatioX96,TickMath.MIN_SQRT_RATIO)&&JSBI.lessThan(sqrtRatioX96,TickMath.MAX_SQRT_RATIO)||("production"!==process.env.NODE_ENV?invariant(!1,"SQRT_RATIO"):invariant(!1));var r,sqrtRatioX128=JSBI.leftShift(sqrtRatioX96,JSBI.BigInt(32)),msb=mostSignificantBit(sqrtRatioX128);r=JSBI.greaterThanOrEqual(JSBI.BigInt(msb),JSBI.BigInt(128))?JSBI.signedRightShift(sqrtRatioX128,JSBI.BigInt(msb-127)):JSBI.leftShift(sqrtRatioX128,JSBI.BigInt(127-msb));for(var log_2=JSBI.leftShift(JSBI.subtract(JSBI.BigInt(msb),JSBI.BigInt(128)),JSBI.BigInt(64)),i=0;i<14;i++){r=JSBI.signedRightShift(JSBI.multiply(r,r),JSBI.BigInt(127));var f=JSBI.signedRightShift(r,JSBI.BigInt(128));log_2=JSBI.bitwiseOr(log_2,JSBI.leftShift(f,JSBI.BigInt(63-i))),r=JSBI.signedRightShift(r,f)}var log_sqrt10001=JSBI.multiply(log_2,JSBI.BigInt("255738958999603826347141")),tickLow=JSBI.toNumber(JSBI.signedRightShift(JSBI.subtract(log_sqrt10001,JSBI.BigInt("3402992956809132418596140100660247210")),JSBI.BigInt(128))),tickHigh=JSBI.toNumber(JSBI.signedRightShift(JSBI.add(log_sqrt10001,JSBI.BigInt("291339464771989622907027621153398088495")),JSBI.BigInt(128)));return tickLow===tickHigh?tickLow:JSBI.lessThanOrEqual(TickMath.getSqrtRatioAtTick(tickHigh),sqrtRatioX96)?tickHigh:tickLow},TickMath}();function v3Swap(_x,_x2,_x3,_x4,_x5,_x6,_x7,_x8,_x9){return _v3Swap.apply(this,arguments)}function _v3Swap(){return(_v3Swap=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(fee,sqrtRatioX96,tickCurrent,liquidity,tickSpacing,tickDataProvider,zeroForOne,amountSpecified,sqrtPriceLimitX96){var exactInput,state,step,_yield$tickDataProvid,_SwapMath$computeSwap,liquidityNet;return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:sqrtPriceLimitX96||(sqrtPriceLimitX96=zeroForOne?JSBI.add(TickMath.MIN_SQRT_RATIO,ONE):JSBI.subtract(TickMath.MAX_SQRT_RATIO,ONE)),zeroForOne?(JSBI.greaterThan(sqrtPriceLimitX96,TickMath.MIN_SQRT_RATIO)||("production"!==process.env.NODE_ENV?invariant(!1,"RATIO_MIN"):invariant(!1)),JSBI.lessThan(sqrtPriceLimitX96,sqrtRatioX96)||("production"!==process.env.NODE_ENV?invariant(!1,"RATIO_CURRENT"):invariant(!1))):(JSBI.lessThan(sqrtPriceLimitX96,TickMath.MAX_SQRT_RATIO)||("production"!==process.env.NODE_ENV?invariant(!1,"RATIO_MAX"):invariant(!1)),JSBI.greaterThan(sqrtPriceLimitX96,sqrtRatioX96)||("production"!==process.env.NODE_ENV?invariant(!1,"RATIO_CURRENT"):invariant(!1))),exactInput=JSBI.greaterThanOrEqual(amountSpecified,ZERO),state={amountSpecifiedRemaining:amountSpecified,amountCalculated:ZERO,sqrtPriceX96:sqrtRatioX96,tick:tickCurrent,liquidity:liquidity};case 4:if(!JSBI.notEqual(state.amountSpecifiedRemaining,ZERO)||state.sqrtPriceX96===sqrtPriceLimitX96){_context.next=35;break}return(step={}).sqrtPriceStartX96=state.sqrtPriceX96,_context.next=9,tickDataProvider.nextInitializedTickWithinOneWord(state.tick,zeroForOne,tickSpacing);case 9:if(_yield$tickDataProvid=_context.sent,step.tickNext=_yield$tickDataProvid[0],step.initialized=_yield$tickDataProvid[1],step.tickNext<TickMath.MIN_TICK?step.tickNext=TickMath.MIN_TICK:step.tickNext>TickMath.MAX_TICK&&(step.tickNext=TickMath.MAX_TICK),step.sqrtPriceNextX96=TickMath.getSqrtRatioAtTick(step.tickNext),_SwapMath$computeSwap=SwapMath.computeSwapStep(state.sqrtPriceX96,(zeroForOne?JSBI.lessThan(step.sqrtPriceNextX96,sqrtPriceLimitX96):JSBI.greaterThan(step.sqrtPriceNextX96,sqrtPriceLimitX96))?sqrtPriceLimitX96:step.sqrtPriceNextX96,state.liquidity,state.amountSpecifiedRemaining,fee),state.sqrtPriceX96=_SwapMath$computeSwap[0],step.amountIn=_SwapMath$computeSwap[1],step.amountOut=_SwapMath$computeSwap[2],step.feeAmount=_SwapMath$computeSwap[3],exactInput?(state.amountSpecifiedRemaining=JSBI.subtract(state.amountSpecifiedRemaining,JSBI.add(step.amountIn,step.feeAmount)),state.amountCalculated=JSBI.subtract(state.amountCalculated,step.amountOut)):(state.amountSpecifiedRemaining=JSBI.add(state.amountSpecifiedRemaining,step.amountOut),state.amountCalculated=JSBI.add(state.amountCalculated,JSBI.add(step.amountIn,step.feeAmount))),!JSBI.equal(state.sqrtPriceX96,step.sqrtPriceNextX96)){_context.next=32;break}if(!step.initialized){_context.next=29;break}return _context.t0=JSBI,_context.next=25,tickDataProvider.getTick(step.tickNext);case 25:_context.t1=_context.sent.liquidityNet,liquidityNet=_context.t0.BigInt.call(_context.t0,_context.t1),zeroForOne&&(liquidityNet=JSBI.multiply(liquidityNet,NEGATIVE_ONE)),state.liquidity=LiquidityMath.addDelta(state.liquidity,liquidityNet);case 29:state.tick=zeroForOne?step.tickNext-1:step.tickNext,_context.next=33;break;case 32:JSBI.notEqual(state.sqrtPriceX96,step.sqrtPriceStartX96)&&(state.tick=TickMath.getTickAtSqrtRatio(state.sqrtPriceX96));case 33:_context.next=4;break;case 35:return _context.abrupt("return",{amountCalculated:state.amountCalculated,sqrtRatioX96:state.sqrtPriceX96,liquidity:state.liquidity,tickCurrent:state.tick});case 36:case"end":return _context.stop()}}),_callee)})))).apply(this,arguments)}TickMath.MIN_TICK=-887272,TickMath.MAX_TICK=-TickMath.MIN_TICK,TickMath.MIN_SQRT_RATIO=JSBI.BigInt("4295128739"),TickMath.MAX_SQRT_RATIO=JSBI.BigInt("1461446703485210103287273052203988822378723970342");var NoTickDataProvider=function(){function NoTickDataProvider(){}var _proto=NoTickDataProvider.prototype;return _proto.getTick=function(){var _getTick=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(_tick){return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:throw new Error(NoTickDataProvider.ERROR_MESSAGE);case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _getTick.apply(this,arguments)}}(),_proto.nextInitializedTickWithinOneWord=function(){var _nextInitializedTickWithinOneWord=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(_tick,_lte,_tickSpacing){return _regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:throw new Error(NoTickDataProvider.ERROR_MESSAGE);case 1:case"end":return _context2.stop()}}),_callee2)})));return function(_x2,_x3,_x4){return _nextInitializedTickWithinOneWord.apply(this,arguments)}}(),NoTickDataProvider}();function isSorted(list,comparator){for(var i=0;i<list.length-1;i++)if(comparator(list[i],list[i+1])>0)return!1;return!0}function tickComparator(a,b){return a.index-b.index}NoTickDataProvider.ERROR_MESSAGE="No tick data provider was given";var TickList=function(){function TickList(){}return TickList.validateList=function(ticks,tickSpacing){tickSpacing>0||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_SPACING_NONZERO"):invariant(!1)),ticks.every((function(_ref){return _ref.index%tickSpacing==0}))||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_SPACING"):invariant(!1)),JSBI.equal(ticks.reduce((function(accumulator,_ref2){var liquidityNet=_ref2.liquidityNet;return JSBI.add(accumulator,liquidityNet)}),ZERO),ZERO)||("production"!==process.env.NODE_ENV?invariant(!1,"ZERO_NET"):invariant(!1)),isSorted(ticks,tickComparator)||("production"!==process.env.NODE_ENV?invariant(!1,"SORTED"):invariant(!1))},TickList.isBelowSmallest=function(ticks,tick){return ticks.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"LENGTH"):invariant(!1)),tick<ticks[0].index},TickList.isAtOrAboveLargest=function(ticks,tick){return ticks.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"LENGTH"):invariant(!1)),tick>=ticks[ticks.length-1].index},TickList.getTick=function(ticks,index){var tick=ticks[this.binarySearch(ticks,index)];return tick.index!==index&&("production"!==process.env.NODE_ENV?invariant(!1,"NOT_CONTAINED"):invariant(!1)),tick},TickList.binarySearch=function(ticks,tick){this.isBelowSmallest(ticks,tick)&&("production"!==process.env.NODE_ENV?invariant(!1,"BELOW_SMALLEST"):invariant(!1));for(var i,l=0,r=ticks.length-1;;){if(ticks[i=Math.floor((l+r)/2)].index<=tick&&(i===ticks.length-1||ticks[i+1].index>tick))return i;ticks[i].index<tick?l=i+1:r=i-1}},TickList.nextInitializedTick=function(ticks,tick,lte){return lte?(TickList.isBelowSmallest(ticks,tick)&&("production"!==process.env.NODE_ENV?invariant(!1,"BELOW_SMALLEST"):invariant(!1)),TickList.isAtOrAboveLargest(ticks,tick)?ticks[ticks.length-1]:ticks[this.binarySearch(ticks,tick)]):(this.isAtOrAboveLargest(ticks,tick)&&("production"!==process.env.NODE_ENV?invariant(!1,"AT_OR_ABOVE_LARGEST"):invariant(!1)),this.isBelowSmallest(ticks,tick)?ticks[0]:ticks[this.binarySearch(ticks,tick)+1])},TickList.nextInitializedTickWithinOneWord=function(ticks,tick,lte,tickSpacing){var compressed=Math.floor(tick/tickSpacing);if(lte){var minimum=(compressed>>8<<8)*tickSpacing;if(TickList.isBelowSmallest(ticks,tick))return[minimum,!1];var index=TickList.nextInitializedTick(ticks,tick,lte).index,nextInitializedTick=Math.max(minimum,index);return[nextInitializedTick,nextInitializedTick===index]}var maximum=(((compressed+1>>8)+1<<8)-1)*tickSpacing;if(this.isAtOrAboveLargest(ticks,tick))return[maximum,!1];var _index2=this.nextInitializedTick(ticks,tick,lte).index,_nextInitializedTick=Math.min(maximum,_index2);return[_nextInitializedTick,_nextInitializedTick===_index2]},TickList}();function toHex(bigintIsh){var hex=JSBI.BigInt(bigintIsh).toString(16);return hex.length%2!=0&&(hex="0"+hex),"0x"+hex}function encodeRouteToPath(route,exactOutput){var firstInputToken=route.input.wrapped,_route$pools$reduce=route.pools.reduce((function(_ref,pool,index){var inputToken=_ref.inputToken,path=_ref.path,types=_ref.types,outputToken=pool.token0.equals(inputToken)?pool.token1:pool.token0;return 0===index?{inputToken:outputToken,types:["address","uint24","address"],path:[inputToken.address,pool.fee,outputToken.address]}:{inputToken:outputToken,types:[].concat(types,["uint24","address"]),path:[].concat(path,[pool.fee,outputToken.address])}}),{inputToken:firstInputToken,path:[],types:[]}),path=_route$pools$reduce.path,types=_route$pools$reduce.types;return exactOutput?pack(types.reverse(),path.reverse()):pack(types,path)}function encodeSqrtRatioX96(amount1,amount0){var numerator=JSBI.leftShift(JSBI.BigInt(amount1),JSBI.BigInt(192)),denominator=JSBI.BigInt(amount0),ratioX192=JSBI.divide(numerator,denominator);return sqrt(ratioX192)}function maxLiquidityForAmount0Imprecise(sqrtRatioAX96,sqrtRatioBX96,amount0){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref[0],sqrtRatioBX96=_ref[1]}var intermediate=JSBI.divide(JSBI.multiply(sqrtRatioAX96,sqrtRatioBX96),Q96);return JSBI.divide(JSBI.multiply(JSBI.BigInt(amount0),intermediate),JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96))}function maxLiquidityForAmount0Precise(sqrtRatioAX96,sqrtRatioBX96,amount0){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref2=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref2[0],sqrtRatioBX96=_ref2[1]}var numerator=JSBI.multiply(JSBI.multiply(JSBI.BigInt(amount0),sqrtRatioAX96),sqrtRatioBX96),denominator=JSBI.multiply(Q96,JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96));return JSBI.divide(numerator,denominator)}function maxLiquidityForAmount1(sqrtRatioAX96,sqrtRatioBX96,amount1){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref3=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref3[0],sqrtRatioBX96=_ref3[1]}return JSBI.divide(JSBI.multiply(JSBI.BigInt(amount1),Q96),JSBI.subtract(sqrtRatioBX96,sqrtRatioAX96))}function maxLiquidityForAmounts(sqrtRatioCurrentX96,sqrtRatioAX96,sqrtRatioBX96,amount0,amount1,useFullPrecision){if(JSBI.greaterThan(sqrtRatioAX96,sqrtRatioBX96)){var _ref4=[sqrtRatioBX96,sqrtRatioAX96];sqrtRatioAX96=_ref4[0],sqrtRatioBX96=_ref4[1]}var maxLiquidityForAmount0=useFullPrecision?maxLiquidityForAmount0Precise:maxLiquidityForAmount0Imprecise;if(JSBI.lessThanOrEqual(sqrtRatioCurrentX96,sqrtRatioAX96))return maxLiquidityForAmount0(sqrtRatioAX96,sqrtRatioBX96,amount0);if(JSBI.lessThan(sqrtRatioCurrentX96,sqrtRatioBX96)){var liquidity0=maxLiquidityForAmount0(sqrtRatioCurrentX96,sqrtRatioBX96,amount0),liquidity1=maxLiquidityForAmount1(sqrtRatioAX96,sqrtRatioCurrentX96,amount1);return JSBI.lessThan(liquidity0,liquidity1)?liquidity0:liquidity1}return maxLiquidityForAmount1(sqrtRatioAX96,sqrtRatioBX96,amount1)}function nearestUsableTick(tick,tickSpacing){Number.isInteger(tick)&&Number.isInteger(tickSpacing)||("production"!==process.env.NODE_ENV?invariant(!1,"INTEGERS"):invariant(!1)),tickSpacing>0||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_SPACING"):invariant(!1)),tick>=TickMath.MIN_TICK&&tick<=TickMath.MAX_TICK||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_BOUND"):invariant(!1));var rounded=Math.round(tick/tickSpacing)*tickSpacing;return rounded<TickMath.MIN_TICK?rounded+tickSpacing:rounded>TickMath.MAX_TICK?rounded-tickSpacing:rounded}var Q128=JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(128)),PositionLibrary=function(){function PositionLibrary(){}return PositionLibrary.getTokensOwed=function(feeGrowthInside0LastX128,feeGrowthInside1LastX128,liquidity,feeGrowthInside0X128,feeGrowthInside1X128){return[JSBI.divide(JSBI.multiply(subIn256(feeGrowthInside0X128,feeGrowthInside0LastX128),liquidity),Q128),JSBI.divide(JSBI.multiply(subIn256(feeGrowthInside1X128,feeGrowthInside1LastX128),liquidity),Q128)]},PositionLibrary}();function tickToPrice(baseToken,quoteToken,tick){var sqrtRatioX96=TickMath.getSqrtRatioAtTick(tick),ratioX192=JSBI.multiply(sqrtRatioX96,sqrtRatioX96);return baseToken.sortsBefore(quoteToken)?new Price(baseToken,quoteToken,Q192,ratioX192):new Price(baseToken,quoteToken,ratioX192,Q192)}function priceToClosestTick(price){var sorted=price.baseCurrency.sortsBefore(price.quoteCurrency),sqrtRatioX96=sorted?encodeSqrtRatioX96(price.numerator,price.denominator):encodeSqrtRatioX96(price.denominator,price.numerator),tick=TickMath.getTickAtSqrtRatio(sqrtRatioX96),nextTickPrice=tickToPrice(price.baseCurrency,price.quoteCurrency,tick+1);return sorted?price.lessThan(nextTickPrice)||tick++:price.greaterThan(nextTickPrice)||tick++,tick}var Q256=JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(256));function subIn256(x,y){var difference=JSBI.subtract(x,y);return JSBI.lessThan(difference,ZERO)?JSBI.add(Q256,difference):difference}var TickLibrary=function(){function TickLibrary(){}return TickLibrary.getFeeGrowthInside=function(feeGrowthOutsideLower,feeGrowthOutsideUpper,tickLower,tickUpper,tickCurrent,feeGrowthGlobal0X128,feeGrowthGlobal1X128){var feeGrowthBelow0X128,feeGrowthBelow1X128,feeGrowthAbove0X128,feeGrowthAbove1X128;return tickCurrent>=tickLower?(feeGrowthBelow0X128=feeGrowthOutsideLower.feeGrowthOutside0X128,feeGrowthBelow1X128=feeGrowthOutsideLower.feeGrowthOutside1X128):(feeGrowthBelow0X128=subIn256(feeGrowthGlobal0X128,feeGrowthOutsideLower.feeGrowthOutside0X128),feeGrowthBelow1X128=subIn256(feeGrowthGlobal1X128,feeGrowthOutsideLower.feeGrowthOutside1X128)),tickCurrent<tickUpper?(feeGrowthAbove0X128=feeGrowthOutsideUpper.feeGrowthOutside0X128,feeGrowthAbove1X128=feeGrowthOutsideUpper.feeGrowthOutside1X128):(feeGrowthAbove0X128=subIn256(feeGrowthGlobal0X128,feeGrowthOutsideUpper.feeGrowthOutside0X128),feeGrowthAbove1X128=subIn256(feeGrowthGlobal1X128,feeGrowthOutsideUpper.feeGrowthOutside1X128)),[subIn256(subIn256(feeGrowthGlobal0X128,feeGrowthBelow0X128),feeGrowthAbove0X128),subIn256(subIn256(feeGrowthGlobal1X128,feeGrowthBelow1X128),feeGrowthAbove1X128)]},TickLibrary}(),Tick=function(_ref){var index=_ref.index,liquidityGross=_ref.liquidityGross,liquidityNet=_ref.liquidityNet;index>=TickMath.MIN_TICK&&index<=TickMath.MAX_TICK||("production"!==process.env.NODE_ENV?invariant(!1,"TICK"):invariant(!1)),this.index=index,this.liquidityGross=JSBI.BigInt(liquidityGross),this.liquidityNet=JSBI.BigInt(liquidityNet)},TickListDataProvider=function(){function TickListDataProvider(ticks,tickSpacing){var ticksMapped=ticks.map((function(t){return t instanceof Tick?t:new Tick(t)}));TickList.validateList(ticksMapped,tickSpacing),this.ticks=ticksMapped}var _proto=TickListDataProvider.prototype;return _proto.getTick=function(){var _getTick=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(tick){return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",TickList.getTick(this.ticks,tick));case 1:case"end":return _context.stop()}}),_callee,this)})));return function(_x){return _getTick.apply(this,arguments)}}(),_proto.nextInitializedTickWithinOneWord=function(){var _nextInitializedTickWithinOneWord=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(tick,lte,tickSpacing){return _regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",TickList.nextInitializedTickWithinOneWord(this.ticks,tick,lte,tickSpacing));case 1:case"end":return _context2.stop()}}),_callee2,this)})));return function(_x2,_x3,_x4){return _nextInitializedTickWithinOneWord.apply(this,arguments)}}(),TickListDataProvider}(),NO_TICK_DATA_PROVIDER_DEFAULT=new NoTickDataProvider,Pool=function(){function Pool(tokenA,tokenB,fee,sqrtRatioX96,liquidity,tickCurrent,ticks){void 0===ticks&&(ticks=NO_TICK_DATA_PROVIDER_DEFAULT),Number.isInteger(fee)&&fee<1e6||("production"!==process.env.NODE_ENV?invariant(!1,"FEE"):invariant(!1));var tickCurrentSqrtRatioX96=TickMath.getSqrtRatioAtTick(tickCurrent),nextTickSqrtRatioX96=TickMath.getSqrtRatioAtTick(tickCurrent+1);JSBI.greaterThanOrEqual(JSBI.BigInt(sqrtRatioX96),tickCurrentSqrtRatioX96)&&JSBI.lessThanOrEqual(JSBI.BigInt(sqrtRatioX96),nextTickSqrtRatioX96)||("production"!==process.env.NODE_ENV?invariant(!1,"PRICE_BOUNDS"):invariant(!1));var _ref=tokenA.sortsBefore(tokenB)?[tokenA,tokenB]:[tokenB,tokenA];this.token0=_ref[0],this.token1=_ref[1],this.fee=fee,this.sqrtRatioX96=JSBI.BigInt(sqrtRatioX96),this.liquidity=JSBI.BigInt(liquidity),this.tickCurrent=tickCurrent,this.tickDataProvider=Array.isArray(ticks)?new TickListDataProvider(ticks,TICK_SPACINGS[fee]):ticks}Pool.getAddress=function(tokenA,tokenB,fee,initCodeHashManualOverride,factoryAddressOverride){return computePoolAddress({factoryAddress:null!=factoryAddressOverride?factoryAddressOverride:FACTORY_ADDRESS,fee:fee,tokenA:tokenA,tokenB:tokenB,initCodeHashManualOverride:initCodeHashManualOverride})};var _proto=Pool.prototype;return _proto.involvesToken=function(token){return token.equals(this.token0)||token.equals(this.token1)},_proto.priceOf=function(token){return this.involvesToken(token)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),token.equals(this.token0)?this.token0Price:this.token1Price},_proto.getOutputAmount=function(){var _getOutputAmount=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(inputAmount,sqrtPriceLimitX96){var zeroForOne,_yield$this$swap,outputAmount,sqrtRatioX96,liquidity,tickCurrent,outputToken;return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return this.involvesToken(inputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),zeroForOne=inputAmount.currency.equals(this.token0),_context.next=4,this.swap(zeroForOne,inputAmount.quotient,sqrtPriceLimitX96);case 4:return _yield$this$swap=_context.sent,outputAmount=_yield$this$swap.amountCalculated,sqrtRatioX96=_yield$this$swap.sqrtRatioX96,liquidity=_yield$this$swap.liquidity,tickCurrent=_yield$this$swap.tickCurrent,outputToken=zeroForOne?this.token1:this.token0,_context.abrupt("return",[CurrencyAmount.fromRawAmount(outputToken,JSBI.multiply(outputAmount,NEGATIVE_ONE)),new Pool(this.token0,this.token1,this.fee,sqrtRatioX96,liquidity,tickCurrent,this.tickDataProvider)]);case 11:case"end":return _context.stop()}}),_callee,this)})));return function(_x,_x2){return _getOutputAmount.apply(this,arguments)}}(),_proto.getInputAmount=function(){var _getInputAmount=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(outputAmount,sqrtPriceLimitX96){var zeroForOne,_yield$this$swap2,inputAmount,sqrtRatioX96,liquidity,tickCurrent,inputToken;return _regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return outputAmount.currency.isToken&&this.involvesToken(outputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN"):invariant(!1)),zeroForOne=outputAmount.currency.equals(this.token1),_context2.next=4,this.swap(zeroForOne,JSBI.multiply(outputAmount.quotient,NEGATIVE_ONE),sqrtPriceLimitX96);case 4:return _yield$this$swap2=_context2.sent,inputAmount=_yield$this$swap2.amountCalculated,sqrtRatioX96=_yield$this$swap2.sqrtRatioX96,liquidity=_yield$this$swap2.liquidity,tickCurrent=_yield$this$swap2.tickCurrent,inputToken=zeroForOne?this.token0:this.token1,_context2.abrupt("return",[CurrencyAmount.fromRawAmount(inputToken,inputAmount),new Pool(this.token0,this.token1,this.fee,sqrtRatioX96,liquidity,tickCurrent,this.tickDataProvider)]);case 11:case"end":return _context2.stop()}}),_callee2,this)})));return function(_x3,_x4){return _getInputAmount.apply(this,arguments)}}(),_proto.swap=function(){var _swap=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(zeroForOne,amountSpecified,sqrtPriceLimitX96){return _regeneratorRuntime().wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",v3Swap(JSBI.BigInt(this.fee),this.sqrtRatioX96,this.tickCurrent,this.liquidity,this.tickSpacing,this.tickDataProvider,zeroForOne,amountSpecified,sqrtPriceLimitX96));case 1:case"end":return _context3.stop()}}),_callee3,this)})));return function(_x5,_x6,_x7){return _swap.apply(this,arguments)}}(),_createClass(Pool,[{key:"token0Price",get:function(){var _this$_token0Price;return null!=(_this$_token0Price=this._token0Price)?_this$_token0Price:this._token0Price=new Price(this.token0,this.token1,Q192,JSBI.multiply(this.sqrtRatioX96,this.sqrtRatioX96))}},{key:"token1Price",get:function(){var _this$_token1Price;return null!=(_this$_token1Price=this._token1Price)?_this$_token1Price:this._token1Price=new Price(this.token1,this.token0,JSBI.multiply(this.sqrtRatioX96,this.sqrtRatioX96),Q192)}},{key:"chainId",get:function(){return this.token0.chainId}},{key:"tickSpacing",get:function(){return TICK_SPACINGS[this.fee]}}]),Pool}(),Position=function(){function Position(_ref){var pool=_ref.pool,liquidity=_ref.liquidity,tickLower=_ref.tickLower,tickUpper=_ref.tickUpper;this._token0Amount=null,this._token1Amount=null,this._mintAmounts=null,tickLower<tickUpper||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_ORDER"):invariant(!1)),tickLower>=TickMath.MIN_TICK&&tickLower%pool.tickSpacing==0||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_LOWER"):invariant(!1)),tickUpper<=TickMath.MAX_TICK&&tickUpper%pool.tickSpacing==0||("production"!==process.env.NODE_ENV?invariant(!1,"TICK_UPPER"):invariant(!1)),this.pool=pool,this.tickLower=tickLower,this.tickUpper=tickUpper,this.liquidity=JSBI.BigInt(liquidity)}var _proto=Position.prototype;return _proto.ratiosAfterSlippage=function(slippageTolerance){var priceLower=this.pool.token0Price.asFraction.multiply(new Percent(1).subtract(slippageTolerance)),priceUpper=this.pool.token0Price.asFraction.multiply(slippageTolerance.add(1)),sqrtRatioX96Lower=encodeSqrtRatioX96(priceLower.numerator,priceLower.denominator);JSBI.lessThanOrEqual(sqrtRatioX96Lower,TickMath.MIN_SQRT_RATIO)&&(sqrtRatioX96Lower=JSBI.add(TickMath.MIN_SQRT_RATIO,JSBI.BigInt(1)));var sqrtRatioX96Upper=encodeSqrtRatioX96(priceUpper.numerator,priceUpper.denominator);return JSBI.greaterThanOrEqual(sqrtRatioX96Upper,TickMath.MAX_SQRT_RATIO)&&(sqrtRatioX96Upper=JSBI.subtract(TickMath.MAX_SQRT_RATIO,JSBI.BigInt(1))),{sqrtRatioX96Lower:sqrtRatioX96Lower,sqrtRatioX96Upper:sqrtRatioX96Upper}},_proto.mintAmountsWithSlippage=function(slippageTolerance){var _this$ratiosAfterSlip=this.ratiosAfterSlippage(slippageTolerance),sqrtRatioX96Upper=_this$ratiosAfterSlip.sqrtRatioX96Upper,sqrtRatioX96Lower=_this$ratiosAfterSlip.sqrtRatioX96Lower,poolLower=new Pool(this.pool.token0,this.pool.token1,this.pool.fee,sqrtRatioX96Lower,0,TickMath.getTickAtSqrtRatio(sqrtRatioX96Lower)),poolUpper=new Pool(this.pool.token0,this.pool.token1,this.pool.fee,sqrtRatioX96Upper,0,TickMath.getTickAtSqrtRatio(sqrtRatioX96Upper)),positionThatWillBeCreated=Position.fromAmounts(_extends({pool:this.pool,tickLower:this.tickLower,tickUpper:this.tickUpper},this.mintAmounts,{useFullPrecision:!1}));return{amount0:new Position({pool:poolUpper,liquidity:positionThatWillBeCreated.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount0,amount1:new Position({pool:poolLower,liquidity:positionThatWillBeCreated.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).mintAmounts.amount1}},_proto.burnAmountsWithSlippage=function(slippageTolerance){var _this$ratiosAfterSlip2=this.ratiosAfterSlippage(slippageTolerance),sqrtRatioX96Upper=_this$ratiosAfterSlip2.sqrtRatioX96Upper,sqrtRatioX96Lower=_this$ratiosAfterSlip2.sqrtRatioX96Lower,poolLower=new Pool(this.pool.token0,this.pool.token1,this.pool.fee,sqrtRatioX96Lower,0,TickMath.getTickAtSqrtRatio(sqrtRatioX96Lower)),amount0=new Position({pool:new Pool(this.pool.token0,this.pool.token1,this.pool.fee,sqrtRatioX96Upper,0,TickMath.getTickAtSqrtRatio(sqrtRatioX96Upper)),liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount0,amount1=new Position({pool:poolLower,liquidity:this.liquidity,tickLower:this.tickLower,tickUpper:this.tickUpper}).amount1;return{amount0:amount0.quotient,amount1:amount1.quotient}},Position.fromAmounts=function(_ref2){var pool=_ref2.pool,tickLower=_ref2.tickLower,tickUpper=_ref2.tickUpper,amount0=_ref2.amount0,amount1=_ref2.amount1,useFullPrecision=_ref2.useFullPrecision,sqrtRatioAX96=TickMath.getSqrtRatioAtTick(tickLower),sqrtRatioBX96=TickMath.getSqrtRatioAtTick(tickUpper);return new Position({pool:pool,tickLower:tickLower,tickUpper:tickUpper,liquidity:maxLiquidityForAmounts(pool.sqrtRatioX96,sqrtRatioAX96,sqrtRatioBX96,amount0,amount1,useFullPrecision)})},Position.fromAmount0=function(_ref3){var pool=_ref3.pool,tickLower=_ref3.tickLower,tickUpper=_ref3.tickUpper,amount0=_ref3.amount0,useFullPrecision=_ref3.useFullPrecision;return Position.fromAmounts({pool:pool,tickLower:tickLower,tickUpper:tickUpper,amount0:amount0,amount1:MaxUint256,useFullPrecision:useFullPrecision})},Position.fromAmount1=function(_ref4){var pool=_ref4.pool,tickLower=_ref4.tickLower,tickUpper=_ref4.tickUpper,amount1=_ref4.amount1;return Position.fromAmounts({pool:pool,tickLower:tickLower,tickUpper:tickUpper,amount0:MaxUint256,amount1:amount1,useFullPrecision:!0})},_createClass(Position,[{key:"token0PriceLower",get:function(){return tickToPrice(this.pool.token0,this.pool.token1,this.tickLower)}},{key:"token0PriceUpper",get:function(){return tickToPrice(this.pool.token0,this.pool.token1,this.tickUpper)}},{key:"amount0",get:function(){return null===this._token0Amount&&(this.pool.tickCurrent<this.tickLower?this._token0Amount=CurrencyAmount.fromRawAmount(this.pool.token0,SqrtPriceMath.getAmount0Delta(TickMath.getSqrtRatioAtTick(this.tickLower),TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1)):this.pool.tickCurrent<this.tickUpper?this._token0Amount=CurrencyAmount.fromRawAmount(this.pool.token0,SqrtPriceMath.getAmount0Delta(this.pool.sqrtRatioX96,TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1)):this._token0Amount=CurrencyAmount.fromRawAmount(this.pool.token0,ZERO)),this._token0Amount}},{key:"amount1",get:function(){return null===this._token1Amount&&(this.pool.tickCurrent<this.tickLower?this._token1Amount=CurrencyAmount.fromRawAmount(this.pool.token1,ZERO):this.pool.tickCurrent<this.tickUpper?this._token1Amount=CurrencyAmount.fromRawAmount(this.pool.token1,SqrtPriceMath.getAmount1Delta(TickMath.getSqrtRatioAtTick(this.tickLower),this.pool.sqrtRatioX96,this.liquidity,!1)):this._token1Amount=CurrencyAmount.fromRawAmount(this.pool.token1,SqrtPriceMath.getAmount1Delta(TickMath.getSqrtRatioAtTick(this.tickLower),TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!1))),this._token1Amount}},{key:"mintAmounts",get:function(){return null===this._mintAmounts?this.pool.tickCurrent<this.tickLower?{amount0:SqrtPriceMath.getAmount0Delta(TickMath.getSqrtRatioAtTick(this.tickLower),TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:ZERO}:this.pool.tickCurrent<this.tickUpper?{amount0:SqrtPriceMath.getAmount0Delta(this.pool.sqrtRatioX96,TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0),amount1:SqrtPriceMath.getAmount1Delta(TickMath.getSqrtRatioAtTick(this.tickLower),this.pool.sqrtRatioX96,this.liquidity,!0)}:{amount0:ZERO,amount1:SqrtPriceMath.getAmount1Delta(TickMath.getSqrtRatioAtTick(this.tickLower),TickMath.getSqrtRatioAtTick(this.tickUpper),this.liquidity,!0)}:this._mintAmounts}}]),Position}(),Route=function(){function Route(pools,input,output){this._midPrice=null,pools.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"POOLS"):invariant(!1));var chainId=pools[0].chainId,allOnSameChain=pools.every((function(pool){return pool.chainId===chainId}));allOnSameChain||("production"!==process.env.NODE_ENV?invariant(!1,"CHAIN_IDS"):invariant(!1));var wrappedInput=input.wrapped;pools[0].involvesToken(wrappedInput)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT"):invariant(!1)),pools[pools.length-1].involvesToken(output.wrapped)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT"):invariant(!1));for(var _step,tokenPath=[wrappedInput],_iterator=_createForOfIteratorHelperLoose(pools.entries());!(_step=_iterator()).done;){var _step$value=_step.value,i=_step$value[0],pool=_step$value[1],currentInputToken=tokenPath[i];currentInputToken.equals(pool.token0)||currentInputToken.equals(pool.token1)||("production"!==process.env.NODE_ENV?invariant(!1,"PATH"):invariant(!1));var nextToken=currentInputToken.equals(pool.token0)?pool.token1:pool.token0;tokenPath.push(nextToken)}this.pools=pools,this.tokenPath=tokenPath,this.input=input,this.output=null!=output?output:tokenPath[tokenPath.length-1]}return _createClass(Route,[{key:"chainId",get:function(){return this.pools[0].chainId}},{key:"midPrice",get:function(){if(null!==this._midPrice)return this._midPrice;var price=this.pools.slice(1).reduce((function(_ref,pool){var nextInput=_ref.nextInput,price=_ref.price;return nextInput.equals(pool.token0)?{nextInput:pool.token1,price:price.multiply(pool.token0Price)}:{nextInput:pool.token0,price:price.multiply(pool.token1Price)}}),this.pools[0].token0.equals(this.input.wrapped)?{nextInput:this.pools[0].token1,price:this.pools[0].token0Price}:{nextInput:this.pools[0].token0,price:this.pools[0].token1Price}).price;return this._midPrice=new Price(this.input,this.output,price.denominator,price.numerator)}}]),Route}();function tradeComparator(a,b){return a.inputAmount.currency.equals(b.inputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT_CURRENCY"):invariant(!1)),a.outputAmount.currency.equals(b.outputAmount.currency)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT_CURRENCY"):invariant(!1)),a.outputAmount.equalTo(b.outputAmount)?a.inputAmount.equalTo(b.inputAmount)?a.swaps.reduce((function(total,cur){return total+cur.route.tokenPath.length}),0)-b.swaps.reduce((function(total,cur){return total+cur.route.tokenPath.length}),0):a.inputAmount.lessThan(b.inputAmount)?-1:1:a.outputAmount.lessThan(b.outputAmount)?1:-1}var Trade=function(){function Trade(_ref){var routes=_ref.routes,tradeType=_ref.tradeType,inputCurrency=routes[0].inputAmount.currency,outputCurrency=routes[0].outputAmount.currency;routes.every((function(_ref2){var route=_ref2.route;return inputCurrency.wrapped.equals(route.input.wrapped)}))||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT_CURRENCY_MATCH"):invariant(!1)),routes.every((function(_ref3){var route=_ref3.route;return outputCurrency.wrapped.equals(route.output.wrapped)}))||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT_CURRENCY_MATCH"):invariant(!1));for(var _step,numPools=routes.map((function(_ref4){return _ref4.route.pools.length})).reduce((function(total,cur){return total+cur}),0),poolAddressSet=new Set,_iterator=_createForOfIteratorHelperLoose(routes);!(_step=_iterator()).done;)for(var _step2,_iterator2=_createForOfIteratorHelperLoose(_step.value.route.pools);!(_step2=_iterator2()).done;){var pool=_step2.value;poolAddressSet.add(Pool.getAddress(pool.token0,pool.token1,pool.fee))}numPools!==poolAddressSet.size&&("production"!==process.env.NODE_ENV?invariant(!1,"POOLS_DUPLICATED"):invariant(!1)),this.swaps=routes,this.tradeType=tradeType}Trade.exactIn=function(){var _exactIn=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(route,amountIn){return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Trade.fromRoute(route,amountIn,TradeType.EXACT_INPUT));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x,_x2){return _exactIn.apply(this,arguments)}}(),Trade.exactOut=function(){var _exactOut=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(route,amountOut){return _regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",Trade.fromRoute(route,amountOut,TradeType.EXACT_OUTPUT));case 1:case"end":return _context2.stop()}}),_callee2)})));return function(_x3,_x4){return _exactOut.apply(this,arguments)}}(),Trade.fromRoute=function(){var _fromRoute=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(route,amount,tradeType){var amounts,inputAmount,outputAmount,i,pool,_yield$pool$getOutput,_outputAmount,_i,_pool,_yield$_pool$getInput,_inputAmount;return _regeneratorRuntime().wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(amounts=new Array(route.tokenPath.length),tradeType!==TradeType.EXACT_INPUT){_context3.next=19;break}amount.currency.equals(route.input)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT"):invariant(!1)),amounts[0]=amount.wrapped,i=0;case 5:if(!(i<route.tokenPath.length-1)){_context3.next=15;break}return pool=route.pools[i],_context3.next=9,pool.getOutputAmount(amounts[i]);case 9:_yield$pool$getOutput=_context3.sent,_outputAmount=_yield$pool$getOutput[0],amounts[i+1]=_outputAmount;case 12:i++,_context3.next=5;break;case 15:inputAmount=CurrencyAmount.fromFractionalAmount(route.input,amount.numerator,amount.denominator),outputAmount=CurrencyAmount.fromFractionalAmount(route.output,amounts[amounts.length-1].numerator,amounts[amounts.length-1].denominator),_context3.next=34;break;case 19:amount.currency.equals(route.output)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT"):invariant(!1)),amounts[amounts.length-1]=amount.wrapped,_i=route.tokenPath.length-1;case 22:if(!(_i>0)){_context3.next=32;break}return _pool=route.pools[_i-1],_context3.next=26,_pool.getInputAmount(amounts[_i]);case 26:_yield$_pool$getInput=_context3.sent,_inputAmount=_yield$_pool$getInput[0],amounts[_i-1]=_inputAmount;case 29:_i--,_context3.next=22;break;case 32:inputAmount=CurrencyAmount.fromFractionalAmount(route.input,amounts[0].numerator,amounts[0].denominator),outputAmount=CurrencyAmount.fromFractionalAmount(route.output,amount.numerator,amount.denominator);case 34:return _context3.abrupt("return",new Trade({routes:[{inputAmount:inputAmount,outputAmount:outputAmount,route:route}],tradeType:tradeType}));case 35:case"end":return _context3.stop()}}),_callee3)})));return function(_x5,_x6,_x7){return _fromRoute.apply(this,arguments)}}(),Trade.fromRoutes=function(){var _fromRoutes=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(routes,tradeType){var populatedRoutes,_iterator3,_step3,_step3$value,route,amount,amounts,inputAmount,outputAmount,i,pool,_yield$pool$getOutput2,_outputAmount2,_i2,_pool2,_yield$_pool2$getInpu,_inputAmount2;return _regeneratorRuntime().wrap((function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:populatedRoutes=[],_iterator3=_createForOfIteratorHelperLoose(routes);case 2:if((_step3=_iterator3()).done){_context4.next=43;break}if(_step3$value=_step3.value,route=_step3$value.route,amount=_step3$value.amount,amounts=new Array(route.tokenPath.length),inputAmount=void 0,outputAmount=void 0,tradeType!==TradeType.EXACT_INPUT){_context4.next=25;break}amount.currency.equals(route.input)||("production"!==process.env.NODE_ENV?invariant(!1,"INPUT"):invariant(!1)),inputAmount=CurrencyAmount.fromFractionalAmount(route.input,amount.numerator,amount.denominator),amounts[0]=CurrencyAmount.fromFractionalAmount(route.input.wrapped,amount.numerator,amount.denominator),i=0;case 12:if(!(i<route.tokenPath.length-1)){_context4.next=22;break}return pool=route.pools[i],_context4.next=16,pool.getOutputAmount(amounts[i]);case 16:_yield$pool$getOutput2=_context4.sent,_outputAmount2=_yield$pool$getOutput2[0],amounts[i+1]=_outputAmount2;case 19:i++,_context4.next=12;break;case 22:outputAmount=CurrencyAmount.fromFractionalAmount(route.output,amounts[amounts.length-1].numerator,amounts[amounts.length-1].denominator),_context4.next=40;break;case 25:amount.currency.equals(route.output)||("production"!==process.env.NODE_ENV?invariant(!1,"OUTPUT"):invariant(!1)),outputAmount=CurrencyAmount.fromFractionalAmount(route.output,amount.numerator,amount.denominator),amounts[amounts.length-1]=CurrencyAmount.fromFractionalAmount(route.output.wrapped,amount.numerator,amount.denominator),_i2=route.tokenPath.length-1;case 29:if(!(_i2>0)){_context4.next=39;break}return _pool2=route.pools[_i2-1],_context4.next=33,_pool2.getInputAmount(amounts[_i2]);case 33:_yield$_pool2$getInpu=_context4.sent,_inputAmount2=_yield$_pool2$getInpu[0],amounts[_i2-1]=_inputAmount2;case 36:_i2--,_context4.next=29;break;case 39:inputAmount=CurrencyAmount.fromFractionalAmount(route.input,amounts[0].numerator,amounts[0].denominator);case 40:populatedRoutes.push({route:route,inputAmount:inputAmount,outputAmount:outputAmount});case 41:_context4.next=2;break;case 43:return _context4.abrupt("return",new Trade({routes:populatedRoutes,tradeType:tradeType}));case 44:case"end":return _context4.stop()}}),_callee4)})));return function(_x8,_x9){return _fromRoutes.apply(this,arguments)}}(),Trade.createUncheckedTrade=function(constructorArguments){return new Trade(_extends({},constructorArguments,{routes:[{inputAmount:constructorArguments.inputAmount,outputAmount:constructorArguments.outputAmount,route:constructorArguments.route}]}))},Trade.createUncheckedTradeWithMultipleRoutes=function(constructorArguments){return new Trade(constructorArguments)};var _proto=Trade.prototype;return _proto.minimumAmountOut=function(slippageTolerance,amountOut){if(void 0===amountOut&&(amountOut=this.outputAmount),slippageTolerance.lessThan(ZERO)&&("production"!==process.env.NODE_ENV?invariant(!1,"SLIPPAGE_TOLERANCE"):invariant(!1)),this.tradeType===TradeType.EXACT_OUTPUT)return amountOut;var slippageAdjustedAmountOut=new Fraction(ONE).add(slippageTolerance).invert().multiply(amountOut.quotient).quotient;return CurrencyAmount.fromRawAmount(amountOut.currency,slippageAdjustedAmountOut)},_proto.maximumAmountIn=function(slippageTolerance,amountIn){if(void 0===amountIn&&(amountIn=this.inputAmount),slippageTolerance.lessThan(ZERO)&&("production"!==process.env.NODE_ENV?invariant(!1,"SLIPPAGE_TOLERANCE"):invariant(!1)),this.tradeType===TradeType.EXACT_INPUT)return amountIn;var slippageAdjustedAmountIn=new Fraction(ONE).add(slippageTolerance).multiply(amountIn.quotient).quotient;return CurrencyAmount.fromRawAmount(amountIn.currency,slippageAdjustedAmountIn)},_proto.worstExecutionPrice=function(slippageTolerance){return new Price(this.inputAmount.currency,this.outputAmount.currency,this.maximumAmountIn(slippageTolerance).quotient,this.minimumAmountOut(slippageTolerance).quotient)},Trade.bestTradeExactIn=function(){var _bestTradeExactIn=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(pools,currencyAmountIn,currencyOut,_temp,currentPools,nextAmountIn,bestTrades){var _ref5,_ref5$maxNumResults,maxNumResults,_ref5$maxHops,maxHops,amountIn,tokenOut,i,pool,amountOut,_yield$pool$getOutput3,poolsExcludingThisPool;return _regeneratorRuntime().wrap((function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:_ref5$maxNumResults=(_ref5=void 0===_temp?{}:_temp).maxNumResults,maxNumResults=void 0===_ref5$maxNumResults?3:_ref5$maxNumResults,_ref5$maxHops=_ref5.maxHops,maxHops=void 0===_ref5$maxHops?3:_ref5$maxHops,void 0===currentPools&&(currentPools=[]),void 0===nextAmountIn&&(nextAmountIn=currencyAmountIn),void 0===bestTrades&&(bestTrades=[]),pools.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"POOLS"):invariant(!1)),maxHops>0||("production"!==process.env.NODE_ENV?invariant(!1,"MAX_HOPS"):invariant(!1)),currencyAmountIn===nextAmountIn||currentPools.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"INVALID_RECURSION"):invariant(!1)),amountIn=nextAmountIn.wrapped,tokenOut=currencyOut.wrapped,i=0;case 10:if(!(i<pools.length)){_context5.next=46;break}if((pool=pools[i]).token0.equals(amountIn.currency)||pool.token1.equals(amountIn.currency)){_context5.next=14;break}return _context5.abrupt("continue",43);case 14:return amountOut=void 0,_context5.prev=15,_context5.next=19,pool.getOutputAmount(amountIn);case 19:_yield$pool$getOutput3=_context5.sent,amountOut=_yield$pool$getOutput3[0],_context5.next=28;break;case 23:if(_context5.prev=23,_context5.t0=_context5.catch(15),!_context5.t0.isInsufficientInputAmountError){_context5.next=27;break}return _context5.abrupt("continue",43);case 27:throw _context5.t0;case 28:if(!amountOut.currency.isToken||!amountOut.currency.equals(tokenOut)){_context5.next=39;break}return _context5.t1=sortedInsert,_context5.t2=bestTrades,_context5.next=33,Trade.fromRoute(new Route([].concat(currentPools,[pool]),currencyAmountIn.currency,currencyOut),currencyAmountIn,TradeType.EXACT_INPUT);case 33:_context5.t3=_context5.sent,_context5.t4=maxNumResults,_context5.t5=tradeComparator,(0,_context5.t1)(_context5.t2,_context5.t3,_context5.t4,_context5.t5),_context5.next=43;break;case 39:if(!(maxHops>1&&pools.length>1)){_context5.next=43;break}return poolsExcludingThisPool=pools.slice(0,i).concat(pools.slice(i+1,pools.length)),_context5.next=43,Trade.bestTradeExactIn(poolsExcludingThisPool,currencyAmountIn,currencyOut,{maxNumResults:maxNumResults,maxHops:maxHops-1},[].concat(currentPools,[pool]),amountOut,bestTrades);case 43:i++,_context5.next=10;break;case 46:return _context5.abrupt("return",bestTrades);case 47:case"end":return _context5.stop()}}),_callee5,null,[[15,23]])})));return function(_x10,_x11,_x12,_x13,_x14,_x15,_x16){return _bestTradeExactIn.apply(this,arguments)}}(),Trade.bestTradeExactOut=function(){var _bestTradeExactOut=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(pools,currencyIn,currencyAmountOut,_temp2,currentPools,nextAmountOut,bestTrades){var _ref6,_ref6$maxNumResults,maxNumResults,_ref6$maxHops,maxHops,amountOut,tokenIn,i,pool,amountIn,_yield$pool$getInputA,poolsExcludingThisPool;return _regeneratorRuntime().wrap((function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:_ref6$maxNumResults=(_ref6=void 0===_temp2?{}:_temp2).maxNumResults,maxNumResults=void 0===_ref6$maxNumResults?3:_ref6$maxNumResults,_ref6$maxHops=_ref6.maxHops,maxHops=void 0===_ref6$maxHops?3:_ref6$maxHops,void 0===currentPools&&(currentPools=[]),void 0===nextAmountOut&&(nextAmountOut=currencyAmountOut),void 0===bestTrades&&(bestTrades=[]),pools.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"POOLS"):invariant(!1)),maxHops>0||("production"!==process.env.NODE_ENV?invariant(!1,"MAX_HOPS"):invariant(!1)),currencyAmountOut===nextAmountOut||currentPools.length>0||("production"!==process.env.NODE_ENV?invariant(!1,"INVALID_RECURSION"):invariant(!1)),amountOut=nextAmountOut.wrapped,tokenIn=currencyIn.wrapped,i=0;case 10:if(!(i<pools.length)){_context6.next=46;break}if((pool=pools[i]).token0.equals(amountOut.currency)||pool.token1.equals(amountOut.currency)){_context6.next=14;break}return _context6.abrupt("continue",43);case 14:return amountIn=void 0,_context6.prev=15,_context6.next=19,pool.getInputAmount(amountOut);case 19:_yield$pool$getInputA=_context6.sent,amountIn=_yield$pool$getInputA[0],_context6.next=28;break;case 23:if(_context6.prev=23,_context6.t0=_context6.catch(15),!_context6.t0.isInsufficientReservesError){_context6.next=27;break}return _context6.abrupt("continue",43);case 27:throw _context6.t0;case 28:if(!amountIn.currency.equals(tokenIn)){_context6.next=39;break}return _context6.t1=sortedInsert,_context6.t2=bestTrades,_context6.next=33,Trade.fromRoute(new Route([pool].concat(currentPools),currencyIn,currencyAmountOut.currency),currencyAmountOut,TradeType.EXACT_OUTPUT);case 33:_context6.t3=_context6.sent,_context6.t4=maxNumResults,_context6.t5=tradeComparator,(0,_context6.t1)(_context6.t2,_context6.t3,_context6.t4,_context6.t5),_context6.next=43;break;case 39:if(!(maxHops>1&&pools.length>1)){_context6.next=43;break}return poolsExcludingThisPool=pools.slice(0,i).concat(pools.slice(i+1,pools.length)),_context6.next=43,Trade.bestTradeExactOut(poolsExcludingThisPool,currencyIn,currencyAmountOut,{maxNumResults:maxNumResults,maxHops:maxHops-1},[pool].concat(currentPools),amountIn,bestTrades);case 43:i++,_context6.next=10;break;case 46:return _context6.abrupt("return",bestTrades);case 47:case"end":return _context6.stop()}}),_callee6,null,[[15,23]])})));return function(_x17,_x18,_x19,_x20,_x21,_x22,_x23){return _bestTradeExactOut.apply(this,arguments)}}(),_createClass(Trade,[{key:"route",get:function(){return 1!==this.swaps.length&&("production"!==process.env.NODE_ENV?invariant(!1,"MULTIPLE_ROUTES"):invariant(!1)),this.swaps[0].route}},{key:"inputAmount",get:function(){if(this._inputAmount)return this._inputAmount;var inputCurrency=this.swaps[0].inputAmount.currency,totalInputFromRoutes=this.swaps.map((function(_ref7){return _ref7.inputAmount})).reduce((function(total,cur){return total.add(cur)}),CurrencyAmount.fromRawAmount(inputCurrency,0));return this._inputAmount=totalInputFromRoutes,this._inputAmount}},{key:"outputAmount",get:function(){if(this._outputAmount)return this._outputAmount;var outputCurrency=this.swaps[0].outputAmount.currency,totalOutputFromRoutes=this.swaps.map((function(_ref8){return _ref8.outputAmount})).reduce((function(total,cur){return total.add(cur)}),CurrencyAmount.fromRawAmount(outputCurrency,0));return this._outputAmount=totalOutputFromRoutes,this._outputAmount}},{key:"executionPrice",get:function(){var _this$_executionPrice;return null!=(_this$_executionPrice=this._executionPrice)?_this$_executionPrice:this._executionPrice=new Price(this.inputAmount.currency,this.outputAmount.currency,this.inputAmount.quotient,this.outputAmount.quotient)}},{key:"priceImpact",get:function(){if(this._priceImpact)return this._priceImpact;for(var _step4,spotOutputAmount=CurrencyAmount.fromRawAmount(this.outputAmount.currency,0),_iterator4=_createForOfIteratorHelperLoose(this.swaps);!(_step4=_iterator4()).done;){var _step4$value=_step4.value,route=_step4$value.route,inputAmount=_step4$value.inputAmount,midPrice=route.midPrice;spotOutputAmount=spotOutputAmount.add(midPrice.quote(inputAmount))}var priceImpact=spotOutputAmount.subtract(this.outputAmount).divide(spotOutputAmount);return this._priceImpact=new Percent(priceImpact.numerator,priceImpact.denominator),this._priceImpact}}]),Trade}(),Multicall=function(){function Multicall(){}return Multicall.encodeMulticall=function(calldatas){return Array.isArray(calldatas)||(calldatas=[calldatas]),1===calldatas.length?calldatas[0]:Multicall.INTERFACE.encodeFunctionData("multicall",[calldatas])},Multicall}();function isAllowedPermit(permitOptions){return"nonce"in permitOptions}Multicall.INTERFACE=new Interface(IMulticall.abi);var SelfPermit=function(){function SelfPermit(){}return SelfPermit.encodePermit=function(token,options){return isAllowedPermit(options)?SelfPermit.INTERFACE.encodeFunctionData("selfPermitAllowed",[token.address,toHex(options.nonce),toHex(options.expiry),options.v,options.r,options.s]):SelfPermit.INTERFACE.encodeFunctionData("selfPermit",[token.address,toHex(options.amount),toHex(options.deadline),options.v,options.r,options.s])},SelfPermit}();SelfPermit.INTERFACE=new Interface(ISelfPermit.abi);var Payments=function(){function Payments(){}return Payments.encodeFeeBips=function(fee){return toHex(fee.multiply(1e4).quotient)},Payments.encodeUnwrapWETH9=function(amountMinimum,recipient,feeOptions){if(recipient=validateAndParseAddress(recipient),feeOptions){var feeBips=this.encodeFeeBips(feeOptions.fee),feeRecipient=validateAndParseAddress(feeOptions.recipient);return Payments.INTERFACE.encodeFunctionData("unwrapWETH9WithFee",[toHex(amountMinimum),recipient,feeBips,feeRecipient])}return Payments.INTERFACE.encodeFunctionData("unwrapWETH9",[toHex(amountMinimum),recipient])},Payments.encodeSweepToken=function(token,amountMinimum,recipient,feeOptions){if(recipient=validateAndParseAddress(recipient),feeOptions){var feeBips=this.encodeFeeBips(feeOptions.fee),feeRecipient=validateAndParseAddress(feeOptions.recipient);return Payments.INTERFACE.encodeFunctionData("sweepTokenWithFee",[token.address,toHex(amountMinimum),recipient,feeBips,feeRecipient])}return Payments.INTERFACE.encodeFunctionData("sweepToken",[token.address,toHex(amountMinimum),recipient])},Payments.encodeRefundETH=function(){return Payments.INTERFACE.encodeFunctionData("refundETH")},Payments}();Payments.INTERFACE=new Interface(IPeripheryPaymentsWithFee.abi);var _excluded=["expectedCurrencyOwed0","expectedCurrencyOwed1"],MaxUint128=toHex(JSBI.subtract(JSBI.exponentiate(JSBI.BigInt(2),JSBI.BigInt(128)),JSBI.BigInt(1)));function isMint(options){return Object.keys(options).some((function(k){return"recipient"===k}))}var NonfungiblePositionManager=function(){function NonfungiblePositionManager(){}return NonfungiblePositionManager.encodeCreate=function(pool){return NonfungiblePositionManager.INTERFACE.encodeFunctionData("createAndInitializePoolIfNecessary",[pool.token0.address,pool.token1.address,pool.fee,toHex(pool.sqrtRatioX96)])},NonfungiblePositionManager.createCallParameters=function(pool){return{calldata:this.encodeCreate(pool),value:toHex(0)}},NonfungiblePositionManager.addCallParameters=function(position,options){JSBI.greaterThan(position.liquidity,ZERO)||("production"!==process.env.NODE_ENV?invariant(!1,"ZERO_LIQUIDITY"):invariant(!1));var calldatas=[],_position$mintAmounts=position.mintAmounts,amount0Desired=_position$mintAmounts.amount0,amount1Desired=_position$mintAmounts.amount1,minimumAmounts=position.mintAmountsWithSlippage(options.slippageTolerance),amount0Min=toHex(minimumAmounts.amount0),amount1Min=toHex(minimumAmounts.amount1),deadline=toHex(options.deadline);if(isMint(options)&&options.createPool&&calldatas.push(this.encodeCreate(position.pool)),options.token0Permit&&calldatas.push(SelfPermit.encodePermit(position.pool.token0,options.token0Permit)),options.token1Permit&&calldatas.push(SelfPermit.encodePermit(position.pool.token1,options.token1Permit)),isMint(options)){var recipient=validateAndParseAddress(options.recipient);calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("mint",[{token0:position.pool.token0.address,token1:position.pool.token1.address,fee:position.pool.fee,tickLower:position.tickLower,tickUpper:position.tickUpper,amount0Desired:toHex(amount0Desired),amount1Desired:toHex(amount1Desired),amount0Min:amount0Min,amount1Min:amount1Min,recipient:recipient,deadline:deadline}]))}else calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("increaseLiquidity",[{tokenId:toHex(options.tokenId),amount0Desired:toHex(amount0Desired),amount1Desired:toHex(amount1Desired),amount0Min:amount0Min,amount1Min:amount1Min,deadline:deadline}]));var value=toHex(0);if(options.useNative){var wrapped=options.useNative.wrapped;position.pool.token0.equals(wrapped)||position.pool.token1.equals(wrapped)||("production"!==process.env.NODE_ENV?invariant(!1,"NO_WETH"):invariant(!1));var wrappedValue=position.pool.token0.equals(wrapped)?amount0Desired:amount1Desired;JSBI.greaterThan(wrappedValue,ZERO)&&calldatas.push(Payments.encodeRefundETH()),value=toHex(wrappedValue)}return{calldata:Multicall.encodeMulticall(calldatas),value:value}},NonfungiblePositionManager.encodeCollect=function(options){var calldatas=[],tokenId=toHex(options.tokenId),involvesETH=options.expectedCurrencyOwed0.currency.isNative||options.expectedCurrencyOwed1.currency.isNative,recipient=validateAndParseAddress(options.recipient);if(calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("collect",[{tokenId:tokenId,recipient:involvesETH?ADDRESS_ZERO:recipient,amount0Max:MaxUint128,amount1Max:MaxUint128}])),involvesETH){var ethAmount=options.expectedCurrencyOwed0.currency.isNative?options.expectedCurrencyOwed0.quotient:options.expectedCurrencyOwed1.quotient,token=options.expectedCurrencyOwed0.currency.isNative?options.expectedCurrencyOwed1.currency:options.expectedCurrencyOwed0.currency,tokenAmount=options.expectedCurrencyOwed0.currency.isNative?options.expectedCurrencyOwed1.quotient:options.expectedCurrencyOwed0.quotient;calldatas.push(Payments.encodeUnwrapWETH9(ethAmount,recipient)),calldatas.push(Payments.encodeSweepToken(token,tokenAmount,recipient))}return calldatas},NonfungiblePositionManager.collectCallParameters=function(options){var calldatas=NonfungiblePositionManager.encodeCollect(options);return{calldata:Multicall.encodeMulticall(calldatas),value:toHex(0)}},NonfungiblePositionManager.removeCallParameters=function(position,options){var calldatas=[],deadline=toHex(options.deadline),tokenId=toHex(options.tokenId),partialPosition=new Position({pool:position.pool,liquidity:options.liquidityPercentage.multiply(position.liquidity).quotient,tickLower:position.tickLower,tickUpper:position.tickUpper});JSBI.greaterThan(partialPosition.liquidity,ZERO)||("production"!==process.env.NODE_ENV?invariant(!1,"ZERO_LIQUIDITY"):invariant(!1));var _partialPosition$burn=partialPosition.burnAmountsWithSlippage(options.slippageTolerance),amount0Min=_partialPosition$burn.amount0,amount1Min=_partialPosition$burn.amount1;options.permit&&calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("permit",[validateAndParseAddress(options.permit.spender),tokenId,toHex(options.permit.deadline),options.permit.v,options.permit.r,options.permit.s])),calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("decreaseLiquidity",[{tokenId:tokenId,liquidity:toHex(partialPosition.liquidity),amount0Min:toHex(amount0Min),amount1Min:toHex(amount1Min),deadline:deadline}]));var _options$collectOptio=options.collectOptions,expectedCurrencyOwed0=_options$collectOptio.expectedCurrencyOwed0,expectedCurrencyOwed1=_options$collectOptio.expectedCurrencyOwed1,rest=_objectWithoutPropertiesLoose(_options$collectOptio,_excluded);return calldatas.push.apply(calldatas,NonfungiblePositionManager.encodeCollect(_extends({tokenId:toHex(options.tokenId),expectedCurrencyOwed0:expectedCurrencyOwed0.add(CurrencyAmount.fromRawAmount(expectedCurrencyOwed0.currency,amount0Min)),expectedCurrencyOwed1:expectedCurrencyOwed1.add(CurrencyAmount.fromRawAmount(expectedCurrencyOwed1.currency,amount1Min))},rest))),options.liquidityPercentage.equalTo(ONE)?options.burnToken&&calldatas.push(NonfungiblePositionManager.INTERFACE.encodeFunctionData("burn",[tokenId])):!0===options.burnToken&&("production"!==process.env.NODE_ENV?invariant(!1,"CANNOT_BURN"):invariant(!1)),{calldata:Multicall.encodeMulticall(calldatas),value:toHex(0)}},NonfungiblePositionManager.safeTransferFromParameters=function(options){var recipient=validateAndParseAddress(options.recipient),sender=validateAndParseAddress(options.sender);return{calldata:options.data?NonfungiblePositionManager.INTERFACE.encodeFunctionData("safeTransferFrom(address,address,uint256,bytes)",[sender,recipient,toHex(options.tokenId),options.data]):NonfungiblePositionManager.INTERFACE.encodeFunctionData("safeTransferFrom(address,address,uint256)",[sender,recipient,toHex(options.tokenId)]),value:toHex(0)}},NonfungiblePositionManager}();NonfungiblePositionManager.INTERFACE=new Interface(INonfungiblePositionManager.abi);var SwapQuoter=function(){function SwapQuoter(){}return SwapQuoter.quoteCallParameters=function(route,amount,tradeType,options){void 0===options&&(options={});var calldata,singleHop=1===route.pools.length,quoteAmount=toHex(amount.quotient),swapInterface=options.useQuoterV2?this.V2INTERFACE:this.V1INTERFACE;if(singleHop){var _options$sqrtPriceLim,_options,baseQuoteParams={tokenIn:route.tokenPath[0].address,tokenOut:route.tokenPath[1].address,fee:route.pools[0].fee,sqrtPriceLimitX96:toHex(null!=(_options$sqrtPriceLim=null==(_options=options)?void 0:_options.sqrtPriceLimitX96)?_options$sqrtPriceLim:0)},v2QuoteParams=_extends({},baseQuoteParams,tradeType===TradeType.EXACT_INPUT?{amountIn:quoteAmount}:{amount:quoteAmount}),v1QuoteParams=[baseQuoteParams.tokenIn,baseQuoteParams.tokenOut,baseQuoteParams.fee,quoteAmount,baseQuoteParams.sqrtPriceLimitX96],tradeTypeFunctionName=tradeType===TradeType.EXACT_INPUT?"quoteExactInputSingle":"quoteExactOutputSingle";calldata=swapInterface.encodeFunctionData(tradeTypeFunctionName,options.useQuoterV2?[v2QuoteParams]:v1QuoteParams)}else{var _options2;void 0!==(null==(_options2=options)?void 0:_options2.sqrtPriceLimitX96)&&("production"!==process.env.NODE_ENV?invariant(!1,"MULTIHOP_PRICE_LIMIT"):invariant(!1));var path=encodeRouteToPath(route,tradeType===TradeType.EXACT_OUTPUT),_tradeTypeFunctionName=tradeType===TradeType.EXACT_INPUT?"quoteExactInput":"quoteExactOutput";calldata=swapInterface.encodeFunctionData(_tradeTypeFunctionName,[path,quoteAmount])}return{calldata:calldata,value:toHex(0)}},SwapQuoter}();SwapQuoter.V1INTERFACE=new Interface(IQuoter.abi),SwapQuoter.V2INTERFACE=new Interface(IQuoterV2.abi);var Staker=function(){function Staker(){}return Staker.encodeClaim=function(incentiveKey,options){var _options$amount,calldatas=[];calldatas.push(Staker.INTERFACE.encodeFunctionData("unstakeToken",[this._encodeIncentiveKey(incentiveKey),toHex(options.tokenId)]));var recipient=validateAndParseAddress(options.recipient),amount=null!=(_options$amount=options.amount)?_options$amount:0;return calldatas.push(Staker.INTERFACE.encodeFunctionData("claimReward",[incentiveKey.rewardToken.address,recipient,toHex(amount)])),calldatas},Staker.collectRewards=function(incentiveKeys,options){incentiveKeys=Array.isArray(incentiveKeys)?incentiveKeys:[incentiveKeys];for(var calldatas=[],i=0;i<incentiveKeys.length;i++){var incentiveKey=incentiveKeys[i];(calldatas=calldatas.concat(this.encodeClaim(incentiveKey,options))).push(Staker.INTERFACE.encodeFunctionData("stakeToken",[this._encodeIncentiveKey(incentiveKey),toHex(options.tokenId)]))}return{calldata:Multicall.encodeMulticall(calldatas),value:toHex(0)}},Staker.withdrawToken=function(incentiveKeys,withdrawOptions){var calldatas=[];incentiveKeys=Array.isArray(incentiveKeys)?incentiveKeys:[incentiveKeys];for(var claimOptions={tokenId:withdrawOptions.tokenId,recipient:withdrawOptions.recipient,amount:withdrawOptions.amount},i=0;i<incentiveKeys.length;i++){var incentiveKey=incentiveKeys[i];calldatas=calldatas.concat(this.encodeClaim(incentiveKey,claimOptions))}var owner=validateAndParseAddress(withdrawOptions.owner);return calldatas.push(Staker.INTERFACE.encodeFunctionData("withdrawToken",[toHex(withdrawOptions.tokenId),owner,withdrawOptions.data?withdrawOptions.data:toHex(0)])),{calldata:Multicall.encodeMulticall(calldatas),value:toHex(0)}},Staker.encodeDeposit=function(incentiveKeys){var data;if((incentiveKeys=Array.isArray(incentiveKeys)?incentiveKeys:[incentiveKeys]).length>1){for(var keys=[],i=0;i<incentiveKeys.length;i++){var incentiveKey=incentiveKeys[i];keys.push(this._encodeIncentiveKey(incentiveKey))}data=defaultAbiCoder.encode([Staker.INCENTIVE_KEY_ABI+"[]"],[keys])}else data=defaultAbiCoder.encode([Staker.INCENTIVE_KEY_ABI],[this._encodeIncentiveKey(incentiveKeys[0])]);return data},Staker._encodeIncentiveKey=function(incentiveKey){var _incentiveKey$pool=incentiveKey.pool,token0=_incentiveKey$pool.token0,token1=_incentiveKey$pool.token1,fee=_incentiveKey$pool.fee,refundee=validateAndParseAddress(incentiveKey.refundee);return{rewardToken:incentiveKey.rewardToken.address,pool:Pool.getAddress(token0,token1,fee),startTime:toHex(incentiveKey.startTime),endTime:toHex(incentiveKey.endTime),refundee:refundee}},Staker}();Staker.INTERFACE=new Interface(IUniswapV3Staker.abi),Staker.INCENTIVE_KEY_ABI="tuple(address rewardToken, address pool, uint256 startTime, uint256 endTime, address refundee)";var SwapRouter=function(){function SwapRouter(){}return SwapRouter.swapCallParameters=function(trades,options){Array.isArray(trades)||(trades=[trades]);var sampleTrade=trades[0],tokenIn=sampleTrade.inputAmount.currency.wrapped,tokenOut=sampleTrade.outputAmount.currency.wrapped;trades.every((function(trade){return trade.inputAmount.currency.wrapped.equals(tokenIn)}))||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN_IN_DIFF"):invariant(!1)),trades.every((function(trade){return trade.outputAmount.currency.wrapped.equals(tokenOut)}))||("production"!==process.env.NODE_ENV?invariant(!1,"TOKEN_OUT_DIFF"):invariant(!1));var calldatas=[],ZERO_IN=CurrencyAmount.fromRawAmount(trades[0].inputAmount.currency,0),ZERO_OUT=CurrencyAmount.fromRawAmount(trades[0].outputAmount.currency,0),totalAmountOut=trades.reduce((function(sum,trade){return sum.add(trade.minimumAmountOut(options.slippageTolerance))}),ZERO_OUT),mustRefund=sampleTrade.inputAmount.currency.isNative&&sampleTrade.tradeType===TradeType.EXACT_OUTPUT,inputIsNative=sampleTrade.inputAmount.currency.isNative,outputIsNative=sampleTrade.outputAmount.currency.isNative,routerMustCustody=outputIsNative||!!options.fee,totalValue=inputIsNative?trades.reduce((function(sum,trade){return sum.add(trade.maximumAmountIn(options.slippageTolerance))}),ZERO_IN):ZERO_IN;options.inputTokenPermit&&(sampleTrade.inputAmount.currency.isToken||("production"!==process.env.NODE_ENV?invariant(!1,"NON_TOKEN_PERMIT"):invariant(!1)),calldatas.push(SelfPermit.encodePermit(sampleTrade.inputAmount.currency,options.inputTokenPermit)));for(var _step,recipient=validateAndParseAddress(options.recipient),deadline=toHex(options.deadline),_iterator=_createForOfIteratorHelperLoose(trades);!(_step=_iterator()).done;)for(var _step2,trade=_step.value,_iterator2=_createForOfIteratorHelperLoose(trade.swaps);!(_step2=_iterator2()).done;){var _step2$value=_step2.value,route=_step2$value.route,inputAmount=_step2$value.inputAmount,outputAmount=_step2$value.outputAmount,amountIn=toHex(trade.maximumAmountIn(options.slippageTolerance,inputAmount).quotient),amountOut=toHex(trade.minimumAmountOut(options.slippageTolerance,outputAmount).quotient);if(1===route.pools.length)if(trade.tradeType===TradeType.EXACT_INPUT){var _options$sqrtPriceLim,exactInputSingleParams={tokenIn:route.tokenPath[0].address,tokenOut:route.tokenPath[1].address,fee:route.pools[0].fee,recipient:routerMustCustody?ADDRESS_ZERO:recipient,deadline:deadline,amountIn:amountIn,amountOutMinimum:amountOut,sqrtPriceLimitX96:toHex(null!=(_options$sqrtPriceLim=options.sqrtPriceLimitX96)?_options$sqrtPriceLim:0)};calldatas.push(SwapRouter.INTERFACE.encodeFunctionData("exactInputSingle",[exactInputSingleParams]))}else{var _options$sqrtPriceLim2,exactOutputSingleParams={tokenIn:route.tokenPath[0].address,tokenOut:route.tokenPath[1].address,fee:route.pools[0].fee,recipient:routerMustCustody?ADDRESS_ZERO:recipient,deadline:deadline,amountOut:amountOut,amountInMaximum:amountIn,sqrtPriceLimitX96:toHex(null!=(_options$sqrtPriceLim2=options.sqrtPriceLimitX96)?_options$sqrtPriceLim2:0)};calldatas.push(SwapRouter.INTERFACE.encodeFunctionData("exactOutputSingle",[exactOutputSingleParams]))}else{void 0!==options.sqrtPriceLimitX96&&("production"!==process.env.NODE_ENV?invariant(!1,"MULTIHOP_PRICE_LIMIT"):invariant(!1));var path=encodeRouteToPath(route,trade.tradeType===TradeType.EXACT_OUTPUT);if(trade.tradeType===TradeType.EXACT_INPUT){var exactInputParams={path:path,recipient:routerMustCustody?ADDRESS_ZERO:recipient,deadline:deadline,amountIn:amountIn,amountOutMinimum:amountOut};calldatas.push(SwapRouter.INTERFACE.encodeFunctionData("exactInput",[exactInputParams]))}else{var exactOutputParams={path:path,recipient:routerMustCustody?ADDRESS_ZERO:recipient,deadline:deadline,amountOut:amountOut,amountInMaximum:amountIn};calldatas.push(SwapRouter.INTERFACE.encodeFunctionData("exactOutput",[exactOutputParams]))}}}return routerMustCustody&&(options.fee?outputIsNative?calldatas.push(Payments.encodeUnwrapWETH9(totalAmountOut.quotient,recipient,options.fee)):calldatas.push(Payments.encodeSweepToken(sampleTrade.outputAmount.currency.wrapped,totalAmountOut.quotient,recipient,options.fee)):calldatas.push(Payments.encodeUnwrapWETH9(totalAmountOut.quotient,recipient))),mustRefund&&calldatas.push(Payments.encodeRefundETH()),{calldata:Multicall.encodeMulticall(calldatas),value:toHex(totalValue.quotient)}},SwapRouter}();SwapRouter.INTERFACE=new Interface(ISwapRouter.abi);export{ADDRESS_ZERO,FACTORY_ADDRESS,FeeAmount,FullMath,LiquidityMath,Multicall,NoTickDataProvider,NonfungiblePositionManager,POOL_INIT_CODE_HASH,Payments,Pool,Position,PositionLibrary,Route,SelfPermit,SqrtPriceMath,Staker,SwapMath,SwapQuoter,SwapRouter,TICK_SPACINGS,Tick,TickLibrary,TickList,TickListDataProvider,TickMath,Trade,computePoolAddress,encodeRouteToPath,encodeSqrtRatioX96,isSorted,maxLiquidityForAmounts,mostSignificantBit,nearestUsableTick,poolInitCodeHash,priceToClosestTick,subIn256,tickToPrice,toHex,tradeComparator,v3Swap};