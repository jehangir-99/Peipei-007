import{AbiDecodingZeroDataError}from"../../errors/abi.js";import{BaseError}from"../../errors/base.js";import{ContractFunctionExecutionError,ContractFunctionRevertedError,ContractFunctionZeroDataError,RawContractError}from"../../errors/contract.js";import{InternalRpcError}from"../../errors/rpc.js";const EXECUTION_REVERTED_ERROR_CODE=3;export function getContractError(err,{abi:abi,address:address,args:args,docsPath:docsPath,functionName:functionName,sender:sender}){const{code:code,data:data,message:message,shortMessage:shortMessage}=err instanceof RawContractError?err:err instanceof BaseError?err.walk((err=>"data"in err))||err.walk():{},cause=err instanceof AbiDecodingZeroDataError?new ContractFunctionZeroDataError({functionName:functionName}):[EXECUTION_REVERTED_ERROR_CODE,InternalRpcError.code].includes(code)&&(data||message||shortMessage)?new ContractFunctionRevertedError({abi:abi,data:"object"==typeof data?data.data:data,functionName:functionName,message:shortMessage??message}):err;return new ContractFunctionExecutionError(cause,{abi:abi,args:args,contractAddress:address,docsPath:docsPath,functionName:functionName,sender:sender})}