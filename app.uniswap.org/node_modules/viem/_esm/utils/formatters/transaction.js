import{hexToNumber}from"../encoding/fromHex.js";import{defineFormatter}from"./formatter.js";export const transactionType={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844"};export function formatTransaction(transaction){const transaction_={...transaction,blockHash:transaction.blockHash?transaction.blockHash:null,blockNumber:transaction.blockNumber?BigInt(transaction.blockNumber):null,chainId:transaction.chainId?hexToNumber(transaction.chainId):void 0,gas:transaction.gas?BigInt(transaction.gas):void 0,gasPrice:transaction.gasPrice?BigInt(transaction.gasPrice):void 0,maxFeePerBlobGas:transaction.maxFeePerBlobGas?BigInt(transaction.maxFeePerBlobGas):void 0,maxFeePerGas:transaction.maxFeePerGas?BigInt(transaction.maxFeePerGas):void 0,maxPriorityFeePerGas:transaction.maxPriorityFeePerGas?BigInt(transaction.maxPriorityFeePerGas):void 0,nonce:transaction.nonce?hexToNumber(transaction.nonce):void 0,to:transaction.to?transaction.to:null,transactionIndex:transaction.transactionIndex?Number(transaction.transactionIndex):null,type:transaction.type?transactionType[transaction.type]:void 0,typeHex:transaction.type?transaction.type:void 0,value:transaction.value?BigInt(transaction.value):void 0,v:transaction.v?BigInt(transaction.v):void 0};return transaction_.yParity=(()=>{if(transaction.yParity)return Number(transaction.yParity);if("bigint"==typeof transaction_.v){if(0n===transaction_.v||27n===transaction_.v)return 0;if(1n===transaction_.v||28n===transaction_.v)return 1;if(transaction_.v>=35n)return transaction_.v%2n===0n?1:0}})(),"legacy"===transaction_.type&&(delete transaction_.accessList,delete transaction_.maxFeePerBlobGas,delete transaction_.maxFeePerGas,delete transaction_.maxPriorityFeePerGas,delete transaction_.yParity),"eip2930"===transaction_.type&&(delete transaction_.maxFeePerBlobGas,delete transaction_.maxFeePerGas,delete transaction_.maxPriorityFeePerGas),"eip1559"===transaction_.type&&delete transaction_.maxFeePerBlobGas,transaction_}export const defineTransaction=defineFormatter("transaction",formatTransaction);