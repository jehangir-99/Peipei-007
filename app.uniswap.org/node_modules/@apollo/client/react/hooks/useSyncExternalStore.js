import{invariant}from"../../utilities/globals/index.js";import*as React from"rehackt";import{canUseLayoutEffect}from"../../utilities/index.js";var didWarnUncachedGetSnapshot=!1,uSESKey="useSyncExternalStore",realHook=React[uSESKey];export var useSyncExternalStore=realHook||function(subscribe,getSnapshot,getServerSnapshot){var value=getSnapshot();!1===globalThis.__DEV__||didWarnUncachedGetSnapshot||value===getSnapshot()||(didWarnUncachedGetSnapshot=!0,!1!==globalThis.__DEV__&&invariant.error(58));var _a=React.useState({inst:{value:value,getSnapshot:getSnapshot}}),inst=_a[0].inst,forceUpdate=_a[1];return canUseLayoutEffect?React.useLayoutEffect((function(){Object.assign(inst,{value:value,getSnapshot:getSnapshot}),checkIfSnapshotChanged(inst)&&forceUpdate({inst:inst})}),[subscribe,value,getSnapshot]):Object.assign(inst,{value:value,getSnapshot:getSnapshot}),React.useEffect((function(){return checkIfSnapshotChanged(inst)&&forceUpdate({inst:inst}),subscribe((function(){checkIfSnapshotChanged(inst)&&forceUpdate({inst:inst})}))}),[subscribe]),value};function checkIfSnapshotChanged(_a){var value=_a.value,getSnapshot=_a.getSnapshot;try{return value!==getSnapshot()}catch(_b){return!0}}