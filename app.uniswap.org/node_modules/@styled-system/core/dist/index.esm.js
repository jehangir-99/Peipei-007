import assign from"object-assign";export var merge=function(a,b){var result=assign({},a,b);for(var key in a){var _assign;a[key]&&"object"==typeof b[key]&&assign(result,((_assign={})[key]=assign(a[key],b[key]),_assign))}return result};var sort=function(obj){var next={};return Object.keys(obj).sort((function(a,b){return a.localeCompare(b,void 0,{numeric:!0,sensitivity:"base"})})).forEach((function(key){next[key]=obj[key]})),next},defaults={breakpoints:[40,52,64].map((function(n){return n+"em"}))},createMediaQuery=function(n){return"@media screen and (min-width: "+n+")"},getValue=function(n,scale){return get(scale,n,n)};export var get=function(obj,key,def,p,undef){for(key=key&&key.split?key.split("."):[key],p=0;p<key.length;p++)obj=obj?obj[key[p]]:undef;return obj===undef?def:obj};export var createParser=function createParser(config){var cache={},parse=function(props){var styles={},shouldSort=!1,isCacheDisabled=props.theme&&props.theme.disableStyledSystemCache;for(var key in props)if(config[key]){var sx=config[key],raw=props[key],scale=get(props.theme,sx.scale,sx.defaults);if("object"!=typeof raw)assign(styles,sx(raw,scale,props));else{if(cache.breakpoints=!isCacheDisabled&&cache.breakpoints||get(props.theme,"breakpoints",defaults.breakpoints),Array.isArray(raw)){cache.media=!isCacheDisabled&&cache.media||[null].concat(cache.breakpoints.map(createMediaQuery)),styles=merge(styles,parseResponsiveStyle(cache.media,sx,scale,raw,props));continue}null!==raw&&(styles=merge(styles,parseResponsiveObject(cache.breakpoints,sx,scale,raw,props)),shouldSort=!0)}}return shouldSort&&(styles=sort(styles)),styles};parse.config=config,parse.propNames=Object.keys(config),parse.cache=cache;var keys=Object.keys(config).filter((function(k){return"config"!==k}));return keys.length>1&&keys.forEach((function(key){var _createParser;parse[key]=createParser(((_createParser={})[key]=config[key],_createParser))})),parse};var parseResponsiveStyle=function(mediaQueries,sx,scale,raw,_props){var styles={};return raw.slice(0,mediaQueries.length).forEach((function(value,i){var _assign2,media=mediaQueries[i],style=sx(value,scale,_props);media?assign(styles,((_assign2={})[media]=assign({},styles[media],style),_assign2)):assign(styles,style)})),styles},parseResponsiveObject=function(breakpoints,sx,scale,raw,_props){var styles={};for(var key in raw){var breakpoint=breakpoints[key],style=sx(raw[key],scale,_props);if(breakpoint){var _assign3,media=createMediaQuery(breakpoint);assign(styles,((_assign3={})[media]=assign({},styles[media],style),_assign3))}else assign(styles,style)}return styles};export var createStyleFunction=function(_ref){var properties=_ref.properties,property=_ref.property,scale=_ref.scale,_ref$transform=_ref.transform,transform=void 0===_ref$transform?getValue:_ref$transform,defaultScale=_ref.defaultScale;properties=properties||[property];var sx=function(value,scale,_props){var result={},n=transform(value,scale,_props);if(null!==n)return properties.forEach((function(prop){result[prop]=n})),result};return sx.scale=scale,sx.defaults=defaultScale,sx};export var system=function(args){void 0===args&&(args={});var config={};return Object.keys(args).forEach((function(key){var conf=args[key];config[key]=!0!==conf?"function"!=typeof conf?createStyleFunction(conf):conf:createStyleFunction({property:key,scale:key})})),createParser(config)};export var compose=function(){for(var config={},_len=arguments.length,parsers=new Array(_len),_key=0;_key<_len;_key++)parsers[_key]=arguments[_key];return parsers.forEach((function(parser){parser&&parser.config&&assign(config,parser.config)})),createParser(config)};