import{__awaiter,__extends,__generator}from"tslib";import{getGlobalScope}from"@amplitude/analytics-client-common";import{BaseTransport}from"@amplitude/analytics-core";var SendBeaconTransport=function(_super){function SendBeaconTransport(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(SendBeaconTransport,_super),SendBeaconTransport.prototype.send=function(serverUrl,payload){return __awaiter(this,void 0,void 0,(function(){var _this=this;return __generator(this,(function(_a){return[2,new Promise((function(resolve,reject){var globalScope=getGlobalScope();if(!(null==globalScope?void 0:globalScope.navigator.sendBeacon))throw new Error("SendBeaconTransport is not supported");try{var data=JSON.stringify(payload);return resolve(globalScope.navigator.sendBeacon(serverUrl,JSON.stringify(payload))?_this.buildResponse({code:200,events_ingested:payload.events.length,payload_size_bytes:data.length,server_upload_time:Date.now()}):_this.buildResponse({code:500}))}catch(e){reject(e)}}))]}))}))},SendBeaconTransport}(BaseTransport);export{SendBeaconTransport};