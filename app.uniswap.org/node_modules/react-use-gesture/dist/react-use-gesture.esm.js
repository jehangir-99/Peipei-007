import React from"react";function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}function _extends(){return _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,subClass.__proto__=superClass}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}var GestureFlag;!function(GestureFlag){GestureFlag.OnStart="start",GestureFlag.OnChange="change",GestureFlag.OnEnd="end"}(GestureFlag||(GestureFlag={}));var noop=function(){},chainFns=function(){for(var _len=arguments.length,fns=new Array(_len),_key=0;_key<_len;_key++)fns[_key]=arguments[_key];return function(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return fns.forEach((function(fn){return fn.apply(void 0,args)}))}},addV=function(v1,v2){return v1.map((function(v,i){return v+v2[i]}))},subV=function(v1,v2){return v1.map((function(v,i){return v-v2[i]}))},setListeners=function(add){return function(el,listeners,options){var action=add?"addEventListener":"removeEventListener";listeners.forEach((function(_ref){var type=_ref[0],fn=_ref[1];return el[action](type,fn,options)}))}},addListeners=setListeners(!0),removeListeners=setListeners(!1);function getModifierKeys(event){return{shiftKey:event.shiftKey,altKey:event.altKey,metaKey:event.metaKey,ctrlKey:event.ctrlKey}}function getScrollEventData(event){var _event$currentTarget=event.currentTarget,scrollX=_event$currentTarget.scrollX,scrollY=_event$currentTarget.scrollY,scrollLeft=_event$currentTarget.scrollLeft,scrollTop=_event$currentTarget.scrollTop;return _extends({xy:[scrollX||scrollLeft||0,scrollY||scrollTop||0]},getModifierKeys(event))}function getWheelEventData(event){return _extends({xy:[event.deltaX,event.deltaY]},getModifierKeys(event))}function getPointerEventData(event){var touches=event.touches,buttons=event.buttons,changedTouches=event.changedTouches,touchEvents=touches&&touches.length>0?touches:changedTouches&&changedTouches.length>0?changedTouches:null,_ref2=touchEvents?touchEvents[0]:event,clientX=_ref2.clientX,clientY=_ref2.clientY,down=touchEvents&&touchEvents.length>0||buttons>0;return _extends({xy:[clientX,clientY],touches:touchEvents&&touchEvents.length||0,down:down,buttons:buttons},getModifierKeys(event))}function getTwoTouchesEventData(event){var touches=event.touches,dx=touches[1].clientX-touches[0].clientX,dy=touches[1].clientY-touches[0].clientY;return _extends({da:[Math.hypot(dx,dy),-180*Math.atan2(dx,dy)/Math.PI],origin:[(touches[1].clientX+touches[0].clientX)/2,(touches[1].clientY+touches[0].clientY)/2],touches:2,down:touches.length>0},getModifierKeys(event))}function calculateVelocity(delta,delta_t,len){return len=len||Math.hypot.apply(Math,delta),delta_t?len/delta_t:0}function calculateVelocities(delta,delta_t){return delta_t?delta.map((function(v){return v/delta_t})):Array(delta.length).fill(0)}function calculateDistance(movement){return Math.hypot.apply(Math,movement)}function calculateDirection(delta,len){return len=len||Math.hypot.apply(Math,delta)||1,delta.map((function(v){return v/len}))}function calculateAllKinematics(movement,delta,delta_t){var len=Math.hypot.apply(Math,delta);return{velocities:calculateVelocities(delta,delta_t),velocity:calculateVelocity(delta,delta_t,len),distance:calculateDistance(movement),direction:calculateDirection(delta,len)}}function gestureEventSupported(){try{return"constructor"in GestureEvent}catch(e){return!1}}var mappedKeys={drag:{stateKey:"drag",handlerKey:"onDrag"},pinch:{stateKey:"pinch",handlerKey:"onPinch"},move:{stateKey:"move",handlerKey:"onMove"},scroll:{stateKey:"scroll",handlerKey:"onScroll"},wheel:{stateKey:"wheel",handlerKey:"onWheel"},hover:{stateKey:"move",handlerKey:"onHover"}},defaultConfig={domTarget:void 0,event:{passive:!0,capture:!1},window:"undefined"!=typeof window?window:void 0,dragDelay:!1,passiveEvents:!0,pointerEvents:!1,enabled:!0,drag:!0,pinch:!0,scroll:!0,wheel:!0,hover:!0,move:!0},initialCommon={event:void 0,currentTarget:void 0,pointerId:void 0,values:[0,0],delta:[0,0],movement:[0,0],offset:[0,0],direction:[0,0],initial:[0,0],previous:[0,0],first:!1,last:!1,active:!1,time:void 0,cancel:noop,canceled:!1,memo:void 0,args:void 0},initialCoordinates={xy:[0,0],vxvy:[0,0],velocity:0,distance:0},initialDistanceAngle={da:[0,0],vdva:[0,0],origin:void 0,turns:0},initialState={shared:{hovering:!1,scrolling:!1,wheeling:!1,dragging:!1,moving:!1,pinching:!1,touches:0,buttons:0,down:!1,shiftKey:!1,altKey:!1,metaKey:!1,ctrlKey:!1},move:_extends({},initialCommon,{},initialCoordinates),drag:_extends({},initialCommon,{},initialCoordinates),scroll:_extends({},initialCommon,{},initialCoordinates),wheel:_extends({},initialCommon,{},initialCoordinates),pinch:_extends({},initialCommon,{},initialDistanceAngle)},genericEndState={first:!1,last:!0,active:!1},Recognizer=function(){function Recognizer(gestureKey,controller,args){var _this=this;void 0===args&&(args=[]),this.gestureKey=gestureKey,this.controller=controller,this.args=args,this.continuousGesture=!1,this.setTimeout=function(callback,ms){var _window;void 0===ms&&(ms=140);for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)args[_key-2]=arguments[_key];_this.controller.timeouts[_this.stateKey]=(_window=window).setTimeout.apply(_window,[callback,ms].concat(args))},this.clearTimeout=function(){clearTimeout(_this.controller.timeouts[_this.stateKey])},this.addWindowListeners=function(listeners){_this.controller.addWindowListeners(_this.stateKey,listeners)},this.removeWindowListeners=function(){_this.controller.removeWindowListeners(_this.stateKey)},this.updateState=function(sharedState,gestureState){_this.controller.updateState(sharedState,gestureState,_this.stateKey)},this.fireGestureHandler=function(gestureFlag){_this.controller.fireGestureHandler(_this.gestureKey,gestureFlag)},this.onStart=function(event,payload){var _this$getPayloadFromE=_this.getPayloadFromEvent(event),values=_this$getPayloadFromE.values,gesturePayload=_this$getPayloadFromE.gesturePayload,sharedPayload=_this$getPayloadFromE.sharedPayload,startState=_extends({},initialState[_this.stateKey],{values:values,event:event,first:!0,active:!0,time:event.timeStamp,args:_this.args}),_this$state=_this.state,prevValues=_this$state.values,offset=_this$state.offset;_this.continuousGesture?(startState.initial=startState.previous=prevValues,startState.delta=startState.movement=subV(values,prevValues),startState.offset=values,Object.assign(startState,calculateAllKinematics(startState.movement,startState.delta,0))):(startState.initial=startState.previous=values,startState.offset=offset),_this.updateState(_extends({},_this.sharedStartState,{},sharedPayload),_extends({},startState,{},gesturePayload,{},payload)),_this.fireGestureHandler(GestureFlag.OnStart)},this.onChange=function(event,payload){var _this$getPayloadFromE2=_this.getPayloadFromEvent(event),values=_this$getPayloadFromE2.values,gesturePayload=_this$getPayloadFromE2.gesturePayload,sharedPayload=_this$getPayloadFromE2.sharedPayload,kinematics=_this.getKinematics(values,event);_this.updateState(_extends({},sharedPayload),_extends({first:!1},kinematics,{},gesturePayload,{},payload)),_this.fireGestureHandler(GestureFlag.OnChange)},this.onEnd=function(event,payload){_this.state.active&&(_this.removeWindowListeners(),_this.updateState(_this.sharedEndState,_extends({event:event},genericEndState,{},payload)),_this.fireGestureHandler(GestureFlag.OnEnd))},this.onCancel=function(event){_this.updateState(null,{canceled:!0,cancel:noop}),requestAnimationFrame((function(){return _this.onEnd(event)}))},this.timeoutHandler=function(event){_this.enabled&&(_this.clearTimeout(),_this.setTimeout(_this.onEnd),_this.state.active?_this.onChange(event):_this.onStart(event))},this.stateKey=mappedKeys[gestureKey].stateKey}return _createClass(Recognizer,[{key:"enabled",get:function(){return this.controller.config.enabled&&this.controller.config[this.gestureKey]}},{key:"state",get:function(){return this.controller.state[this.stateKey]}}]),Recognizer}(),CoordinatesRecognizer=function(_Recognizer){function CoordinatesRecognizer(){return _Recognizer.apply(this,arguments)||this}return _inheritsLoose(CoordinatesRecognizer,_Recognizer),CoordinatesRecognizer.prototype.getKinematics=function(values,event){var _this$state=this.state,xy=_this$state.values,initial=_this$state.initial,offset=_this$state.offset,time=_this$state.time,movement=subV(values,initial),delta=subV(values,xy),_calculateAllKinemati=calculateAllKinematics(movement,delta,event.timeStamp-time),velocity=_calculateAllKinemati.velocity,velocities=_calculateAllKinemati.velocities,distance=_calculateAllKinemati.distance,direction=_calculateAllKinemati.direction;return{event:event,values:values,movement:movement,offset:addV(offset,delta),delta:delta,velocity:velocity,vxvy:velocities,distance:distance,direction:direction,previous:xy,time:event.timeStamp}},CoordinatesRecognizer}(Recognizer),DEFAULT_DRAG_DELAY=180,DragRecognizer=function(_CoordinatesRecognize){function DragRecognizer(controller,args){var _this;return(_this=_CoordinatesRecognize.call(this,"drag",controller,args)||this).sharedStartState={dragging:!0,down:!0},_this.sharedEndState={dragging:!1,down:!1,buttons:0,touches:0},_this.delayedEvent=!1,_this.onDragStart=function(event){if(_this.enabled&&!(getPointerEventData(event).touches>1)){var currentTarget=event.currentTarget,pointerId=event.pointerId;if(_this.controller.config.pointerEvents)currentTarget&&currentTarget.setPointerCapture(pointerId);else{_this.removeWindowListeners();var dragListeners=[["mousemove",_this.onDragChange],["touchmove",_this.onDragChange],["mouseup",_this.onDragEnd],["touchend",_this.onDragEnd],["touchcancel",_this.onDragEnd]];_this.addWindowListeners(dragListeners)}if(_this.controller.config.dragDelay){var dragDelay="number"==typeof _this.controller.config.dragDelay?_this.controller.config.dragDelay:DEFAULT_DRAG_DELAY;"function"==typeof event.persist&&event.persist(),_this.delayedEvent=!0,_this.setTimeout((function(){return _this.startDrag(event)}),dragDelay)}else _this.startDrag(event)}},_this.startDrag=function(event){var currentTarget=event.currentTarget,pointerId=event.pointerId;_this.onStart(event,{currentTarget:currentTarget,pointerId:pointerId,cancel:function(){return _this.onCancel(event)}}),_this.delayedEvent=!1},_this.onDragChange=function(event){var _this$state=_this.state,canceled=_this$state.canceled,active=_this$state.active;if(!canceled)if(active){var _getPointerEventData2=getPointerEventData(event),buttons=_getPointerEventData2.buttons,touches=_getPointerEventData2.touches;0!==buttons||0!==touches?_this.onChange(event,{cancel:function(){return _this.onCancel(event)}}):_this.onEnd(event)}else _this.delayedEvent&&(_this.clearTimeout(),_this.startDrag(event))},_this.onDragEnd=function(event){if(_this.clearTimeout(),_this.delayedEvent=!1,_this.state.active){var _this$state2=_this.state,currentTarget=_this$state2.currentTarget,pointerId=_this$state2.pointerId;currentTarget&&_this.controller.config.pointerEvents&&currentTarget.releasePointerCapture(pointerId),_this.onEnd(event)}},_this}_inheritsLoose(DragRecognizer,_CoordinatesRecognize);var _proto=DragRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getPointerEventData3=getPointerEventData(event);return{values:_getPointerEventData3.xy,sharedPayload:_objectWithoutPropertiesLoose(_getPointerEventData3,["xy"])}},_proto.getEventBindings=function(){return this.controller.config.pointerEvents?[["onPointerDown",this.onDragStart],["onPointerMove",this.onDragChange],[["onPointerUp"],this.onDragEnd]]:[[["onMouseDown","onTouchStart"],this.onDragStart]]},DragRecognizer}(CoordinatesRecognizer),ScrollRecognizer=function(_CoordinatesRecognize){function ScrollRecognizer(controller,args){var _this;return(_this=_CoordinatesRecognize.call(this,"scroll",controller,args)||this).sharedStartState={scrolling:!0},_this.sharedEndState={scrolling:!1,velocity:0,vxvy:[0,0]},_this.continuousGesture=!0,_this}_inheritsLoose(ScrollRecognizer,_CoordinatesRecognize);var _proto=ScrollRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getScrollEventData=getScrollEventData(event);return{values:_getScrollEventData.xy,sharedPayload:_objectWithoutPropertiesLoose(_getScrollEventData,["xy"])}},_proto.getEventBindings=function(){return[["onScroll",this.timeoutHandler]]},ScrollRecognizer}(CoordinatesRecognizer),WheelRecognizer=function(_CoordinatesRecognize){function WheelRecognizer(controller,args){var _this;return(_this=_CoordinatesRecognize.call(this,"wheel",controller,args)||this).sharedStartState={wheeling:!0},_this.sharedEndState={wheeling:!1,velocity:0,vxvy:[0,0]},_this.continuousGesture=!0,_this.onWheel=function(event){event.ctrlKey&&_this.controller.actions.has("onPinch")||_this.timeoutHandler(event)},_this}_inheritsLoose(WheelRecognizer,_CoordinatesRecognize);var _proto=WheelRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var prevXY=this.state.xy,_getWheelEventData=getWheelEventData(event),xy=_getWheelEventData.xy,sharedPayload=_objectWithoutPropertiesLoose(_getWheelEventData,["xy"]);return{values:addV(xy,prevXY),sharedPayload:sharedPayload}},_proto.getEventBindings=function(){return[["onWheel",this.onWheel]]},WheelRecognizer}(CoordinatesRecognizer),MoveRecognizer=function(_CoordinatesRecognize){function MoveRecognizer(controller,args){var _this;return(_this=_CoordinatesRecognize.call(this,"move",controller,args)||this).sharedStartState={moving:!0},_this.sharedEndState={moving:!1,velocity:0,vxvy:[0,0]},_this}_inheritsLoose(MoveRecognizer,_CoordinatesRecognize);var _proto=MoveRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getPointerEventData=getPointerEventData(event);return{values:_getPointerEventData.xy,sharedPayload:_objectWithoutPropertiesLoose(_getPointerEventData,["xy"])}},_proto.getEventBindings=function(){return this.controller.config.pointerEvents?[["onPointerMove",this.timeoutHandler]]:[["onMouseMove",this.timeoutHandler]]},MoveRecognizer}(CoordinatesRecognizer),HoverRecognizer=function(_CoordinatesRecognize){function HoverRecognizer(controller,args){var _this;return(_this=_CoordinatesRecognize.call(this,"hover",controller,args)||this).onPointerEnter=function(event){if(_this.enabled){var _this$getPayloadFromE=_this.getPayloadFromEvent(event),values=_this$getPayloadFromE.values,sharedPayload=_this$getPayloadFromE.sharedPayload;_this.updateState(_extends({hovering:!0},sharedPayload),{values:values,event:event,args:_this.args}),_this.fireGestureHandler(GestureFlag.OnChange)}},_this.onPointerLeave=function(event){if(_this.enabled){var _this$getPayloadFromE2=_this.getPayloadFromEvent(event),values=_this$getPayloadFromE2.values,sharedPayload=_this$getPayloadFromE2.sharedPayload,kinematics=_this.getKinematics(values,event);_this.updateState(_extends({hovering:!1,moving:!1},sharedPayload),_extends({},kinematics,{},genericEndState,{velocity:0,vxvy:[0,0]})),_this.controller.fireGestureHandler("move",GestureFlag.OnEnd),_this.controller.fireGestureHandler("hover",GestureFlag.OnChange)}},_this}_inheritsLoose(HoverRecognizer,_CoordinatesRecognize);var _proto=HoverRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getPointerEventData=getPointerEventData(event);return{values:_getPointerEventData.xy,sharedPayload:_objectWithoutPropertiesLoose(_getPointerEventData,["xy"])}},_proto.getEventBindings=function(){return this.controller.config.pointerEvents?[["onPointerEnter",this.onPointerEnter],["onPointerLeave",this.onPointerLeave]]:[["onMouseEnter",this.onPointerEnter],["onMouseLeave",this.onPointerLeave]]},HoverRecognizer}(CoordinatesRecognizer),DistanceAngleRecognizer=function(_Recognizer){function DistanceAngleRecognizer(gestureKey,controller,args){return void 0===args&&(args=[]),_Recognizer.call(this,gestureKey,controller,args)||this}return _inheritsLoose(DistanceAngleRecognizer,_Recognizer),DistanceAngleRecognizer.prototype.getKinematics=function(_ref,event){var d=_ref[0],a=_ref[1],_this$state=this.state,da=_this$state.values,turns=_this$state.turns,initial=_this$state.initial,offset=_this$state.offset,time=_this$state.time;a=void 0!==a?a:da[1];var delta_d=d-da[0],delta_a=a-da[1],newTurns=Math.abs(delta_a)>270?turns+Math.sign(delta_a):turns,delta=[delta_d,delta_a-=360*(newTurns-turns)],movement=[d-initial[0],a-360*newTurns-initial[1]],vdva=calculateVelocities(delta,event.timeStamp-time),direction=calculateDirection(delta);return{event:event,values:[d,a],movement:movement,delta:delta,offset:addV(offset,delta),vdva:vdva,direction:direction,turns:newTurns,previous:da,time:event.timeStamp}},DistanceAngleRecognizer}(Recognizer),PinchRecognizer=function(_DistanceAngleRecogni){function PinchRecognizer(controller,args){var _this;return(_this=_DistanceAngleRecogni.call(this,"pinch",controller,args)||this).sharedStartState={pinching:!0},_this.sharedEndState={pinching:!1,down:!1,touches:0},_this.onPinchStart=function(event){_this.enabled&&2===event.touches.length&&_this.onStart(event,{cancel:function(){return _this.onCancel(event)}})},_this.onPinchChange=function(event){var _this$state=_this.state,canceled=_this$state.canceled,active=_this$state.active,time=_this$state.time;!canceled&&active&&2===event.touches.length&&event.timeStamp!==time&&_this.onChange(event,{cancel:function(){return _this.onCancel(event)}})},_this}_inheritsLoose(PinchRecognizer,_DistanceAngleRecogni);var _proto=PinchRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getTwoTouchesEventDa=getTwoTouchesEventData(event);return{values:_getTwoTouchesEventDa.da,gesturePayload:{origin:_getTwoTouchesEventDa.origin},sharedPayload:_objectWithoutPropertiesLoose(_getTwoTouchesEventDa,["da","origin"])}},_proto.getEventBindings=function(){return[["onTouchStart",this.onPinchStart],["onTouchMove",this.onPinchChange],[["onTouchEnd","onTouchCancel"],this.onEnd]]},PinchRecognizer}(DistanceAngleRecognizer),PinchWheelRecognizer=function(_DistanceAngleRecogni){function PinchWheelRecognizer(controller,args){var _this;return(_this=_DistanceAngleRecogni.call(this,"pinch",controller,args)||this).sharedStartState={pinching:!0},_this.sharedEndState={pinching:!1},_this.onWheel=function(event){event.ctrlKey&&(_this.controller.config.passiveEvents?"development"===process.env.NODE_ENV&&console.warn("To support zoom on trackpads, try using the `domTarget` option and `config.event.passive` set to `false`. This message will only appear in development mode."):event.preventDefault(),_this.timeoutHandler(event))},_this}_inheritsLoose(PinchWheelRecognizer,_DistanceAngleRecogni);var _proto=PinchWheelRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){var _getWheelEventData=getWheelEventData(event),delta_d=_getWheelEventData.xy[1],sharedPayload=_objectWithoutPropertiesLoose(_getWheelEventData,["xy"]),_this$state$da=this.state.da,prev_d=_this$state$da[0],prev_a=_this$state$da[1];return{values:[prev_d-delta_d,void 0!==prev_a?prev_a:0],gesturePayload:{origin:[event.clientX,event.clientY]},sharedPayload:sharedPayload}},_proto.getEventBindings=function(){return[["onWheel",this.onWheel]]},PinchWheelRecognizer}(DistanceAngleRecognizer),SCALE_FACTOR=260,PinchWebKitGestureRecognizer=function(_DistanceAngleRecogni){function PinchWebKitGestureRecognizer(controller,args){var _this;return(_this=_DistanceAngleRecogni.call(this,"pinch",controller,args)||this).sharedStartState={pinching:!0,down:!0,touches:2},_this.sharedEndState={pinching:!1,down:!1,touches:0},_this.onPinchStart=function(event){if(_this.enabled){event.preventDefault();var origin=_this.origin?_this.origin:[event.clientX,event.clientY];_this.onStart(event,{origin:origin,cancel:function(){return _this.onCancel(event)}})}},_this.onPinchChange=function(event){var _this$state=_this.state,canceled=_this$state.canceled,active=_this$state.active;!canceled&&active&&(event.preventDefault(),_this.onChange(event,{cancel:function(){return _this.onCancel(event)}}))},_this.onGestureEnd=function(event){_this.onEnd(event),event.preventDefault(),_this.origin=void 0},_this.updateTouchData=function(event){if(_this.enabled&&2===event.touches.length){var origin=getTwoTouchesEventData(event).origin;_this.origin=origin}},_this}_inheritsLoose(PinchWebKitGestureRecognizer,_DistanceAngleRecogni);var _proto=PinchWebKitGestureRecognizer.prototype;return _proto.getPayloadFromEvent=function(event){return{values:[event.scale*SCALE_FACTOR,event.rotation]}},_proto.getEventBindings=function(){return[["onGestureStart",this.onPinchStart],["onGestureChange",this.onPinchChange],[["onGestureEnd","onTouchCancel"],this.onGestureEnd],[["onTouchStart","onTouchMove"],this.updateTouchData]]},PinchWebKitGestureRecognizer}(DistanceAngleRecognizer),GestureController=function(handlers,config){var _this=this;this.handlers=handlers,this.config=config,this.state=initialState,this.timeouts={},this.bindings={},this.domListeners=[],this.windowListeners={},this.clean=function(){_this.cleanOnBind(),Object.values(_this.timeouts).forEach(clearTimeout),Object.keys(_this.windowListeners).forEach((function(stateKey){return _this.removeWindowListeners(stateKey)}))},this.cleanOnBind=function(){_this.bindings={};var domTarget=_this.config.domTarget;domTarget&&(removeListeners(domTarget,_this.domListeners,_this.config.event),_this.domListeners=[])},this.updateState=function(sharedState,gestureState,stateKey){var _extends2,newGestureState=_extends({},_this.state[stateKey],{},gestureState);"da"in newGestureState?newGestureState.da=newGestureState.values:"xy"in newGestureState&&(newGestureState.xy=newGestureState.values),_this.state=_extends({},_this.state,((_extends2={shared:_extends({},_this.state.shared,{},sharedState)})[stateKey]=newGestureState,_extends2))},this.fireGestureHandler=function(gestureKey,gestureFlag){var _mappedKeys$gestureKe=mappedKeys[gestureKey],stateKey=_mappedKeys$gestureKe.stateKey,handlerKey=_mappedKeys$gestureKe.handlerKey,state=_extends({},_this.state.shared,{},_this.state[stateKey]);if(state.event&&(state.event.gesture=gestureKey),gestureFlag===GestureFlag.OnStart){var handlerStart=handlerKey+"Start",_handler=_this.handlers[handlerStart];_handler&&_handler(state)}var handler=_this.handlers[handlerKey];if(handler){var newMemo=handler(state);_this.state[stateKey].memo=void 0!==newMemo?newMemo:_this.state[stateKey].memo}if(gestureFlag===GestureFlag.OnEnd){var handlerEnd=handlerKey+"End",_handler2=_this.handlers[handlerEnd];_handler2&&_handler2(state)}},this.addWindowListeners=function(stateKey,listeners){_this.config.window&&(_this.windowListeners[stateKey]=listeners,addListeners(_this.config.window,listeners,_this.config.event))},this.removeWindowListeners=function(stateKey){if(_this.config.window){var listeners=_this.windowListeners[stateKey];listeners&&(removeListeners(_this.config.window,listeners,_this.config.event),delete _this.windowListeners[stateKey])}},this.addRecognizer=function(recognizer){recognizer.getEventBindings().map(_this.addEventBindings)},this.addEventBindings=function(_ref){var eventNames=_ref[0],fn=_ref[1];(Array.isArray(eventNames)?eventNames:[eventNames]).forEach((function(eventName){_this.bindings[eventName]=_this.bindings[eventName]?[].concat(_this.bindings[eventName],[fn]):[fn]}))},this.addDomTargetListeners=function(){var domTarget=_this.config.domTarget;Object.entries(_this.bindings).forEach((function(_ref2){var event=_ref2[0],fns=_ref2[1];_this.domListeners.push([event.substr(2).toLowerCase(),chainFns.apply(void 0,fns)])})),addListeners(domTarget,_this.domListeners,_this.config.event)},this.getBindings=function(){var output={},captureString=_this.config.event.capture?"Capture":"";return Object.entries(_this.bindings).forEach((function(_ref3){var event=_ref3[0],fns=_ref3[1],fnsArray=Array.isArray(fns)?fns:[fns];output[event+captureString]=chainFns.apply(void 0,fnsArray)})),output},this.bind=function(){var domTarget=_this.config.domTarget,genuineHandlers=_extends({},_this.handlers);_this.cleanOnBind();for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this.actions.has("onDrag")&&(_this.addRecognizer(new DragRecognizer(_this,args)),delete genuineHandlers.onDrag,delete genuineHandlers.onDragStart,delete genuineHandlers.onDragEnd),_this.actions.has("onScroll")&&(_this.addRecognizer(new ScrollRecognizer(_this,args)),delete genuineHandlers.onScroll,delete genuineHandlers.onScrollStart,delete genuineHandlers.onScrollEnd),_this.actions.has("onWheel")&&(_this.addRecognizer(new WheelRecognizer(_this,args)),delete genuineHandlers.onWheel,delete genuineHandlers.onWheelStart,delete genuineHandlers.onWheelEnd),_this.actions.has("onMove")&&(_this.addRecognizer(new MoveRecognizer(_this,args)),delete genuineHandlers.onMove,delete genuineHandlers.onMoveStart,delete genuineHandlers.onMoveEnd),_this.actions.has("onHover")&&(_this.addRecognizer(new HoverRecognizer(_this,args)),delete genuineHandlers.onHover),_this.actions.has("onPinch")&&(domTarget&&gestureEventSupported()?_this.addRecognizer(new PinchWebKitGestureRecognizer(_this,args)):(_this.addRecognizer(new PinchRecognizer(_this,args)),_this.addRecognizer(new PinchWheelRecognizer(_this,args))),delete genuineHandlers.onPinch,delete genuineHandlers.onPinchStart,delete genuineHandlers.onPinchEnd),Object.entries(genuineHandlers).map((function(_ref4){var event=_ref4[0],fn=_ref4[1];_this.addEventBindings([event,fn])})),domTarget?(_this.addDomTargetListeners(),_this.clean):_this.getBindings()},this.actions=new Set(Object.keys(this.handlers).map((function(k){return k.replace(/End|Start/,"")})))};function useGesture(handlers,config){var gestureController=React.useRef();return gestureController.current||(gestureController.current=new GestureController(handlers,getDerivedConfig(config))),React.useEffect((function(){gestureController.current.config=getDerivedConfig(config),gestureController.current.handlers=handlers}),[handlers,config]),React.useEffect((function(){return gestureController.current.clean}),[]),gestureController.current.bind}var useDrag=function(handler,config){return useGesture({onDrag:handler},config)},useMove=function(handler,config){return useGesture({onMove:handler},config)},useHover=function(handler,config){return useGesture({onHover:handler},config)},useScroll=function(handler,config){return useGesture({onScroll:handler},config)},useWheel=function(handler,config){return useGesture({onWheel:handler},config)},usePinch=function(handler,config){return useGesture({onPinch:handler},config)};function getDerivedConfig(config){var derivedConfig=_extends({},defaultConfig,{},config),domTarget=derivedConfig.domTarget,realDomTarget=domTarget&&"current"in domTarget?domTarget.current:domTarget;derivedConfig.domTarget=realDomTarget;var passive=void 0===derivedConfig.event.passive||derivedConfig.event.passive;return derivedConfig.passiveEvents=!derivedConfig.domTarget||passive,derivedConfig}export{addV,subV,useDrag,useGesture,useHover,useMove,usePinch,useScroll,useWheel};