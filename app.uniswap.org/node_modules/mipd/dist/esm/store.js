import{requestProviders}from"./utils.js";export function createStore(){const listeners=new Set;let providerDetails=[];const request=()=>requestProviders((providerDetail=>{providerDetails.some((({info:info})=>info.uuid===providerDetail.info.uuid))||(providerDetails=[...providerDetails,providerDetail],listeners.forEach((listener=>listener(providerDetails,{added:[providerDetail]}))))}));let unwatch=request();return{_listeners:()=>listeners,clear(){listeners.forEach((listener=>listener([],{removed:[...providerDetails]}))),providerDetails=[]},destroy(){this.clear(),listeners.clear(),unwatch()},findProvider:({rdns:rdns})=>providerDetails.find((providerDetail=>providerDetail.info.rdns===rdns)),getProviders:()=>providerDetails,reset(){this.clear(),unwatch(),unwatch=request()},subscribe:(listener,{emitImmediately:emitImmediately}={})=>(listeners.add(listener),emitImmediately&&listener(providerDetails,{added:providerDetails}),()=>listeners.delete(listener))}}