"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.serialize=exports.getErrorCode=exports.isValidCode=exports.getMessageFromCode=exports.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const constants_1=require("./constants"),FALLBACK_MESSAGE="Unspecified error message.";function getMessageFromCode(code,fallbackMessage=FALLBACK_MESSAGE){if(code&&Number.isInteger(code)){const codeString=code.toString();if(hasKey(constants_1.errorValues,codeString))return constants_1.errorValues[codeString].message;if(isJsonRpcServerError(code))return exports.JSON_RPC_SERVER_ERROR_MESSAGE}return fallbackMessage}function isValidCode(code){if(!Number.isInteger(code))return!1;const codeString=code.toString();return!!constants_1.errorValues[codeString]||!!isJsonRpcServerError(code)}function getErrorCode(error){var _a;return"number"==typeof error?error:isErrorWithCode(error)?null!==(_a=error.code)&&void 0!==_a?_a:error.errorCode:void 0}function isErrorWithCode(error){return"object"==typeof error&&null!==error&&("number"==typeof error.code||"number"==typeof error.errorCode)}function serialize(error,{shouldIncludeStack:shouldIncludeStack=!1}={}){const serialized={};if(error&&"object"==typeof error&&!Array.isArray(error)&&hasKey(error,"code")&&isValidCode(error.code)){const _error=error;serialized.code=_error.code,_error.message&&"string"==typeof _error.message?(serialized.message=_error.message,hasKey(_error,"data")&&(serialized.data=_error.data)):(serialized.message=getMessageFromCode(serialized.code),serialized.data={originalError:assignOriginalError(error)})}else serialized.code=constants_1.standardErrorCodes.rpc.internal,serialized.message=hasStringProperty(error,"message")?error.message:FALLBACK_MESSAGE,serialized.data={originalError:assignOriginalError(error)};return shouldIncludeStack&&(serialized.stack=hasStringProperty(error,"stack")?error.stack:void 0),serialized}function isJsonRpcServerError(code){return code>=-32099&&code<=-32e3}function assignOriginalError(error){return error&&"object"==typeof error&&!Array.isArray(error)?Object.assign({},error):error}function hasKey(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}function hasStringProperty(obj,prop){return"object"==typeof obj&&null!==obj&&prop in obj&&"string"==typeof obj[prop]}exports.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",exports.getMessageFromCode=getMessageFromCode,exports.isValidCode=isValidCode,exports.getErrorCode=getErrorCode,exports.serialize=serialize;