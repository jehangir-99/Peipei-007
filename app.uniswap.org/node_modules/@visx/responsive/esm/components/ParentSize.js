import _pt from"prop-types";var _excluded=["className","children","debounceTime","ignoreDimensions","parentSizeStyles","enableDebounceLeadingCall"];function _extends(){return _extends=Object.assign?Object.assign.bind():function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_extends.apply(this,arguments)}function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}import debounce from"lodash/debounce";import React,{useEffect,useMemo,useRef,useState}from"react";import{ResizeObserver}from"@juggle/resize-observer";var defaultIgnoreDimensions=[];export default function ParentSize(_ref){var className=_ref.className,children=_ref.children,_ref$debounceTime=_ref.debounceTime,debounceTime=void 0===_ref$debounceTime?300:_ref$debounceTime,_ref$ignoreDimensions=_ref.ignoreDimensions,ignoreDimensions=void 0===_ref$ignoreDimensions?defaultIgnoreDimensions:_ref$ignoreDimensions,_ref$parentSizeStyles=_ref.parentSizeStyles,parentSizeStyles=void 0===_ref$parentSizeStyles?{width:"100%",height:"100%"}:_ref$parentSizeStyles,_ref$enableDebounceLe=_ref.enableDebounceLeadingCall,enableDebounceLeadingCall=void 0===_ref$enableDebounceLe||_ref$enableDebounceLe,restProps=_objectWithoutPropertiesLoose(_ref,_excluded),target=useRef(null),animationFrameID=useRef(0),_useState=useState({width:0,height:0,top:0,left:0}),state=_useState[0],setState=_useState[1],resize=useMemo((function(){var normalized=Array.isArray(ignoreDimensions)?ignoreDimensions:[ignoreDimensions];return debounce((function(incoming){setState((function(existing){return Object.keys(existing).filter((function(key){return existing[key]!==incoming[key]})).every((function(key){return normalized.includes(key)}))?existing:incoming}))}),debounceTime,{leading:enableDebounceLeadingCall})}),[debounceTime,enableDebounceLeadingCall,ignoreDimensions]);return useEffect((function(){var observer=new ResizeObserver((function(entries){void 0===entries&&(entries=[]),entries.forEach((function(entry){var _entry$contentRect=entry.contentRect,left=_entry$contentRect.left,top=_entry$contentRect.top,width=_entry$contentRect.width,height=_entry$contentRect.height;animationFrameID.current=window.requestAnimationFrame((function(){resize({width:width,height:height,top:top,left:left})}))}))}));return target.current&&observer.observe(target.current),function(){window.cancelAnimationFrame(animationFrameID.current),observer.disconnect(),null!=resize&&resize.cancel&&resize.cancel()}}),[resize]),React.createElement("div",_extends({style:parentSizeStyles,ref:target,className:className},restProps),children(_extends({},state,{ref:target.current,resize:resize})))}ParentSize.propTypes={className:_pt.string,debounceTime:_pt.number,enableDebounceLeadingCall:_pt.bool,ignoreDimensions:_pt.oneOfType([_pt.any,_pt.arrayOf(_pt.any)]),children:_pt.func.isRequired};