import{isString}from"./is.js";import{getGlobalObject}from"./worldwide.js";const WINDOW=getGlobalObject(),DEFAULT_MAX_STRING_LENGTH=80;function htmlTreeAsString(elem,options={}){if(!elem)return"<unknown>";try{let currentElem=elem;const MAX_TRAVERSE_HEIGHT=5,out=[];let height=0,len=0;const separator=" > ",sepLength=separator.length;let nextStr;const keyAttrs=Array.isArray(options)?options:options.keyAttrs,maxStringLength=!Array.isArray(options)&&options.maxStringLength||80;for(;currentElem&&height++<MAX_TRAVERSE_HEIGHT&&(nextStr=_htmlElementAsString(currentElem,keyAttrs),!("html"===nextStr||height>1&&len+out.length*sepLength+nextStr.length>=maxStringLength));)out.push(nextStr),len+=nextStr.length,currentElem=currentElem.parentNode;return out.reverse().join(separator)}catch(_oO){return"<unknown>"}}function _htmlElementAsString(el,keyAttrs){const elem=el,out=[];let className,classes,key,attr,i;if(!elem||!elem.tagName)return"";out.push(elem.tagName.toLowerCase());const keyAttrPairs=keyAttrs&&keyAttrs.length?keyAttrs.filter((keyAttr=>elem.getAttribute(keyAttr))).map((keyAttr=>[keyAttr,elem.getAttribute(keyAttr)])):null;if(keyAttrPairs&&keyAttrPairs.length)keyAttrPairs.forEach((keyAttrPair=>{out.push(`[${keyAttrPair[0]}="${keyAttrPair[1]}"]`)}));else if(elem.id&&out.push(`#${elem.id}`),className=elem.className,className&&isString(className))for(classes=className.split(/\s+/),i=0;i<classes.length;i++)out.push(`.${classes[i]}`);const allowedAttrs=["aria-label","type","name","title","alt"];for(i=0;i<allowedAttrs.length;i++)key=allowedAttrs[i],attr=elem.getAttribute(key),attr&&out.push(`[${key}="${attr}"]`);return out.join("")}function getLocationHref(){try{return WINDOW.document.location.href}catch(oO){return""}}function getDomElement(selector){return WINDOW.document&&WINDOW.document.querySelector?WINDOW.document.querySelector(selector):null}export{getDomElement,getLocationHref,htmlTreeAsString};