import{getSdkMetadataForEnvelopeHeader,createEventEnvelopeHeaders,createEnvelope,dsnToString}from"@sentry/utils";function enhanceEventWithSdkInfo(event,sdkInfo){return sdkInfo?(event.sdk=event.sdk||{},event.sdk.name=event.sdk.name||sdkInfo.name,event.sdk.version=event.sdk.version||sdkInfo.version,event.sdk.integrations=[...event.sdk.integrations||[],...sdkInfo.integrations||[]],event.sdk.packages=[...event.sdk.packages||[],...sdkInfo.packages||[]],event):event}function createSessionEnvelope(session,dsn,metadata,tunnel){const sdkInfo=getSdkMetadataForEnvelopeHeader(metadata),envelopeHeaders={sent_at:(new Date).toISOString(),...sdkInfo&&{sdk:sdkInfo},...!!tunnel&&dsn&&{dsn:dsnToString(dsn)}},envelopeItem="aggregates"in session?[{type:"sessions"},session]:[{type:"session"},session.toJSON()];return createEnvelope(envelopeHeaders,[envelopeItem])}function createEventEnvelope(event,dsn,metadata,tunnel){const sdkInfo=getSdkMetadataForEnvelopeHeader(metadata),eventType=event.type&&"replay_event"!==event.type?event.type:"event";enhanceEventWithSdkInfo(event,metadata&&metadata.sdk);const envelopeHeaders=createEventEnvelopeHeaders(event,sdkInfo,tunnel,dsn);delete event.sdkProcessingMetadata;return createEnvelope(envelopeHeaders,[[{type:eventType},event]])}export{createEventEnvelope,createSessionEnvelope};