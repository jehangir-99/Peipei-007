import{Component,createElement}from"react";let windowObject;windowObject="undefined"!=typeof window?window:"undefined"!=typeof self?self:global;let cancelFrame=null,requestFrame=null;const TIMEOUT_DURATION=20,clearTimeoutFn=windowObject.clearTimeout,setTimeoutFn=windowObject.setTimeout,cancelAnimationFrameFn=windowObject.cancelAnimationFrame||windowObject.mozCancelAnimationFrame||windowObject.webkitCancelAnimationFrame,requestAnimationFrameFn=windowObject.requestAnimationFrame||windowObject.mozRequestAnimationFrame||windowObject.webkitRequestAnimationFrame;function createDetectElementResize(nonce){let animationKeyframes,animationName,animationStartEvent,animationStyle,checkTriggers,resetTriggers,scrollListener;const attachEvent="undefined"!=typeof document&&document.attachEvent;if(!attachEvent){resetTriggers=function(element){const triggers=element.__resizeTriggers__,expand=triggers.firstElementChild,contract=triggers.lastElementChild,expandChild=expand.firstElementChild;contract.scrollLeft=contract.scrollWidth,contract.scrollTop=contract.scrollHeight,expandChild.style.width=expand.offsetWidth+1+"px",expandChild.style.height=expand.offsetHeight+1+"px",expand.scrollLeft=expand.scrollWidth,expand.scrollTop=expand.scrollHeight},checkTriggers=function(element){return element.offsetWidth!==element.__resizeLast__.width||element.offsetHeight!==element.__resizeLast__.height},scrollListener=function(e){if(e.target.className&&"function"==typeof e.target.className.indexOf&&e.target.className.indexOf("contract-trigger")<0&&e.target.className.indexOf("expand-trigger")<0)return;const element=this;resetTriggers(this),this.__resizeRAF__&&cancelFrame(this.__resizeRAF__),this.__resizeRAF__=requestFrame((function(){checkTriggers(element)&&(element.__resizeLast__.width=element.offsetWidth,element.__resizeLast__.height=element.offsetHeight,element.__resizeListeners__.forEach((function(fn){fn.call(element,e)})))}))};let animation=!1,keyframeprefix="";animationStartEvent="animationstart";const domPrefixes="Webkit Moz O ms".split(" ");let startEvents="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),pfx="";{const elm=document.createElement("fakeelement");if(void 0!==elm.style.animationName&&(animation=!0),!1===animation)for(let i=0;i<domPrefixes.length;i++)if(void 0!==elm.style[domPrefixes[i]+"AnimationName"]){pfx=domPrefixes[i],keyframeprefix="-"+pfx.toLowerCase()+"-",animationStartEvent=startEvents[i],animation=!0;break}}animationName="resizeanim",animationKeyframes="@"+keyframeprefix+"keyframes "+animationName+" { from { opacity: 0; } to { opacity: 0; } } ",animationStyle=keyframeprefix+"animation: 1ms "+animationName+"; "}return{addResizeListener:function(element,fn){if(attachEvent)element.attachEvent("onresize",fn);else{if(!element.__resizeTriggers__){const doc=element.ownerDocument,elementStyle=windowObject.getComputedStyle(element);elementStyle&&"static"===elementStyle.position&&(element.style.position="relative"),function(doc){if(!doc.getElementById("detectElementResize")){const css=(animationKeyframes||"")+".resize-triggers { "+(animationStyle||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',head=doc.head||doc.getElementsByTagName("head")[0],style=doc.createElement("style");style.id="detectElementResize",style.type="text/css",null!=nonce&&style.setAttribute("nonce",nonce),style.styleSheet?style.styleSheet.cssText=css:style.appendChild(doc.createTextNode(css)),head.appendChild(style)}}(doc),element.__resizeLast__={},element.__resizeListeners__=[],(element.__resizeTriggers__=doc.createElement("div")).className="resize-triggers";const expandTrigger=doc.createElement("div");expandTrigger.className="expand-trigger",expandTrigger.appendChild(doc.createElement("div"));const contractTrigger=doc.createElement("div");contractTrigger.className="contract-trigger",element.__resizeTriggers__.appendChild(expandTrigger),element.__resizeTriggers__.appendChild(contractTrigger),element.appendChild(element.__resizeTriggers__),resetTriggers(element),element.addEventListener("scroll",scrollListener,!0),animationStartEvent&&(element.__resizeTriggers__.__animationListener__=function(e){e.animationName===animationName&&resetTriggers(element)},element.__resizeTriggers__.addEventListener(animationStartEvent,element.__resizeTriggers__.__animationListener__))}element.__resizeListeners__.push(fn)}},removeResizeListener:function(element,fn){if(attachEvent)element.detachEvent("onresize",fn);else if(element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(fn),1),!element.__resizeListeners__.length){element.removeEventListener("scroll",scrollListener,!0),element.__resizeTriggers__.__animationListener__&&(element.__resizeTriggers__.removeEventListener(animationStartEvent,element.__resizeTriggers__.__animationListener__),element.__resizeTriggers__.__animationListener__=null);try{element.__resizeTriggers__=!element.removeChild(element.__resizeTriggers__)}catch(e){}}}}}null==cancelAnimationFrameFn||null==requestAnimationFrameFn?(cancelFrame=clearTimeoutFn,requestFrame=function(callback){return setTimeoutFn(callback,20)}):(cancelFrame=function([animationFrameID,timeoutID]){cancelAnimationFrameFn(animationFrameID),clearTimeoutFn(timeoutID)},requestFrame=function(callback){const animationFrameID=requestAnimationFrameFn((function(){clearTimeoutFn(timeoutID),callback()})),timeoutID=setTimeoutFn((function(){cancelAnimationFrameFn(animationFrameID),callback()}),20);return[animationFrameID,timeoutID]});class AutoSizer extends Component{constructor(...args){super(...args),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;const{disableHeight:disableHeight,disableWidth:disableWidth,onResize:onResize}=this.props;if(this._parentNode){var _style$paddingLeft,_style$paddingRight,_style$paddingTop,_style$paddingBottom;const style=window.getComputedStyle(this._parentNode)||{},paddingLeft=parseFloat(null!==(_style$paddingLeft=style.paddingLeft)&&void 0!==_style$paddingLeft?_style$paddingLeft:"0"),paddingRight=parseFloat(null!==(_style$paddingRight=style.paddingRight)&&void 0!==_style$paddingRight?_style$paddingRight:"0"),paddingTop=parseFloat(null!==(_style$paddingTop=style.paddingTop)&&void 0!==_style$paddingTop?_style$paddingTop:"0"),paddingBottom=parseFloat(null!==(_style$paddingBottom=style.paddingBottom)&&void 0!==_style$paddingBottom?_style$paddingBottom:"0"),rect=this._parentNode.getBoundingClientRect(),scaledHeight=rect.height-paddingTop-paddingBottom,scaledWidth=rect.width-paddingLeft-paddingRight,height=this._parentNode.offsetHeight-paddingTop-paddingBottom,width=this._parentNode.offsetWidth-paddingLeft-paddingRight;(disableHeight||this.state.height===height&&this.state.scaledHeight===scaledHeight)&&(disableWidth||this.state.width===width&&this.state.scaledWidth===scaledWidth)||(this.setState({height:height,width:width,scaledHeight:scaledHeight,scaledWidth:scaledWidth}),"function"==typeof onResize&&onResize({height:height,scaledHeight:scaledHeight,scaledWidth:scaledWidth,width:width}))}},this._setRef=autoSizer=>{this._autoSizer=autoSizer}}componentDidMount(){const{nonce:nonce}=this.props;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,null!=this._parentNode&&("undefined"!=typeof ResizeObserver?(this._resizeObserver=new ResizeObserver((()=>{this._timeoutId=setTimeout(this._onResize,0)})),this._resizeObserver.observe(this._parentNode)):(this._detectElementResize=createDetectElementResize(nonce),this._detectElementResize.addResizeListener(this._parentNode,this._onResize)),this._onResize()))}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),null!==this._timeoutId&&clearTimeout(this._timeoutId),this._resizeObserver&&(this._resizeObserver.observe(this._parentNode),this._resizeObserver.disconnect()))}render(){const{children:children,defaultHeight:defaultHeight,defaultWidth:defaultWidth,disableHeight:disableHeight=!1,disableWidth:disableWidth=!1,nonce:nonce,onResize:onResize,style:style={},tagName:tagName="div",...rest}=this.props,{height:height,scaledHeight:scaledHeight,scaledWidth:scaledWidth,width:width}=this.state,outerStyle={overflow:"visible"},childParams={};let bailoutOnChildren=!1;return disableHeight||(0===height&&(bailoutOnChildren=!0),outerStyle.height=0,childParams.height=height,childParams.scaledHeight=scaledHeight),disableWidth||(0===width&&(bailoutOnChildren=!0),outerStyle.width=0,childParams.width=width,childParams.scaledWidth=scaledWidth),createElement(tagName,{ref:this._setRef,style:{...outerStyle,...style},...rest},!bailoutOnChildren&&children(childParams))}}function isHeightAndWidthProps(props){return props&&!0!==props.disableHeight&&!0!==props.disableWidth}function isHeightOnlyProps(props){return props&&!0!==props.disableHeight&&!0===props.disableWidth}function isWidthOnlyProps(props){return props&&!0===props.disableHeight&&!0!==props.disableWidth}export{AutoSizer as default,isHeightAndWidthProps,isHeightOnlyProps,isWidthOnlyProps};