"use strict";import{useEffect,useRef}from"react";import{initialUpdaterRun}from"../animation";import{makeMutable,startMapper,stopMapper}from"../core";import{shouldBeUseWeb}from"../PlatformChecker";export function useDerivedValue(updater,dependencies){const initRef=useRef(null);let inputs=Object.values(updater.__closure??{});var _dependencies;shouldBeUseWeb()&&(!inputs.length&&null!==(_dependencies=dependencies)&&void 0!==_dependencies&&_dependencies.length&&(inputs=dependencies));void 0===dependencies?dependencies=[...inputs,updater.__workletHash]:dependencies.push(updater.__workletHash),null===initRef.current&&(initRef.current=makeMutable(initialUpdaterRun(updater)));const sharedValue=initRef.current;return useEffect((()=>{const mapperId=startMapper((()=>{sharedValue.value=updater()}),inputs,[sharedValue]);return()=>{stopMapper(mapperId)}}),dependencies),useEffect((()=>()=>{initRef.current=null}),[]),sharedValue}