"use strict";import{defineAnimation,getReduceMotionForAnimation}from"./util";export const withRepeat=function(_nextAnimation){let numberOfReps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,reverse=arguments.length>2&&void 0!==arguments[2]&&arguments[2],callback=arguments.length>3?arguments[3]:void 0,reduceMotion=arguments.length>4?arguments[4]:void 0;return defineAnimation(_nextAnimation,(()=>{const nextAnimation="function"==typeof _nextAnimation?_nextAnimation():_nextAnimation;return{isHigherOrder:!0,onFrame:function(animation,now){const finished=nextAnimation.onFrame(nextAnimation,now);if(animation.current=nextAnimation.current,finished){if(animation.reps+=1,nextAnimation.callback&&nextAnimation.callback(!0,animation.current),animation.reduceMotion||numberOfReps>0&&animation.reps>=numberOfReps)return!0;const startValue=reverse?nextAnimation.current:animation.startValue;return reverse&&(nextAnimation.toValue=animation.startValue,animation.startValue=startValue),nextAnimation.onStart(nextAnimation,startValue,now,nextAnimation.previousAnimation),!1}return!1},onStart:function(animation,value,now,previousAnimation){animation.startValue=value,animation.reps=0,void 0===nextAnimation.reduceMotion&&(nextAnimation.reduceMotion=animation.reduceMotion),animation.reduceMotion&&reverse&&(numberOfReps<=0||numberOfReps%2==0)?(animation.current=animation.startValue,animation.onFrame=()=>!0):nextAnimation.onStart(nextAnimation,value,now,previousAnimation)},reps:0,current:nextAnimation.current,callback:finished=>{callback&&callback(finished),!finished&&nextAnimation.callback&&nextAnimation.callback(!1)},startValue:0,reduceMotion:getReduceMotionForAnimation(reduceMotion)}}))};