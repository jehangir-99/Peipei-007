import{deepClone}from"../../tools/mergeInto";import{getType}from"../../tools/utils/typeUtils";import{sanitize}from"../../tools/serialisation/sanitize";import{Observable}from"../../tools/observable";export function createContextManager(customerDataTracker){var context={},changeObservable=new Observable,contextManager={getContext:function(){return deepClone(context)},setContext:function(newContext){"object"===getType(newContext)?(context=sanitize(newContext),customerDataTracker.updateCustomerData(context)):contextManager.clearContext(),changeObservable.notify()},setContextProperty:function(key,property){context[key]=sanitize(property),customerDataTracker.updateCustomerData(context),changeObservable.notify()},removeContextProperty:function(key){delete context[key],customerDataTracker.updateCustomerData(context),changeObservable.notify()},clearContext:function(){context={},customerDataTracker.resetCustomerData(),changeObservable.notify()},changeObservable:changeObservable};return contextManager}