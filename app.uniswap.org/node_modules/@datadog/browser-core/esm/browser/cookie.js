import{display}from"../tools/display";import{ONE_MINUTE,ONE_SECOND}from"../tools/utils/timeUtils";import{findCommaSeparatedValue,findCommaSeparatedValues,generateUUID}from"../tools/utils/stringUtils";export function setCookie(name,value,expireDelay,options){var date=new Date;date.setTime(date.getTime()+expireDelay);var expires="expires=".concat(date.toUTCString()),sameSite=options&&options.crossSite?"none":"strict",domain=options&&options.domain?";domain=".concat(options.domain):"",secure=options&&options.secure?";secure":"",partitioned=options&&options.partitioned?";partitioned":"";document.cookie="".concat(name,"=").concat(value,";").concat(expires,";path=/;samesite=").concat(sameSite).concat(domain).concat(secure).concat(partitioned)}export function getCookie(name){return findCommaSeparatedValue(document.cookie,name)}var initCookieParsed,getCurrentSiteCache;export function getInitCookie(name){return initCookieParsed||(initCookieParsed=findCommaSeparatedValues(document.cookie)),initCookieParsed.get(name)}export function resetInitCookies(){initCookieParsed=void 0}export function deleteCookie(name,options){setCookie(name,"",0,options)}export function areCookiesAuthorized(options){if(void 0===document.cookie||null===document.cookie)return!1;try{var testCookieName="dd_cookie_test_".concat(generateUUID());setCookie(testCookieName,"test",ONE_MINUTE,options);var isCookieCorrectlySet="test"===getCookie(testCookieName);return deleteCookie(testCookieName,options),isCookieCorrectlySet}catch(error){return display.error(error),!1}}export function getCurrentSite(){if(void 0===getCurrentSiteCache){for(var testCookieName="dd_site_test_".concat(generateUUID()),domainLevels=window.location.hostname.split("."),candidateDomain=domainLevels.pop();domainLevels.length&&!getCookie(testCookieName);)candidateDomain="".concat(domainLevels.pop(),".").concat(candidateDomain),setCookie(testCookieName,"test",ONE_SECOND,{domain:candidateDomain});deleteCookie(testCookieName,{domain:candidateDomain}),getCurrentSiteCache=candidateDomain}return getCurrentSiteCache}