import{Observable}from"../tools/observable";import{objectValues,includes}from"../tools/utils/polyfills";import{addEventListeners,addEventListener,DOM_EVENT}from"./addEventListener";export var PageExitReason={HIDDEN:"visibility_hidden",UNLOADING:"before_unload",PAGEHIDE:"page_hide",FROZEN:"page_frozen"};export function createPageExitObservable(configuration){return new Observable((function(observable){var stopListeners=addEventListeners(configuration,window,[DOM_EVENT.VISIBILITY_CHANGE,DOM_EVENT.FREEZE],(function(event){event.type===DOM_EVENT.VISIBILITY_CHANGE&&"hidden"===document.visibilityState?observable.notify({reason:PageExitReason.HIDDEN}):event.type===DOM_EVENT.FREEZE&&observable.notify({reason:PageExitReason.FROZEN})}),{capture:!0}).stop,stopBeforeUnloadListener=addEventListener(configuration,window,DOM_EVENT.BEFORE_UNLOAD,(function(){observable.notify({reason:PageExitReason.UNLOADING})})).stop;return function(){stopListeners(),stopBeforeUnloadListener()}}))}export function isPageExitReason(reason){return includes(objectValues(PageExitReason),reason)}