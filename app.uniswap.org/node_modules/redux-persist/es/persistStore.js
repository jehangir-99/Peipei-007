function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(source,!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}import{createStore}from"redux";import{FLUSH,PAUSE,PERSIST,PURGE,REGISTER,REHYDRATE}from"./constants";var initialState={registry:[],bootstrapped:!1},persistorReducer=function(){var state=arguments.length>0&&void 0!==arguments[0]?arguments[0]:initialState,action=arguments.length>1?arguments[1]:void 0;switch(action.type){case REGISTER:return _objectSpread({},state,{registry:[].concat(_toConsumableArray(state.registry),[action.key])});case REHYDRATE:var firstIndex=state.registry.indexOf(action.key),registry=_toConsumableArray(state.registry);return registry.splice(firstIndex,1),_objectSpread({},state,{registry:registry,bootstrapped:0===registry.length});default:return state}};export default function persistStore(store,options,cb){if("production"!==process.env.NODE_ENV){var optionsToTest=options||{};["blacklist","whitelist","transforms","storage","keyPrefix","migrate"].forEach((function(k){optionsToTest[k]&&console.error('redux-persist: invalid option passed to persistStore: "'.concat(k,'". You may be incorrectly passing persistConfig into persistStore, whereas it should be passed into persistReducer.'))}))}var boostrappedCb=cb||!1,_pStore=createStore(persistorReducer,initialState,options&&options.enhancer?options.enhancer:void 0),register=function(key){_pStore.dispatch({type:REGISTER,key:key})},rehydrate=function(key,payload,err){var rehydrateAction={type:REHYDRATE,payload:payload,err:err,key:key};store.dispatch(rehydrateAction),_pStore.dispatch(rehydrateAction),boostrappedCb&&persistor.getState().bootstrapped&&(boostrappedCb(),boostrappedCb=!1)},persistor=_objectSpread({},_pStore,{purge:function(){var results=[];return store.dispatch({type:PURGE,result:function(purgeResult){results.push(purgeResult)}}),Promise.all(results)},flush:function(){var results=[];return store.dispatch({type:FLUSH,result:function(flushResult){results.push(flushResult)}}),Promise.all(results)},pause:function(){store.dispatch({type:PAUSE})},persist:function(){store.dispatch({type:PERSIST,register:register,rehydrate:rehydrate})}});return options&&options.manualPersist||persistor.persist(),persistor}