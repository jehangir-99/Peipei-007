"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.withRetry=void 0;const wait_js_1=require("../wait.js");function withRetry(fn,{delay:delay_=100,retryCount:retryCount=2,shouldRetry:shouldRetry=(()=>!0)}={}){return new Promise(((resolve,reject)=>{const attemptRetry=async({count:count=0}={})=>{try{const data=await fn();resolve(data)}catch(err){if(count<retryCount&&await shouldRetry({count:count,error:err}))return(async({error:error})=>{const delay="function"==typeof delay_?delay_({count:count,error:error}):delay_;delay&&await(0,wait_js_1.wait)(delay),attemptRetry({count:count+1})})({error:err});reject(err)}};attemptRetry()}))}exports.withRetry=withRetry;