"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const wallet_1=require("../wallet"),permissions_1=require("../types/permissions"),hasPermission=(required,permissions)=>permissions.some((permission=>permission.parentCapability===required)),requirePermission=()=>(_,propertyKey,descriptor)=>{const originalMethod=descriptor.value;return descriptor.value=async function(){const wallet=new wallet_1.Wallet(this.communicator);let currentPermissions=await wallet.getPermissions();if(hasPermission(propertyKey,currentPermissions)||(currentPermissions=await wallet.requestPermissions([{[propertyKey]:{}}])),!hasPermission(propertyKey,currentPermissions))throw new permissions_1.PermissionsError("Permissions rejected",permissions_1.PERMISSIONS_REQUEST_REJECTED);return originalMethod.apply(this)},descriptor};exports.default=requirePermission;