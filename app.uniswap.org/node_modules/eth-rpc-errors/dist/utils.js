"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.serializeError=exports.isValidCode=exports.getMessageFromCode=exports.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const error_constants_1=require("./error-constants"),classes_1=require("./classes"),FALLBACK_ERROR_CODE=error_constants_1.errorCodes.rpc.internal,FALLBACK_MESSAGE="Unspecified error message. This is a bug, please report it.",FALLBACK_ERROR={code:FALLBACK_ERROR_CODE,message:getMessageFromCode(FALLBACK_ERROR_CODE)};function getMessageFromCode(code,fallbackMessage=FALLBACK_MESSAGE){if(Number.isInteger(code)){const codeString=code.toString();if(hasKey(error_constants_1.errorValues,codeString))return error_constants_1.errorValues[codeString].message;if(isJsonRpcServerError(code))return exports.JSON_RPC_SERVER_ERROR_MESSAGE}return fallbackMessage}function isValidCode(code){if(!Number.isInteger(code))return!1;const codeString=code.toString();return!!error_constants_1.errorValues[codeString]||!!isJsonRpcServerError(code)}function serializeError(error,{fallbackError:fallbackError=FALLBACK_ERROR,shouldIncludeStack:shouldIncludeStack=!1}={}){var _a,_b;if(!fallbackError||!Number.isInteger(fallbackError.code)||"string"!=typeof fallbackError.message)throw new Error("Must provide fallback error with integer number code and string message.");if(error instanceof classes_1.EthereumRpcError)return error.serialize();const serialized={};if(error&&"object"==typeof error&&!Array.isArray(error)&&hasKey(error,"code")&&isValidCode(error.code)){const _error=error;serialized.code=_error.code,_error.message&&"string"==typeof _error.message?(serialized.message=_error.message,hasKey(_error,"data")&&(serialized.data=_error.data)):(serialized.message=getMessageFromCode(serialized.code),serialized.data={originalError:assignOriginalError(error)})}else{serialized.code=fallbackError.code;const message=null===(_a=error)||void 0===_a?void 0:_a.message;serialized.message=message&&"string"==typeof message?message:fallbackError.message,serialized.data={originalError:assignOriginalError(error)}}const stack=null===(_b=error)||void 0===_b?void 0:_b.stack;return shouldIncludeStack&&error&&stack&&"string"==typeof stack&&(serialized.stack=stack),serialized}function isJsonRpcServerError(code){return code>=-32099&&code<=-32e3}function assignOriginalError(error){return error&&"object"==typeof error&&!Array.isArray(error)?Object.assign({},error):error}function hasKey(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)}exports.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",exports.getMessageFromCode=getMessageFromCode,exports.isValidCode=isValidCode,exports.serializeError=serializeError;