"use strict";var __decorate=this&&this.__decorate||function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){return new(P||(P=Promise))((function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator.throw(value))}catch(e){reject(e)}}function step(result){var value;result.done?resolve(result.value):(value=result.value,value instanceof P?value:new P((function(resolve){resolve(value)}))).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())}))},__generator=this&&this.__generator||function(thisArg,body){var f,y,t,g,_={label:0,sent:function(){if(1&t[0])throw t[1];return t[1]},trys:[],ops:[]};return g={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return function(op){if(f)throw new TypeError("Generator is already executing.");for(;_;)try{if(f=1,y&&(t=2&op[0]?y.return:op[0]?y.throw||((t=y.return)&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;switch(y=0,t&&(op=[2&op[0],t.value]),op[0]){case 0:case 1:t=op;break;case 4:return _.label++,{value:op[1],done:!1};case 5:_.label++,y=op[1],op=[0];continue;case 7:op=_.ops.pop(),_.trys.pop();continue;default:if(!(t=_.trys,(t=t.length>0&&t[t.length-1])||6!==op[0]&&2!==op[0])){_=0;continue}if(3===op[0]&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(6===op[0]&&_.label<t[1]){_.label=t[1],t=op;break}if(t&&_.label<t[2]){_.label=t[2],_.ops.push(op);break}t[2]&&_.ops.pop(),_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e],y=0}finally{f=t=0}if(5&op[0])throw op[1];return{value:op[0]?op[1]:void 0,done:!0}}([n,v])}}};Object.defineProperty(exports,"__esModule",{value:!0});var statsig_js_1=require("statsig-js"),StatsigStatic_1=require("./StatsigStatic"),SDKVersion_1=require("./SDKVersion"),Statsig=function(){function Statsig(sdkKey,user,options){if(null!=Statsig_1.instance&&Statsig_1.canThrow())throw new Error("Cannot create another instance of the static Statsig class");Statsig_1.instance=new statsig_js_1.StatsigClient(sdkKey,user,options)}var Statsig_1;return Statsig_1=Statsig,Statsig.initialize=function(sdkKey,user,options){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){try{return Statsig_1.instance||(Statsig_1.instance=new statsig_js_1.StatsigClient(sdkKey,user,options),Statsig_1.instance.setSDKPackageInfo(this.sdkPackageInfo),Statsig_1.instance.setAppState(this.appState),Statsig_1.instance.setNativeModules(this.nativeModules),Statsig_1.instance.setPlatform(this.platform),Statsig_1.instance.setRNDeviceInfo(this.deviceInfo),Statsig_1.instance.setExpoConstants(this.expoConstants),Statsig_1.instance.setExpoDevice(this.expoDevice),Statsig_1.instance.setOnCacheLoadedReactCallback(this.onCacheLoadedCallback)),[2,Statsig_1.instance.initializeAsync()]}catch(e){if(Statsig_1.canThrow())throw e}return[2,Promise.resolve()]}))}))},Statsig.bootstrap=function(sdkKey,initializeValues,user,options){null==Statsig_1.instance?(null==options&&(options={}),options.initializeValues=initializeValues,Statsig_1.instance=new statsig_js_1.StatsigClient(sdkKey,user,options),Statsig_1.instance.setSDKPackageInfo({sdkType:"react-client",sdkVersion:SDKVersion_1.version})):Statsig_1.setInitializeValues(initializeValues)},Statsig.flushEvents=function(){return this.capture((function(){return Statsig_1.getClientX().flushEvents()}),void 0)},Statsig.reenableAllLogging=function(){return this.capture((function(){return Statsig_1.getClientX().reenableAllLogging()}),void 0)},Statsig.prefetchUsers=function(users){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(_a){return[2,this.capture((function(){return Statsig_1.getClientX().prefetchUsers(users)}),Promise.resolve())]}))}))},Statsig.setInitializeValues=function(initializeValues){this.capture((function(){return Statsig_1.getClientX().setInitializeValues(initializeValues)}),void 0)},Statsig.getCurrentUser=function(){return this.capture((function(){return Statsig_1.getClientX().getCurrentUser()}),null)},Statsig.checkGate=function(gateName,ignoreOverrides){return void 0===ignoreOverrides&&(ignoreOverrides=!1),this.capture((function(){return Statsig_1.getClientX().checkGate(gateName,ignoreOverrides)}),!1)},Statsig.checkGateWithExposureLoggingDisabled=function(gateName,options){return this.capture((function(){return Statsig_1.getClientX().checkGateWithExposureLoggingDisabled(gateName,null==options?void 0:options.ignoreOverrides)}),!1)},Statsig.manuallyLogGateExposure=function(gateName){this.capture((function(){return Statsig_1.getClientX().logGateExposure(gateName)}),void 0)},Statsig.getConfig=function(configName,ignoreOverrides){return void 0===ignoreOverrides&&(ignoreOverrides=!1),this.capture((function(){return Statsig_1.getClientX().getConfig(configName,ignoreOverrides)}),new statsig_js_1.DynamicConfig(configName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.getConfigWithExposureLoggingDisabled=function(configName,options){return this.capture((function(){return Statsig_1.getClientX().getConfigWithExposureLoggingDisabled(configName,null==options?void 0:options.ignoreOverrides)}),new statsig_js_1.DynamicConfig(configName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.manuallyLogConfigExposure=function(configName){this.capture((function(){return Statsig_1.getClientX().logConfigExposure(configName)}),void 0)},Statsig.getExperiment=function(experimentName,keepDeviceValue,ignoreOverrides){return void 0===keepDeviceValue&&(keepDeviceValue=!1),void 0===ignoreOverrides&&(ignoreOverrides=!1),this.capture((function(){return Statsig_1.getClientX().getExperiment(experimentName,keepDeviceValue,ignoreOverrides)}),new statsig_js_1.DynamicConfig(experimentName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.getExperimentWithExposureLoggingDisabled=function(experimentName,options){return this.capture((function(){return Statsig_1.getClientX().getExperimentWithExposureLoggingDisabled(experimentName,null==options?void 0:options.keepDeviceValue,null==options?void 0:options.ignoreOverrides)}),new statsig_js_1.DynamicConfig(experimentName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.manuallyLogExperimentExposure=function(experimentName,keepDeviceValue){this.capture((function(){return Statsig_1.getClientX().logExperimentExposure(experimentName,keepDeviceValue)}),void 0)},Statsig.getLayer=function(layerName,keepDeviceValue){return void 0===keepDeviceValue&&(keepDeviceValue=!1),this.capture((function(){return Statsig_1.getClientX().getLayer(layerName,keepDeviceValue)}),statsig_js_1.Layer._create(layerName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.getLayerWithExposureLoggingDisabled=function(layerName,options){return this.capture((function(){return Statsig_1.getClientX().getLayerWithExposureLoggingDisabled(layerName,null==options?void 0:options.keepDeviceValue)}),statsig_js_1.Layer._create(layerName,{},"",{time:Date.now(),reason:statsig_js_1.EvaluationReason.Uninitialized}))},Statsig.manuallyLogLayerParameterExposure=function(layerName,parameterName,keepDeviceValue){void 0===keepDeviceValue&&(keepDeviceValue=!1),this.capture((function(){return Statsig_1.getClientX().logLayerParameterExposure(layerName,parameterName,keepDeviceValue)}),void 0)},Statsig.logEvent=function(eventName,value,metadata){void 0===value&&(value=null),void 0===metadata&&(metadata=null),this.capture((function(){return Statsig_1.getClientX().logEvent(eventName,value,metadata)}),void 0)},Statsig.updateUser=function(user){return this.capture((function(){return Statsig_1.getClientX().updateUser(user)}),Promise.resolve(!1))},Statsig.updateUserWithValues=function(user,values){return this.capture((function(){return Statsig_1.getClientX().updateUserWithValues(user,values)}),!1)},Statsig.shutdown=function(){this.capture((function(){return Statsig_1.getClientX().shutdown()}),void 0),Statsig_1.instance=void 0},Statsig.overrideGate=function(gateName,value){this.capture((function(){var _a;(null===(_a=Statsig_1.getAllOverrides().gates)||void 0===_a?void 0:_a[gateName])!==value&&(Statsig_1.getClientX().overrideGate(gateName,value),Statsig_1.updateContext())}),void 0)},Statsig.overrideConfig=function(configName,value){this.capture((function(){var _a;(null===(_a=Statsig_1.getAllOverrides().configs)||void 0===_a?void 0:_a[configName])!==value&&(Statsig_1.getClientX().overrideConfig(configName,value),Statsig_1.updateContext())}),void 0)},Statsig.overrideLayer=function(layerName,value){this.capture((function(){var _a;(null===(_a=Statsig_1.getAllOverrides().layers)||void 0===_a?void 0:_a[layerName])!==value&&(Statsig_1.getClientX().overrideLayer(layerName,value),Statsig_1.updateContext())}),void 0)},Statsig.removeGateOverride=function(name){this.capture((function(){Statsig_1.getClientX().removeGateOverride(name),Statsig_1.updateContext()}),void 0)},Statsig.removeConfigOverride=function(name){this.capture((function(){Statsig_1.getClientX().removeConfigOverride(name),Statsig_1.updateContext()}),void 0)},Statsig.removeLayerOverride=function(name){this.capture((function(){Statsig_1.getClientX().removeLayerOverride(name),Statsig_1.updateContext()}),void 0)},Statsig.getAllOverrides=function(){return this.capture((function(){return Statsig_1.getClientX().getAllOverrides()}),{gates:{},configs:{},layers:{}})},Statsig.getEvaluationDetails=function(){var _a,_b;return null!==(_b=null===(_a=Statsig_1.instance)||void 0===_a?void 0:_a.getEvaluationDetails())&&void 0!==_b?_b:{reason:statsig_js_1.EvaluationReason.Uninitialized,time:0}},Statsig.getStableID=function(){return this.capture((function(){return Statsig_1.getClientX().getStableID()}),"")},Statsig.initializeCalled=function(){return null!=Statsig_1.instance&&Statsig_1.instance.initializeCalled()},Statsig.setSDKPackageInfo=function(sdkPackageInfo){Statsig_1.sdkPackageInfo=sdkPackageInfo},Statsig.setReactNativeUUID=function(uuid){null!=uuid&&statsig_js_1.StatsigClient.setReactNativeUUID(uuid)},Statsig.setAsyncStorage=function(asyncStorage){null!=asyncStorage&&(statsig_js_1.StatsigAsyncStorage.asyncStorage=asyncStorage)},Statsig.setAppState=function(appState){null!=appState&&(Statsig_1.appState=appState)},Statsig.setNativeModules=function(nativeModules){null!=nativeModules&&(Statsig_1.nativeModules=nativeModules)},Statsig.setPlatform=function(platform){null!=platform&&(Statsig_1.platform=platform)},Statsig.setRNDeviceInfo=function(deviceInfo){null!=deviceInfo&&(Statsig_1.deviceInfo=deviceInfo)},Statsig.setExpoConstants=function(expoConstants){null!=expoConstants&&(Statsig_1.expoConstants=expoConstants)},Statsig.setExpoDevice=function(expoDevice){null!=expoDevice&&(Statsig_1.expoDevice=expoDevice)},Statsig.setReactContextUpdater=function(fn){Statsig_1.reactContextUpdater=fn},Statsig.setOnCacheLoadedCallback=function(fn){Statsig_1.onCacheLoadedCallback=fn},Statsig.getClientX=function(){if(!Statsig_1.instance)throw new Error("Call and wait for initialize() to finish first.");return Statsig_1.instance},Statsig.capture=function(task,recover){try{return task()}catch(e){if(Statsig_1.canThrow())throw e;return recover}},Statsig.updateContext=function(){null!=Statsig_1.reactContextUpdater&&Statsig_1.reactContextUpdater()},Statsig.canThrow=function(){var _a;return"undefined"==typeof process||void 0===process.env||"silent"!==(null===(_a=null===process||void 0===process?void 0:process.env)||void 0===_a?void 0:_a.REACT_APP_STATSIG_SDK_MODE)},Statsig.reactContextUpdater=null,Statsig=Statsig_1=__decorate([(0,StatsigStatic_1.staticImplements)()],Statsig)}();exports.default=Statsig;