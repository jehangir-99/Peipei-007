"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getUserCacheKey=exports.getSortedObject=exports.djb2HashForObject=exports.sha256Hash=exports.djb2Hash=exports.memoizedUserCacheKeyHash=exports.fasthash=void 0;var Base64_1=require("./Base64"),js_sha256_1=require("js-sha256"),hashLookupTable={};function fasthash(value){for(var hash=0,i=0;i<value.length;i++){hash=(hash<<5)-hash+value.charCodeAt(i),hash&=hash}return hash}function memoizedUserCacheKeyHash(value){var seen=hashLookupTable[value];if(seen)return seen;var hash=String(fasthash(value));return hashLookupTable[value]=hash,hash}function djb2Hash(value){return String(fasthash(value)>>>0)}function sha256Hash(value){var seen=hashLookupTable[value];if(seen)return seen;var buffer=js_sha256_1.sha256.create().update(value).arrayBuffer(),hash=Base64_1.Base64.encodeArrayBuffer(buffer);return hashLookupTable[value]=hash,hash}function djb2HashForObject(object){return djb2Hash(JSON.stringify(getSortedObject(object)))}function getSortedObject(object){if(null==object)return null;var keys=Object.keys(object).sort(),sortedObject={};return keys.forEach((function(key){var value=object[key];value instanceof Object&&(value=getSortedObject(value)),sortedObject[key]=value})),sortedObject}function getUserCacheKey(stableID,user){var _a,parts=["userID:"+String(null!==(_a=null==user?void 0:user.userID)&&void 0!==_a?_a:"")],customIDs=null==user?void 0:user.customIDs;if(null!=customIDs)for(var _i=0,_b=Object.entries(customIDs);_i<_b.length;_i++){var _c=_b[_i],type=_c[0],value=_c[1];parts.push(type+":"+value)}var v2=memoizedUserCacheKeyHash(parts.join(";"));return parts.splice(1,0,"stableID:"+stableID),{v1:memoizedUserCacheKeyHash(parts.join(";")),v2:v2}}exports.fasthash=fasthash,exports.memoizedUserCacheKeyHash=memoizedUserCacheKeyHash,exports.djb2Hash=djb2Hash,exports.sha256Hash=sha256Hash,exports.djb2HashForObject=djb2HashForObject,exports.getSortedObject=getSortedObject,exports.getUserCacheKey=getUserCacheKey;